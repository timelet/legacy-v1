/*! For license information please see lib-rxdb.1620dd7a455902e143e2.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{56:function(t,e,r){"use strict";r.d(e,"a",(function(){return Kf})),r.d(e,"b",(function(){return Jf}));r(13),r(99),r(118),r(119),r(120),r(121),r(55),r(122),r(123),r(124),r(10),r(67);var n=r(5),o=r(3),i=r(16),u=void 0!==u?u:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s,c=function(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t},f=Object(n.c)((function(t){n.a,t.exports=function(){var t=Object.prototype.toString;function e(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)}function r(t){if(!t)return!0;if(i(t)&&0===t.length)return!0;if("string"!=typeof t){for(var r in t)if(e(t,r))return!1;return!0}return!1}function n(e){return t.call(e)}function o(t){return"object"==typeof t&&"[object Object]"===n(t)}var i=Array.isArray||function(e){return"[object Array]"===t.call(e)};function u(t){return"boolean"==typeof t||"[object Boolean]"===n(t)}function a(t){var e=parseInt(t);return e.toString()===t?e:t}function s(t){var n,s=function(t){return Object.keys(s).reduce((function(e,r){return"create"===r||"function"==typeof s[r]&&(e[r]=s[r].bind(s,t)),e}),{})};function c(t,e){if(n(t,e))return t[e]}function f(e,r,n,o){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if("string"==typeof r)return f(e,r.split(".").map(a),n,o);var i=r[0],u=c(e,i);if(t.includeInheritedProps&&("__proto__"===i||"constructor"===i&&"function"==typeof u))throw new Error("For security reasons, object's magic properties cannot be set");return 1===r.length?(void 0!==u&&o||(e[i]=n),u):(void 0===u&&("number"==typeof r[1]?e[i]=[]:e[i]={}),f(e[i],r.slice(1),n,o))}return n=(t=t||{}).includeInheritedProps?function(){return!0}:function(t,r){return"number"==typeof r&&Array.isArray(t)||e(t,r)},s.has=function(r,n){if("number"==typeof n?n=[n]:"string"==typeof n&&(n=n.split(".")),!n||0===n.length)return!!r;for(var o=0;o<n.length;o++){var u=a(n[o]);if(!("number"==typeof u&&i(r)&&u<r.length||(t.includeInheritedProps?u in Object(r):e(r,u))))return!1;r=r[u]}return!0},s.ensureExists=function(t,e,r){return f(t,e,r,!0)},s.set=function(t,e,r,n){return f(t,e,r,n)},s.insert=function(t,e,r,n){var o=s.get(t,e);n=~~n,i(o)||(o=[],s.set(t,e,o)),o.splice(n,0,r)},s.empty=function(t,e){var a,c;if(!r(e)&&null!=t&&(a=s.get(t,e))){if("string"==typeof a)return s.set(t,e,"");if(u(a))return s.set(t,e,!1);if("number"==typeof a)return s.set(t,e,0);if(i(a))a.length=0;else{if(!o(a))return s.set(t,e,null);for(c in a)n(a,c)&&delete a[c]}}},s.push=function(t,e){var r=s.get(t,e);i(r)||(r=[],s.set(t,e,r)),r.push.apply(r,Array.prototype.slice.call(arguments,2))},s.coalesce=function(t,e,r){for(var n,o=0,i=e.length;o<i;o++)if(void 0!==(n=s.get(t,e[o])))return n;return r},s.get=function(t,e,r){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if(null==t)return r;if("string"==typeof e)return s.get(t,e.split("."),r);var n=a(e[0]),o=c(t,n);return void 0===o?r:1===e.length?o:s.get(t[n],e.slice(1),r)},s.del=function(t,e){if("number"==typeof e&&(e=[e]),null==t)return t;if(r(e))return t;if("string"==typeof e)return s.del(t,e.split("."));var o=a(e[0]);return n(t,o)?1!==e.length?s.del(t[o],e.slice(1)):(i(t)?t.splice(o,1):delete t[o],t):t},s}var c=s();return c.create=s,c.withInheritedProps=s({includeInheritedProps:!0}),c}()})),l=Object.prototype.toString,h=function(t){var e=l.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===l.call(t.callee)),r};if(!Object.keys){var p=Object.prototype.hasOwnProperty,d=Object.prototype.toString,y=h,v=Object.prototype.propertyIsEnumerable,m=!v.call({toString:null},"toString"),g=v.call((function(){}),"prototype"),b=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=function(t){var e=t.constructor;return e&&e.prototype===t},w={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},O=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!w["$"+t]&&p.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{_(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();s=function(t){var e=null!==t&&"object"==typeof t,r="[object Function]"===d.call(t),n=y(t),o=e&&"[object String]"===d.call(t),i=[];if(!e&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var u=g&&r;if(o&&t.length>0&&!p.call(t,0))for(var a=0;a<t.length;++a)i.push(String(a));if(n&&t.length>0)for(var s=0;s<t.length;++s)i.push(String(s));else for(var c in t)u&&"prototype"===c||!p.call(t,c)||i.push(String(c));if(m)for(var f=function(t){if("undefined"==typeof window||!O)return _(t);try{return _(t)}catch(t){return!1}}(t),l=0;l<b.length;++l)f&&"constructor"===b[l]||!p.call(t,b[l])||i.push(b[l]);return i}}var j=s,k=Array.prototype.slice,E=Object.keys,S=E?function(t){return E(t)}:j,x=Object.keys;S.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return h(t)?x(k.call(t)):x(t)}):Object.keys=S;return Object.keys||S};var P,A=S,I=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),r=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(t,e);if(42!==o.value||!0!==o.enumerable)return!1}return!0},T=n.a.Symbol,D=function(){return"function"==typeof T&&("function"==typeof Symbol&&("symbol"==typeof T("foo")&&("symbol"==typeof Symbol("bar")&&I())))},C="Function.prototype.bind called on incompatible ",R=Array.prototype.slice,M=Object.prototype.toString,$="[object Function]",N=Function.prototype.bind||function(t){var e=this;if("function"!=typeof e||M.call(e)!==$)throw new TypeError(C+e);for(var r,n=R.call(arguments,1),o=function(){if(this instanceof r){var o=e.apply(this,n.concat(R.call(arguments)));return Object(o)===o?o:this}return e.apply(t,n.concat(R.call(arguments)))},i=Math.max(0,e.length-n.length),u=[],a=0;a<i;a++)u.push("$"+a);if(r=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var s=function(){};s.prototype=e.prototype,r.prototype=new s,s.prototype=null}return r},L=N.call(Function.call,Object.prototype.hasOwnProperty),B=SyntaxError,q=Function,U=TypeError,F=function(t){try{return Function('"use strict"; return ('+t+").constructor;")()}catch(t){}},W=Object.getOwnPropertyDescriptor;if(W)try{W({},"")}catch(t){W=null}var Y=function(){throw new U},Q=W?function(){try{return Y}catch(t){try{return W(arguments,"callee").get}catch(t){return Y}}}():Y,z=D(),V=Object.getPrototypeOf||function(t){return t.__proto__},J=F("async function* () {}"),H=J?J.prototype:P,G=H?H.prototype:P,K="undefined"==typeof Uint8Array?P:V(Uint8Array),X={"%AggregateError%":"undefined"==typeof AggregateError?P:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?P:ArrayBuffer,"%ArrayIteratorPrototype%":z?V([][Symbol.iterator]()):P,"%AsyncFromSyncIteratorPrototype%":P,"%AsyncFunction%":F("async function () {}"),"%AsyncGenerator%":H,"%AsyncGeneratorFunction%":J,"%AsyncIteratorPrototype%":G?V(G):P,"%Atomics%":"undefined"==typeof Atomics?P:Atomics,"%BigInt%":"undefined"==typeof BigInt?P:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?P:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?P:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?P:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?P:FinalizationRegistry,"%Function%":q,"%GeneratorFunction%":F("function* () {}"),"%Int8Array%":"undefined"==typeof Int8Array?P:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?P:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?P:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":z?V(V([][Symbol.iterator]())):P,"%JSON%":"object"==typeof JSON?JSON:P,"%Map%":"undefined"==typeof Map?P:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&z?V((new Map)[Symbol.iterator]()):P,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?P:Promise,"%Proxy%":"undefined"==typeof Proxy?P:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?P:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?P:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&z?V((new Set)[Symbol.iterator]()):P,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?P:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":z?V(""[Symbol.iterator]()):P,"%Symbol%":z?Symbol:P,"%SyntaxError%":B,"%ThrowTypeError%":Q,"%TypedArray%":K,"%TypeError%":U,"%Uint8Array%":"undefined"==typeof Uint8Array?P:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?P:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?P:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?P:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?P:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?P:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?P:WeakSet},Z={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},tt=N.call(Function.call,Array.prototype.concat),et=N.call(Function.apply,Array.prototype.splice),rt=N.call(Function.call,String.prototype.replace),nt=N.call(Function.call,String.prototype.slice),ot=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,it=/\\(\\)?/g,ut=function(t){var e=nt(t,0,1),r=nt(t,-1);if("%"===e&&"%"!==r)throw new B("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new B("invalid intrinsic syntax, expected opening `%`");var n=[];return rt(t,ot,(function(t,e,r,o){n[n.length]=r?rt(o,it,"$1"):e||t})),n},at=function(t,e){var r,n=t;if(L(Z,n)&&(n="%"+(r=Z[n])[0]+"%"),L(X,n)){var o=X[n];if(void 0===o&&!e)throw new U("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new B("intrinsic "+t+" does not exist!")},st=function(t,e){if("string"!=typeof t||0===t.length)throw new U("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new U('"allowMissing" argument must be a boolean');var r=ut(t),n=r.length>0?r[0]:"",o=at("%"+n+"%",e),i=o.name,u=o.value,a=!1,s=o.alias;s&&(n=s[0],et(r,tt([0,1],s)));for(var c=1,f=!0;c<r.length;c+=1){var l=r[c],h=nt(l,0,1),p=nt(l,-1);if(('"'===h||"'"===h||"`"===h||'"'===p||"'"===p||"`"===p)&&h!==p)throw new B("property names with quotes must have matching quotes");if("constructor"!==l&&f||(a=!0),L(X,i="%"+(n+="."+l)+"%"))u=X[i];else if(null!=u){if(!(l in u)){if(!e)throw new U("base intrinsic for "+t+" exists, but the property is not available.");return}if(W&&c+1>=r.length){var d=W(u,l);u=(f=!!d)&&"get"in d&&!("originalValue"in d.get)?d.get:u[l]}else f=L(u,l),u=u[l];f&&!a&&(X[i]=u)}}return u},ct=Object(n.c)((function(t){var e=st("%Function.prototype.apply%"),r=st("%Function.prototype.call%"),n=st("%Reflect.apply%",!0)||N.call(r,e),o=st("%Object.getOwnPropertyDescriptor%",!0),i=st("%Object.defineProperty%",!0),u=st("%Math.max%");if(i)try{i({},"a",{value:1})}catch(t){i=null}t.exports=function(t){var e=n(N,r,arguments);if(o&&i){var a=o(e,"length");a.configurable&&i(e,"length",{value:1+u(0,t.length-(arguments.length-1))})}return e};var a=function(){return n(N,e,arguments)};i?i(t.exports,"apply",{value:a}):t.exports.apply=a})),ft=ct(st("String.prototype.indexOf")),lt=function(t,e){var r=st(t,!!e);return"function"==typeof r&&ft(t,".prototype.")>-1?ct(r):r},ht="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,pt=lt("Object.prototype.toString"),dt=function(t){return!(ht&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===pt(t)},yt=function(t){return!!dt(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==pt(t)&&"[object Function]"===pt(t.callee)},vt=function(){return dt(arguments)}();dt.isLegacyArguments=yt;var mt=vt?dt:yt,gt="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),bt=Object.prototype.toString,_t=Array.prototype.concat,wt=Object.defineProperty,Ot=wt&&function(){var t={};try{for(var e in wt(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),jt=function(t,e,r,n){var o;(!(e in t)||"function"==typeof(o=n)&&"[object Function]"===bt.call(o)&&n())&&(Ot?wt(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},kt=function(t,e){var r=arguments.length>2?arguments[2]:{},n=A(e);gt&&(n=_t.call(n,Object.getOwnPropertySymbols(e)));for(var o=0;o<n.length;o+=1)jt(t,n[o],e[n[o]],r[n[o]])};kt.supportsDescriptors=!!Ot;var Et=kt,St=function(t){return t!=t},xt=function(t,e){return 0===t&&0===e?1/t==1/e:t===e||!(!St(t)||!St(e))},Pt=function(){return"function"==typeof Object.is?Object.is:xt},At=ct(Pt(),Object);Et(At,{getPolyfill:Pt,implementation:xt,shim:function(){var t=Pt();return Et(Object,{is:t},{is:function(){return Object.is!==t}}),t}});var It,Tt,Dt,Ct,Rt=At,Mt=D()&&"symbol"==typeof Symbol.toStringTag;if(Mt){It=Function.call.bind(Object.prototype.hasOwnProperty),Tt=Function.call.bind(RegExp.prototype.exec),Dt={};var $t=function(){throw Dt};Ct={toString:$t,valueOf:$t},"symbol"==typeof Symbol.toPrimitive&&(Ct[Symbol.toPrimitive]=$t)}var Nt=Object.prototype.toString,Lt=Object.getOwnPropertyDescriptor,Bt=Mt?function(t){if(!t||"object"!=typeof t)return!1;var e=Lt(t,"lastIndex");if(!(e&&It(e,"value")))return!1;try{Tt(t,Ct)}catch(t){return t===Dt}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===Nt.call(t)},qt=Object,Ut=TypeError,Ft=function(){if(null!=this&&this!==qt(this))throw new Ut("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t},Wt=Et.supportsDescriptors,Yt=Object.getOwnPropertyDescriptor,Qt=TypeError,zt=function(){if(!Wt)throw new Qt("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=Yt(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return Ft},Vt=Et.supportsDescriptors,Jt=Object.getOwnPropertyDescriptor,Ht=Object.defineProperty,Gt=TypeError,Kt=Object.getPrototypeOf,Xt=/a/,Zt=ct(Ft);Et(Zt,{getPolyfill:zt,implementation:Ft,shim:function(){if(!Vt||!Kt)throw new Gt("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=zt(),e=Kt(Xt),r=Jt(e,"flags");return r&&r.get===t||Ht(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}});var te,ee=Zt,re={}.toString,ne=Array.isArray||function(t){return"[object Array]"==re.call(t)},oe=Date.prototype.getDay,ie=Object.prototype.toString,ue="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,ae=function(t){return"object"==typeof t&&null!==t&&(ue?function(t){try{return oe.call(t),!0}catch(t){return!1}}(t):"[object Date]"===ie.call(t))},se=String.prototype.valueOf,ce=Object.prototype.toString,fe="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,le=function(t){return"string"==typeof t||"object"==typeof t&&(fe?function(t){try{return se.call(t),!0}catch(t){return!1}}(t):"[object String]"===ce.call(t))},he=Number.prototype.toString,pe=Object.prototype.toString,de="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,ye=function(t){return"number"==typeof t||"object"==typeof t&&(de?function(t){try{return he.call(t),!0}catch(t){return!1}}(t):"[object Number]"===pe.call(t))},ve=lt("Boolean.prototype.toString"),me=lt("Object.prototype.toString"),ge="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,be=function(t){return"boolean"==typeof t||null!==t&&"object"==typeof t&&(ge&&Symbol.toStringTag in t?function(t){try{return ve(t),!0}catch(t){return!1}}(t):"[object Boolean]"===me(t))},_e=Object(n.c)((function(t){var e=Object.prototype.toString;if(D()){var r=Symbol.prototype.toString,n=/^Symbol\(.*\)$/;t.exports=function(t){if("symbol"==typeof t)return!0;if("[object Symbol]"!==e.call(t))return!1;try{return function(t){return"symbol"==typeof t.valueOf()&&n.test(r.call(t))}(t)}catch(t){return!1}}}else t.exports=function(t){return!1}})),we=Object(n.c)((function(t){if("function"==typeof BigInt){var e=BigInt.prototype.valueOf;t.exports=function(t){return null!=t&&"boolean"!=typeof t&&"string"!=typeof t&&"number"!=typeof t&&"symbol"!=typeof t&&"function"!=typeof t&&("bigint"==typeof t||function(t){try{return e.call(t),!0}catch(t){}return!1}(t))}}else t.exports=function(t){return!1}})),Oe=function(t){return null==t||"object"!=typeof t&&"function"!=typeof t?null:le(t)?"String":ye(t)?"Number":be(t)?"Boolean":_e(t)?"Symbol":we(t)?"BigInt":void 0},je="function"==typeof Map&&Map.prototype?Map:null,ke="function"==typeof Set&&Set.prototype?Set:null;je||(te=function(t){return!1});var Ee=je?Map.prototype.has:null,Se=ke?Set.prototype.has:null;te||Ee||(te=function(t){return!1});var xe,Pe=te||function(t){if(!t||"object"!=typeof t)return!1;try{if(Ee.call(t),Se)try{Se.call(t)}catch(t){return!0}return t instanceof je}catch(t){}return!1},Ae="function"==typeof Map&&Map.prototype?Map:null,Ie="function"==typeof Set&&Set.prototype?Set:null;Ie||(xe=function(t){return!1});var Te=Ae?Map.prototype.has:null,De=Ie?Set.prototype.has:null;xe||De||(xe=function(t){return!1});var Ce,Re=xe||function(t){if(!t||"object"!=typeof t)return!1;try{if(De.call(t),Te)try{Te.call(t)}catch(t){return!0}return t instanceof Ie}catch(t){}return!1},Me="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,$e="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;Me||(Ce=function(t){return!1});var Ne=Me?Me.prototype.has:null,Le=$e?$e.prototype.has:null;Ce||Ne||(Ce=function(t){return!1});var Be=Ce||function(t){if(!t||"object"!=typeof t)return!1;try{if(Ne.call(t,Ne),Le)try{Le.call(t,Le)}catch(t){return!0}return t instanceof Me}catch(t){}return!1},qe=Object(n.c)((function(t){var e,r="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,n="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;r||(e=function(t){return!1});var o=r?r.prototype.has:null,i=n?n.prototype.has:null;e||i||(t.exports=function(t){return!1}),t.exports=e||function(t){if(!t||"object"!=typeof t)return!1;try{if(i.call(t,i),o)try{o.call(t,o)}catch(t){return!0}return t instanceof n}catch(t){}return!1}})),Ue=function(t){if(t&&"object"==typeof t){if(Pe(t))return"Map";if(Re(t))return"Set";if(Be(t))return"WeakMap";if(qe(t))return"WeakSet"}return!1};function Fe(){throw new Error("setTimeout has not been defined")}function We(){throw new Error("clearTimeout has not been defined")}var Ye,Qe=Fe,ze=We;function Ve(t){if(Qe===setTimeout)return setTimeout(t,0);if((Qe===Fe||!Qe)&&setTimeout)return Qe=setTimeout,setTimeout(t,0);try{return Qe(t,0)}catch(e){try{return Qe.call(null,t,0)}catch(e){return Qe.call(this,t,0)}}}"function"==typeof(Ye="undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).setTimeout&&(Qe=setTimeout),"function"==typeof Ye.clearTimeout&&(ze=clearTimeout);var Je,He=[],Ge=!1,Ke=-1;function Xe(){Ge&&Je&&(Ge=!1,Je.length?He=Je.concat(He):Ke=-1,He.length&&Ze())}function Ze(){if(!Ge){var t=Ve(Xe);Ge=!0;for(var e=He.length;e;){for(Je=He,He=[];++Ke<e;)Je&&Je[Ke].run();Ke=-1,e=He.length}Je=null,Ge=!1,function(t){if(ze===clearTimeout)return clearTimeout(t);if((ze===We||!ze)&&clearTimeout)return ze=clearTimeout,clearTimeout(t);try{ze(t)}catch(e){try{return ze.call(null,t)}catch(e){return ze.call(this,t)}}}(t)}}function tr(t,e){this.fun=t,this.array=e}tr.prototype.run=function(){this.fun.apply(null,this.array)};function er(){}var rr=er,nr=er,or=er,ir=er,ur=er,ar=er,sr=er;var cr=Ye.performance||{},fr=cr.now||cr.mozNow||cr.msNow||cr.oNow||cr.webkitNow||function(){return(new Date).getTime()};var lr=new Date;var hr={nextTick:function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];He.push(new tr(t,e)),1!==He.length||Ge||Ve(Ze)},title:"browser",browser:!0,env:{NODE_ENV:"production"},argv:[],version:"",versions:{},on:rr,addListener:nr,once:or,off:ir,removeListener:ur,removeAllListeners:ar,emit:sr,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*fr.call(cr),r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r-=t[0],(n-=t[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-lr)/1e3}},pr={}.toString,dr=Array.isArray||function(t){return"[object Array]"==pr.call(t)},yr=Object(n.c)((function(t){if(D()||I()){var e=Symbol.iterator;t.exports=function(t){return null!=t&&void 0!==t[e]?t[e]():mt(t)?Array.prototype[e].call(t):void 0}}else{var r=dr,n=le,o=st,i=o("%Map%",!0),u=o("%Set%",!0),a=lt,s=a("Array.prototype.push"),c=a("String.prototype.charCodeAt"),f=a("String.prototype.slice"),l=function(t){var e=0;return{next:function(){var r,n=e>=t.length;return n||(r=t[e],e+=1),{done:n,value:r}}}},h=function(t,e){if(r(t)||mt(t))return l(t);if(n(t)){var o=0;return{next:function(){var e=function(t,e){if(e+1>=t.length)return e+1;var r=c(t,e);if(r<55296||r>56319)return e+1;var n=c(t,e+1);return n<56320||n>57343?e+1:e+2}(t,o),r=f(t,o,e);return o=e,{done:e>t.length,value:r}}}}return e&&void 0!==t["_es6-shim iterator_"]?t["_es6-shim iterator_"]():void 0};if(i||u){var p=Pe,d=Re,y=a("Map.prototype.forEach",!0),v=a("Set.prototype.forEach",!0);if(void 0===hr||!hr.versions||!hr.versions.node)var m=a("Map.prototype.iterator",!0),g=a("Set.prototype.iterator",!0),b=function(t){var e=!1;return{next:function(){try{return{done:e,value:e?void 0:t.next()}}catch(t){return e=!0,{done:!0,value:void 0}}}}};var _=a("Map.prototype.@@iterator",!0)||a("Map.prototype._es6-shim iterator_",!0),w=a("Set.prototype.@@iterator",!0)||a("Set.prototype._es6-shim iterator_",!0);t.exports=function(t){return function(t){if(p(t)){if(m)return b(m(t));if(_)return _(t);if(y){var e=[];return y(t,(function(t,r){s(e,[r,t])})),l(e)}}if(d(t)){if(g)return b(g(t));if(w)return w(t);if(v){var r=[];return v(t,(function(t){s(r,t)})),l(r)}}}(t)||h(t)}}else t.exports=function(t){if(null!=t)return h(t,!0)}}})),vr="function"==typeof Map&&Map.prototype,mr=Object.getOwnPropertyDescriptor&&vr?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,gr=vr&&mr&&"function"==typeof mr.get?mr.get:null,br=vr&&Map.prototype.forEach,_r="function"==typeof Set&&Set.prototype,wr=Object.getOwnPropertyDescriptor&&_r?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Or=_r&&wr&&"function"==typeof wr.get?wr.get:null,jr=_r&&Set.prototype.forEach,kr="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Er="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,Sr=Boolean.prototype.valueOf,xr=Object.prototype.toString,Pr=Function.prototype.toString,Ar=String.prototype.match,Ir="function"==typeof BigInt?BigInt.prototype.valueOf:null,Tr=Object.getOwnPropertySymbols,Dr="function"==typeof Symbol?Symbol.prototype.toString:null,Cr=Object.prototype.propertyIsEnumerable,Rr=o.R.custom,Mr=Rr&&qr(Rr)?Rr:null,$r=function t(e,r,n,o){var i=r||{};if(Fr(i,"quoteStyle")&&"single"!==i.quoteStyle&&"double"!==i.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Fr(i,"maxStringLength")&&("number"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=!Fr(i,"customInspect")||i.customInspect;if("boolean"!=typeof u)throw new TypeError('option "customInspect", if provided, must be `true` or `false`');if(Fr(i,"indent")&&null!==i.indent&&"\t"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return Qr(e,i);if("number"==typeof e)return 0===e?1/0/e>0?"0":"-0":String(e);if("bigint"==typeof e)return String(e)+"n";var a=void 0===i.depth?5:i.depth;if(void 0===n&&(n=0),n>=a&&a>0&&"object"==typeof e)return Br(e)?"[Array]":"[Object]";var s=function(t,e){var r;if("\t"===t.indent)r="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;r=Array(t.indent+1).join(" ")}return{base:r,prev:Array(e+1).join(r)}}(i,n);if(void 0===o)o=[];else if(Yr(o,e)>=0)return"[Circular]";function c(e,r,u){if(r&&(o=o.slice()).push(r),u){var a={depth:i.depth};return Fr(i,"quoteStyle")&&(a.quoteStyle=i.quoteStyle),t(e,a,n+1,o)}return t(e,i,n+1,o)}if("function"==typeof e){var f=function(t){if(t.name)return t.name;var e=Ar.call(Pr.call(t),/^function\s*([\w$]+)/);if(e)return e[1];return null}(e),l=Kr(e,c);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(l.length>0?" { "+l.join(", ")+" }":"")}if(qr(e)){var h=Dr.call(e);return"object"==typeof e?Vr(h):h}if(function(t){if(!t||"object"!=typeof t)return!1;if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return!0;return"string"==typeof t.nodeName&&"function"==typeof t.getAttribute}(e)){for(var p="<"+String(e.nodeName).toLowerCase(),d=e.attributes||[],y=0;y<d.length;y++)p+=" "+d[y].name+"="+Nr(Lr(d[y].value),"double",i);return p+=">",e.childNodes&&e.childNodes.length&&(p+="..."),p+="</"+String(e.nodeName).toLowerCase()+">"}if(Br(e)){if(0===e.length)return"[]";var v=Kr(e,c);return s&&!function(t){for(var e=0;e<t.length;e++)if(Yr(t[e],"\n")>=0)return!1;return!0}(v)?"["+Gr(v,s)+"]":"[ "+v.join(", ")+" ]"}if(function(t){return"[object Error]"===Wr(t)}(e)){var m=Kr(e,c);return 0===m.length?"["+String(e)+"]":"{ ["+String(e)+"] "+m.join(", ")+" }"}if("object"==typeof e&&u){if(Mr&&"function"==typeof e[Mr])return e[Mr]();if("function"==typeof e.inspect)return e.inspect()}if(function(t){if(!gr||!t||"object"!=typeof t)return!1;try{gr.call(t);try{Or.call(t)}catch(t){return!0}return t instanceof Map}catch(t){}return!1}(e)){var g=[];return br.call(e,(function(t,r){g.push(c(r,e,!0)+" => "+c(t,e))})),Hr("Map",gr.call(e),g,s)}if(function(t){if(!Or||!t||"object"!=typeof t)return!1;try{Or.call(t);try{gr.call(t)}catch(t){return!0}return t instanceof Set}catch(t){}return!1}(e)){var b=[];return jr.call(e,(function(t){b.push(c(t,e))})),Hr("Set",Or.call(e),b,s)}if(function(t){if(!kr||!t||"object"!=typeof t)return!1;try{kr.call(t,kr);try{Er.call(t,Er)}catch(t){return!0}return t instanceof WeakMap}catch(t){}return!1}(e))return Jr("WeakMap");if(function(t){if(!Er||!t||"object"!=typeof t)return!1;try{Er.call(t,Er);try{kr.call(t,kr)}catch(t){return!0}return t instanceof WeakSet}catch(t){}return!1}(e))return Jr("WeakSet");if(function(t){return"[object Number]"===Wr(t)}(e))return Vr(c(Number(e)));if(function(t){return"[object BigInt]"===Wr(t)}(e))return Vr(c(Ir.call(e)));if(function(t){return"[object Boolean]"===Wr(t)}(e))return Vr(Sr.call(e));if(function(t){return"[object String]"===Wr(t)}(e))return Vr(c(String(e)));if(!function(t){return"[object Date]"===Wr(t)}(e)&&!function(t){return"[object RegExp]"===Wr(t)}(e)){var _=Kr(e,c);return 0===_.length?"{}":s?"{"+Gr(_,s)+"}":"{ "+_.join(", ")+" }"}return String(e)};function Nr(t,e,r){var n="double"===(r.quoteStyle||e)?'"':"'";return n+t+n}function Lr(t){return String(t).replace(/"/g,"&quot;")}function Br(t){return"[object Array]"===Wr(t)}function qr(t){return"[object Symbol]"===Wr(t)}var Ur=Object.prototype.hasOwnProperty||function(t){return t in this};function Fr(t,e){return Ur.call(t,e)}function Wr(t){return xr.call(t)}function Yr(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Qr(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Qr(t.slice(0,e.maxStringLength),e)+n}return Nr(t.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,zr),"single",e)}function zr(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+e.toString(16).toUpperCase()}function Vr(t){return"Object("+t+")"}function Jr(t){return t+" { ? }"}function Hr(t,e,r,n){return t+" ("+e+") {"+(n?Gr(r,n):r.join(", "))+"}"}function Gr(t,e){if(0===t.length)return"";var r="\n"+e.prev+e.base;return r+t.join(","+r)+"\n"+e.prev}function Kr(t,e){var r=Br(t),n=[];if(r){n.length=t.length;for(var o=0;o<t.length;o++)n[o]=Fr(t,o)?e(t[o],t):""}for(var i in t)Fr(t,i)&&(r&&String(Number(i))===i&&i<t.length||(/[^\w$]/.test(i)?n.push(e(i,t)+": "+e(t[i],t)):n.push(i+": "+e(t[i],t))));if("function"==typeof Tr)for(var u=Tr(t),a=0;a<u.length;a++)Cr.call(t,u[a])&&n.push("["+e(u[a])+"]: "+e(t[u[a]],t));return n}var Xr=st("%TypeError%"),Zr=st("%WeakMap%",!0),tn=st("%Map%",!0),en=lt("WeakMap.prototype.get",!0),rn=lt("WeakMap.prototype.set",!0),nn=lt("WeakMap.prototype.has",!0),on=lt("Map.prototype.get",!0),un=lt("Map.prototype.set",!0),an=lt("Map.prototype.has",!0),sn=function(t,e){for(var r,n=t;null!==(r=n.next);n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r,r},cn=function(){var t,e,r,n={assert:function(t){if(!n.has(t))throw new Xr("Side channel does not contain "+$r(t))},get:function(n){if(Zr&&n&&("object"==typeof n||"function"==typeof n)){if(t)return en(t,n)}else if(tn){if(e)return on(e,n)}else if(r)return function(t,e){var r=sn(t,e);return r&&r.value}(r,n)},has:function(n){if(Zr&&n&&("object"==typeof n||"function"==typeof n)){if(t)return nn(t,n)}else if(tn){if(e)return an(e,n)}else if(r)return function(t,e){return!!sn(t,e)}(r,n);return!1},set:function(n,o){Zr&&n&&("object"==typeof n||"function"==typeof n)?(t||(t=new Zr),rn(t,n,o)):tn?(e||(e=new tn),un(e,n,o)):(r||(r={key:{},next:null}),function(t,e,r){var n=sn(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}}(r,n,o))}};return n},fn=Object.prototype.hasOwnProperty,ln=Object.prototype.toString,hn=function(t,e,r){if("[object Function]"!==ln.call(e))throw new TypeError("iterator must be a function");var n=t.length;if(n===+n)for(var o=0;o<n;o++)e.call(r,t[o],o,t);else for(var i in t)fn.call(t,i)&&e.call(r,t[i],i,t)},pn=Object.prototype.hasOwnProperty,dn=function(){return function(t,e,r){if(t.filter)return t.filter(e,r);if(null==t)throw new TypeError;if("function"!=typeof e)throw new TypeError;for(var n=[],o=0;o<t.length;o++)if(pn.call(t,o)){var i=t[o];e.call(r,i,o,t)&&n.push(i)}return n}(["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],(function(t){return"function"==typeof n.a[t]}))},yn=st("%Object.getOwnPropertyDescriptor%");if(yn)try{yn([],"length")}catch(t){yn=null}var vn=yn,mn=lt("Object.prototype.toString"),gn=D()&&"symbol"==typeof Symbol.toStringTag,bn=dn(),_n=lt("Array.prototype.indexOf",!0)||function(t,e){for(var r=0;r<t.length;r+=1)if(t[r]===e)return r;return-1},wn=lt("String.prototype.slice"),On={},jn=Object.getPrototypeOf;gn&&vn&&jn&&hn(bn,(function(t){var e=new n.a[t];if(!(Symbol.toStringTag in e))throw new EvalError("this engine has support for Symbol.toStringTag, but "+t+" does not have the property! Please report this.");var r=jn(e),o=vn(r,Symbol.toStringTag);if(!o){var i=jn(r);o=vn(i,Symbol.toStringTag)}On[t]=o.get}));var kn=function(t){if(!t||"object"!=typeof t)return!1;if(!gn){var e=wn(mn(t),8,-1);return _n(bn,e)>-1}return!!vn&&function(t){var e=!1;return hn(On,(function(r,n){if(!e)try{e=r.call(t)===n}catch(t){}})),e}(t)},En=lt("Object.prototype.toString"),Sn=D()&&"symbol"==typeof Symbol.toStringTag,xn=dn(),Pn=lt("String.prototype.slice"),An={},In=Object.getPrototypeOf;Sn&&vn&&In&&hn(xn,(function(t){if("function"==typeof n.a[t]){var e=new n.a[t];if(!(Symbol.toStringTag in e))throw new EvalError("this engine has support for Symbol.toStringTag, but "+t+" does not have the property! Please report this.");var r=In(e),o=vn(r,Symbol.toStringTag);if(!o){var i=In(r);o=vn(i,Symbol.toStringTag)}An[t]=o.get}}));var Tn=function(t){return!!kn(t)&&(Sn?function(t){var e=!1;return hn(An,(function(r,n){if(!e)try{var o=r.call(t);o===n&&(e=o)}catch(t){}})),e}(t):Pn(En(t),8,-1))},Dn=function(t){return null!=t},Cn=I(),Rn=Object,Mn=lt("Array.prototype.push"),$n=lt("Object.prototype.propertyIsEnumerable"),Nn=Cn?Object.getOwnPropertySymbols:null,Ln=function(t,e){if(!Dn(t))throw new TypeError("target must be an object");var r,n,o,i,u,a,s,c=Rn(t);for(r=1;r<arguments.length;++r){n=Rn(arguments[r]),i=A(n);var f=Cn&&(Object.getOwnPropertySymbols||Nn);if(f)for(u=f(n),o=0;o<u.length;++o)s=u[o],$n(n,s)&&Mn(i,s);for(o=0;o<i.length;++o)a=n[s=i[o]],$n(n,s)&&(c[s]=a)}return c},Bn=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),r={},n=0;n<e.length;++n)r[e[n]]=e[n];var o=Object.assign({},r),i="";for(var u in o)i+=u;return t!==i}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch(e){return"y"===t[1]}return!1}()?Ln:Object.assign:Ln},qn=ct.apply(Bn()),Un=function(t,e){return qn(Object,arguments)};Et(Un,{getPolyfill:Bn,implementation:Ln,shim:function(){var t=Bn();return Et(Object,{assign:t},{assign:function(){return Object.assign!==t}}),t}});var Fn=Un,Wn=lt("Date.prototype.getTime"),Yn=Object.getPrototypeOf,Qn=lt("Object.prototype.toString"),zn=st("%Set%",!0),Vn=lt("Map.prototype.has",!0),Jn=lt("Map.prototype.get",!0),Hn=lt("Map.prototype.size",!0),Gn=lt("Set.prototype.add",!0),Kn=lt("Set.prototype.delete",!0),Xn=lt("Set.prototype.has",!0),Zn=lt("Set.prototype.size",!0);function to(t,e,r,n){for(var o,i=yr(t);(o=i.next())&&!o.done;)if(io(e,o.value,r,n))return Kn(t,o.value),!0;return!1}function eo(t){return void 0===t?null:"object"!=typeof t?"symbol"!=typeof t&&("string"!=typeof t&&"number"!=typeof t||+t==+t):void 0}function ro(t,e,r,n,o,i){var u=eo(r);if(null!=u)return u;var a=Jn(e,u),s=Fn({},o,{strict:!1});return!(void 0===a&&!Vn(e,u)||!io(n,a,s,i))&&(!Vn(t,u)&&io(n,a,s,i))}function no(t,e,r){var n=eo(r);return null!=n?n:Xn(e,n)&&!Xn(t,n)}function oo(t,e,r,n,o,i){for(var u,a,s=yr(t);(u=s.next())&&!u.done;)if(io(r,a=u.value,o,i)&&io(n,Jn(e,a),o,i))return Kn(t,a),!0;return!1}function io(t,e,r,n){var o=r||{};if(o.strict?Rt(t,e):t===e)return!0;if(Oe(t)!==Oe(e))return!1;if(!t||!e||"object"!=typeof t&&"object"!=typeof e)return o.strict?Rt(t,e):t==e;var i,u=n.has(t),a=n.has(e);if(u&&a){if(n.get(t)===n.get(e))return!0}else i={};return u||n.set(t,i),a||n.set(e,i),function(t,e,r,n){var o,i;if(typeof t!=typeof e)return!1;if(null==t||null==e)return!1;if(Qn(t)!==Qn(e))return!1;if(mt(t)!==mt(e))return!1;var u=ne(t),a=ne(e);if(u!==a)return!1;var s=t instanceof Error,c=e instanceof Error;if(s!==c)return!1;if((s||c)&&(t.name!==e.name||t.message!==e.message))return!1;var f=Bt(t),l=Bt(e);if(f!==l)return!1;if((f||l)&&(t.source!==e.source||ee(t)!==ee(e)))return!1;var h=ae(t),p=ae(e);if(h!==p)return!1;if((h||p)&&Wn(t)!==Wn(e))return!1;if(r.strict&&Yn&&Yn(t)!==Yn(e))return!1;if(Tn(t)!==Tn(e))return!1;var d=uo(t),y=uo(e);if(d!==y)return!1;if(d||y){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!=typeof e)return!1;var v=A(t),m=A(e);if(v.length!==m.length)return!1;for(v.sort(),m.sort(),o=v.length-1;o>=0;o--)if(v[o]!=m[o])return!1;for(o=v.length-1;o>=0;o--)if(!io(t[i=v[o]],e[i],r,n))return!1;var g=Ue(t),b=Ue(e);if(g!==b)return!1;if("Set"===g||"Set"===b)return function(t,e,r,n){if(Zn(t)!==Zn(e))return!1;var o,i,u,a=yr(t),s=yr(e);for(;(o=a.next())&&!o.done;)if(o.value&&"object"==typeof o.value)u||(u=new zn),Gn(u,o.value);else if(!Xn(e,o.value)){if(r.strict)return!1;if(!no(t,e,o.value))return!1;u||(u=new zn),Gn(u,o.value)}if(u){for(;(i=s.next())&&!i.done;)if(i.value&&"object"==typeof i.value){if(!to(u,i.value,r.strict,n))return!1}else if(!r.strict&&!Xn(t,i.value)&&!to(u,i.value,r.strict,n))return!1;return 0===Zn(u)}return!0}(t,e,r,n);if("Map"===g)return function(t,e,r,n){if(Hn(t)!==Hn(e))return!1;var o,i,u,a,s,c,f=yr(t),l=yr(e);for(;(o=f.next())&&!o.done;)if(a=o.value[0],s=o.value[1],a&&"object"==typeof a)u||(u=new zn),Gn(u,a);else if(void 0===(c=Jn(e,a))&&!Vn(e,a)||!io(s,c,r,n)){if(r.strict)return!1;if(!ro(t,e,a,s,r,n))return!1;u||(u=new zn),Gn(u,a)}if(u){for(;(i=l.next())&&!i.done;)if(a=i.value[0],c=i.value[1],a&&"object"==typeof a){if(!oo(u,t,a,c,r,n))return!1}else if(!(r.strict||t.has(a)&&io(Jn(t,a),c,r,n)||oo(u,t,a,c,Fn({},r,{strict:!1}),n)))return!1;return 0===Zn(u)}return!0}(t,e,r,n);return!0}(t,e,o,n)}function uo(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&(!(t.length>0&&"number"!=typeof t[0])&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))))}var ao=function(t,e,r){return io(t,e,r,cn())},so=Object(n.c)((function(t){!function(e){function r(t){return Math.floor(Math.random()*t)}var n=function(t,e){return isNaN(e)||e<1?void 0:function(t,e){for(var n="",o=t.length;e--;)n+=t[r(o)];return n}(t,e)};function o(t){t="string"==typeof t&&t.length>0?t:"abcdefghijklmnopqrstuvwxzy0123456789";var e=n.bind(n,t);return e.salt=function(){return t},e.create=o,e.gen=o,e}n.gen=o,t.exports=o()}()})),co=[],fo=[],lo="undefined"!=typeof Uint8Array?Uint8Array:Array,ho=!1;function po(){ho=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)co[e]=t[e],fo[t.charCodeAt(e)]=e;fo["-".charCodeAt(0)]=62,fo["_".charCodeAt(0)]=63}function yo(t,e,r){for(var n,o,i=[],u=e;u<r;u+=3)n=(t[u]<<16)+(t[u+1]<<8)+t[u+2],i.push(co[(o=n)>>18&63]+co[o>>12&63]+co[o>>6&63]+co[63&o]);return i.join("")}function vo(t){var e;ho||po();for(var r=t.length,n=r%3,o="",i=[],u=16383,a=0,s=r-n;a<s;a+=u)i.push(yo(t,a,a+u>s?s:a+u));return 1===n?(e=t[r-1],o+=co[e>>2],o+=co[e<<4&63],o+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],o+=co[e>>10],o+=co[e>>4&63],o+=co[e<<2&63],o+="="),i.push(o),i.join("")}function mo(t,e,r,n,o){var i,u,a=8*o-n-1,s=(1<<a)-1,c=s>>1,f=-7,l=r?o-1:0,h=r?-1:1,p=t[e+l];for(l+=h,i=p&(1<<-f)-1,p>>=-f,f+=a;f>0;i=256*i+t[e+l],l+=h,f-=8);for(u=i&(1<<-f)-1,i>>=-f,f+=n;f>0;u=256*u+t[e+l],l+=h,f-=8);if(0===i)i=1-c;else{if(i===s)return u?NaN:1/0*(p?-1:1);u+=Math.pow(2,n),i-=c}return(p?-1:1)*u*Math.pow(2,i-n)}function go(t,e,r,n,o,i){var u,a,s,c=8*i-o-1,f=(1<<c)-1,l=f>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,u=f):(u=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-u))<1&&(u--,s*=2),(e+=u+l>=1?h/s:h*Math.pow(2,1-l))*s>=2&&(u++,s/=2),u+l>=f?(a=0,u=f):u+l>=1?(a=(e*s-1)*Math.pow(2,o),u+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,o),u=0));o>=8;t[r+p]=255&a,p+=d,a/=256,o-=8);for(u=u<<o|a,c+=o;c>0;t[r+p]=255&u,p+=d,u/=256,c-=8);t[r+p-d]|=128*y}var bo={}.toString,_o=Array.isArray||function(t){return"[object Array]"==bo.call(t)};function wo(){return jo.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Oo(t,e){if(wo()<e)throw new RangeError("Invalid typed array length");return jo.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=jo.prototype:(null===t&&(t=new jo(e)),t.length=e),t}function jo(t,e,r){if(!(jo.TYPED_ARRAY_SUPPORT||this instanceof jo))return new jo(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return So(this,t)}return ko(this,t,e,r)}function ko(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);jo.TYPED_ARRAY_SUPPORT?(t=e).__proto__=jo.prototype:t=xo(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!jo.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Io(e,r),o=(t=Oo(t,n)).write(e,r);o!==n&&(t=t.slice(0,o));return t}(t,e,r):function(t,e){if(Ao(e)){var r=0|Po(e.length);return 0===(t=Oo(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?Oo(t,0):xo(t,e);if("Buffer"===e.type&&_o(e.data))return xo(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function Eo(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function So(t,e){if(Eo(e),t=Oo(t,e<0?0:0|Po(e)),!jo.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function xo(t,e){var r=e.length<0?0:0|Po(e.length);t=Oo(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function Po(t){if(t>=wo())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+wo().toString(16)+" bytes");return 0|t}function Ao(t){return!(null==t||!t._isBuffer)}function Io(t,e){if(Ao(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return ni(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return oi(t).length;default:if(n)return ni(t).length;e=(""+e).toLowerCase(),n=!0}}function To(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return zo(this,e,r);case"utf8":case"utf-8":return Fo(this,e,r);case"ascii":return Yo(this,e,r);case"latin1":case"binary":return Qo(this,e,r);case"base64":return Uo(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vo(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function Do(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Co(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=jo.from(e,n)),Ao(e))return 0===e.length?-1:Ro(t,e,r,n,o);if("number"==typeof e)return e&=255,jo.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Ro(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function Ro(t,e,r,n,o){var i,u=1,a=t.length,s=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;u=2,a/=2,s/=2,r/=2}function c(t,e){return 1===u?t[e]:t.readUInt16BE(e*u)}if(o){var f=-1;for(i=r;i<a;i++)if(c(t,i)===c(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===s)return f*u}else-1!==f&&(i-=i-f),f=-1}else for(r+s>a&&(r=a-s),i=r;i>=0;i--){for(var l=!0,h=0;h<s;h++)if(c(t,i+h)!==c(e,h)){l=!1;break}if(l)return i}return-1}function Mo(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var u=0;u<n;++u){var a=parseInt(e.substr(2*u,2),16);if(isNaN(a))return u;t[r+u]=a}return u}function $o(t,e,r,n){return ii(ni(e,t.length-r),t,r,n)}function No(t,e,r,n){return ii(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function Lo(t,e,r,n){return No(t,e,r,n)}function Bo(t,e,r,n){return ii(oi(e),t,r,n)}function qo(t,e,r,n){return ii(function(t,e){for(var r,n,o,i=[],u=0;u<t.length&&!((e-=2)<0);++u)n=(r=t.charCodeAt(u))>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function Uo(t,e,r){return 0===e&&r===t.length?vo(t):vo(t.slice(e,r))}function Fo(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,u,a,s,c=t[o],f=null,l=c>239?4:c>223?3:c>191?2:1;if(o+l<=r)switch(l){case 1:c<128&&(f=c);break;case 2:128==(192&(i=t[o+1]))&&(s=(31&c)<<6|63&i)>127&&(f=s);break;case 3:i=t[o+1],u=t[o+2],128==(192&i)&&128==(192&u)&&(s=(15&c)<<12|(63&i)<<6|63&u)>2047&&(s<55296||s>57343)&&(f=s);break;case 4:i=t[o+1],u=t[o+2],a=t[o+3],128==(192&i)&&128==(192&u)&&128==(192&a)&&(s=(15&c)<<18|(63&i)<<12|(63&u)<<6|63&a)>65535&&s<1114112&&(f=s)}null===f?(f=65533,l=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),o+=l}return function(t){var e=t.length;if(e<=Wo)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Wo));return r}(n)}jo.TYPED_ARRAY_SUPPORT=void 0===u.TYPED_ARRAY_SUPPORT||u.TYPED_ARRAY_SUPPORT,jo.poolSize=8192,jo._augment=function(t){return t.__proto__=jo.prototype,t},jo.from=function(t,e,r){return ko(null,t,e,r)},jo.TYPED_ARRAY_SUPPORT&&(jo.prototype.__proto__=Uint8Array.prototype,jo.__proto__=Uint8Array),jo.alloc=function(t,e,r){return function(t,e,r,n){return Eo(e),e<=0?Oo(t,e):void 0!==r?"string"==typeof n?Oo(t,e).fill(r,n):Oo(t,e).fill(r):Oo(t,e)}(null,t,e,r)},jo.allocUnsafe=function(t){return So(null,t)},jo.allocUnsafeSlow=function(t){return So(null,t)},jo.isBuffer=function(t){return null!=t&&(!!t._isBuffer||ui(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&ui(t.slice(0,0))}(t))},jo.compare=function(t,e){if(!Ao(t)||!Ao(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},jo.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},jo.concat=function(t,e){if(!_o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return jo.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=jo.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var i=t[r];if(!Ao(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},jo.byteLength=Io,jo.prototype._isBuffer=!0,jo.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Do(this,e,e+1);return this},jo.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Do(this,e,e+3),Do(this,e+1,e+2);return this},jo.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Do(this,e,e+7),Do(this,e+1,e+6),Do(this,e+2,e+5),Do(this,e+3,e+4);return this},jo.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Fo(this,0,t):To.apply(this,arguments)},jo.prototype.equals=function(t){if(!Ao(t))throw new TypeError("Argument must be a Buffer");return this===t||0===jo.compare(this,t)},jo.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},jo.prototype.compare=function(t,e,r,n,o){if(!Ao(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),u=(r>>>=0)-(e>>>=0),a=Math.min(i,u),s=this.slice(n,o),c=t.slice(e,r),f=0;f<a;++f)if(s[f]!==c[f]){i=s[f],u=c[f];break}return i<u?-1:u<i?1:0},jo.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},jo.prototype.indexOf=function(t,e,r){return Co(this,t,e,r,!0)},jo.prototype.lastIndexOf=function(t,e,r){return Co(this,t,e,r,!1)},jo.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return Mo(this,t,e,r);case"utf8":case"utf-8":return $o(this,t,e,r);case"ascii":return No(this,t,e,r);case"latin1":case"binary":return Lo(this,t,e,r);case"base64":return Bo(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return qo(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},jo.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Wo=4096;function Yo(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function Qo(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function zo(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=e;i<r;++i)o+=ri(t[i]);return o}function Vo(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function Jo(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function Ho(t,e,r,n,o,i){if(!Ao(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Go(t,e,r,n){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-r,2);o<i;++o)t[r+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function Ko(t,e,r,n){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-r,4);o<i;++o)t[r+o]=e>>>8*(n?o:3-o)&255}function Xo(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Zo(t,e,r,n,o){return o||Xo(t,0,r,4),go(t,e,r,n,23,4),r+4}function ti(t,e,r,n,o){return o||Xo(t,0,r,8),go(t,e,r,n,52,8),r+8}jo.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),jo.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=jo.prototype;else{var o=e-t;r=new jo(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+t]}return r},jo.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||Jo(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},jo.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||Jo(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},jo.prototype.readUInt8=function(t,e){return e||Jo(t,1,this.length),this[t]},jo.prototype.readUInt16LE=function(t,e){return e||Jo(t,2,this.length),this[t]|this[t+1]<<8},jo.prototype.readUInt16BE=function(t,e){return e||Jo(t,2,this.length),this[t]<<8|this[t+1]},jo.prototype.readUInt32LE=function(t,e){return e||Jo(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},jo.prototype.readUInt32BE=function(t,e){return e||Jo(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},jo.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||Jo(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},jo.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||Jo(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},jo.prototype.readInt8=function(t,e){return e||Jo(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},jo.prototype.readInt16LE=function(t,e){e||Jo(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},jo.prototype.readInt16BE=function(t,e){e||Jo(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},jo.prototype.readInt32LE=function(t,e){return e||Jo(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},jo.prototype.readInt32BE=function(t,e){return e||Jo(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},jo.prototype.readFloatLE=function(t,e){return e||Jo(t,4,this.length),mo(this,t,!0,23,4)},jo.prototype.readFloatBE=function(t,e){return e||Jo(t,4,this.length),mo(this,t,!1,23,4)},jo.prototype.readDoubleLE=function(t,e){return e||Jo(t,8,this.length),mo(this,t,!0,52,8)},jo.prototype.readDoubleBE=function(t,e){return e||Jo(t,8,this.length),mo(this,t,!1,52,8)},jo.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||Ho(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},jo.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||Ho(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},jo.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,1,255,0),jo.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},jo.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,2,65535,0),jo.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Go(this,t,e,!0),e+2},jo.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,2,65535,0),jo.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Go(this,t,e,!1),e+2},jo.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,4,4294967295,0),jo.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Ko(this,t,e,!0),e+4},jo.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,4,4294967295,0),jo.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ko(this,t,e,!1),e+4},jo.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);Ho(this,t,e,r,o-1,-o)}var i=0,u=1,a=0;for(this[e]=255&t;++i<r&&(u*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/u>>0)-a&255;return e+r},jo.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);Ho(this,t,e,r,o-1,-o)}var i=r-1,u=1,a=0;for(this[e+i]=255&t;--i>=0&&(u*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/u>>0)-a&255;return e+r},jo.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,1,127,-128),jo.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},jo.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,2,32767,-32768),jo.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Go(this,t,e,!0),e+2},jo.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,2,32767,-32768),jo.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Go(this,t,e,!1),e+2},jo.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,4,2147483647,-2147483648),jo.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Ko(this,t,e,!0),e+4},jo.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||Ho(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),jo.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ko(this,t,e,!1),e+4},jo.prototype.writeFloatLE=function(t,e,r){return Zo(this,t,e,!0,r)},jo.prototype.writeFloatBE=function(t,e,r){return Zo(this,t,e,!1,r)},jo.prototype.writeDoubleLE=function(t,e,r){return ti(this,t,e,!0,r)},jo.prototype.writeDoubleBE=function(t,e,r){return ti(this,t,e,!1,r)},jo.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o,i=n-r;if(this===t&&r<e&&e<n)for(o=i-1;o>=0;--o)t[o+e]=this[o+r];else if(i<1e3||!jo.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},jo.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!jo.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var u=Ao(t)?t:ni(new jo(t,n).toString()),a=u.length;for(i=0;i<r-e;++i)this[i+e]=u[i%a]}return this};var ei=/[^+\/0-9A-Za-z-_]/g;function ri(t){return t<16?"0"+t.toString(16):t.toString(16)}function ni(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],u=0;u<n;++u){if((r=t.charCodeAt(u))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(u+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function oi(t){return function(t){var e,r,n,o,i,u;ho||po();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===t[a-2]?2:"="===t[a-1]?1:0,u=new lo(3*a/4-i),n=i>0?a-4:a;var s=0;for(e=0,r=0;e<n;e+=4,r+=3)o=fo[t.charCodeAt(e)]<<18|fo[t.charCodeAt(e+1)]<<12|fo[t.charCodeAt(e+2)]<<6|fo[t.charCodeAt(e+3)],u[s++]=o>>16&255,u[s++]=o>>8&255,u[s++]=255&o;return 2===i?(o=fo[t.charCodeAt(e)]<<2|fo[t.charCodeAt(e+1)]>>4,u[s++]=255&o):1===i&&(o=fo[t.charCodeAt(e)]<<10|fo[t.charCodeAt(e+1)]<<4|fo[t.charCodeAt(e+2)]>>2,u[s++]=o>>8&255,u[s++]=255&o),u}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(ei,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function ii(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function ui(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var ai=Object(n.c)((function(t){var e=function(){function t(t,e){return null!=e&&t instanceof e}var e,r,n;try{e=Map}catch(t){e=function(){}}try{r=Set}catch(t){r=function(){}}try{n=Promise}catch(t){n=function(){}}function o(i,a,s,c,f){"object"==typeof a&&(s=a.depth,c=a.prototype,f=a.includeNonEnumerable,a=a.circular);var l=[],h=[];return void 0===a&&(a=!0),void 0===s&&(s=1/0),function i(s,p){if(null===s)return null;if(0===p)return s;var d,y;if("object"!=typeof s)return s;if(t(s,e))d=new e;else if(t(s,r))d=new r;else if(t(s,n))d=new n((function(t,e){s.then((function(e){t(i(e,p-1))}),(function(t){e(i(t,p-1))}))}));else if(o.__isArray(s))d=[];else if(o.__isRegExp(s))d=new RegExp(s.source,u(s)),s.lastIndex&&(d.lastIndex=s.lastIndex);else if(o.__isDate(s))d=new Date(s.getTime());else{if(jo.isBuffer(s))return d=jo.allocUnsafe?jo.allocUnsafe(s.length):new jo(s.length),s.copy(d),d;t(s,Error)?d=Object.create(s):void 0===c?(y=Object.getPrototypeOf(s),d=Object.create(y)):(d=Object.create(c),y=c)}if(a){var v=l.indexOf(s);if(-1!=v)return h[v];l.push(s),h.push(d)}for(var m in t(s,e)&&s.forEach((function(t,e){var r=i(e,p-1),n=i(t,p-1);d.set(r,n)})),t(s,r)&&s.forEach((function(t){var e=i(t,p-1);d.add(e)})),s){var g;y&&(g=Object.getOwnPropertyDescriptor(y,m)),g&&null==g.set||(d[m]=i(s[m],p-1))}if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(s);for(m=0;m<b.length;m++){var _=b[m];(!(O=Object.getOwnPropertyDescriptor(s,_))||O.enumerable||f)&&(d[_]=i(s[_],p-1),O.enumerable||Object.defineProperty(d,_,{enumerable:!1}))}}if(f){var w=Object.getOwnPropertyNames(s);for(m=0;m<w.length;m++){var O,j=w[m];(O=Object.getOwnPropertyDescriptor(s,j))&&O.enumerable||(d[j]=i(s[j],p-1),Object.defineProperty(d,j,{enumerable:!1}))}}return d}(i,s)}function i(t){return Object.prototype.toString.call(t)}function u(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return o.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},o.__objToStr=i,o.__isDate=function(t){return"object"==typeof t&&"[object Date]"===i(t)},o.__isArray=function(t){return"object"==typeof t&&"[object Array]"===i(t)},o.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===i(t)},o.__getRegExpFlags=u,o}();t.exports&&(t.exports=e)}));function si(t){var e=t.split("-"),r="RxDB";return e.forEach((function(t){r+=hi(t)})),r+="Plugin",new Error("You are using a function which must be overwritten by a plugin.\n        You should either prevent the usage of this function or add the plugin via:\n            import { "+r+" } from 'rxdb/plugins/"+t+"';\n            addRxPlugin("+r+");\n        ")}var ci=0;function fi(){var t=(new Date).getTime();return t<=ci&&(t=ci+1),ci=t,t}function li(){return new Promise((function(t){return setTimeout(t,0)}))}function hi(t){return(t+="").charAt(0).toUpperCase()+t.substr(1)}function pi(t){for(;"."===t.charAt(0);)t=t.substr(1);for(;"."===t.slice(-1);)t=t.slice(0,-1);return t}function di(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return t;if(!e&&Array.isArray(t))return t.sort((function(t,e){return"string"==typeof t&&"string"==typeof e?t.localeCompare(e):"object"==typeof t?1:-1})).map((function(t){return di(t,e)}));if("object"==typeof t&&!Array.isArray(t)){if(t instanceof RegExp)return t;var r={};return Object.keys(t).sort((function(t,e){return t.localeCompare(e)})).forEach((function(n){r[n]=di(t[n],e)})),r}return t}function yi(t,e){return e instanceof RegExp?e.toString():e}function vi(t){var e={db:t};return"string"==typeof t&&(e={adapter:t}),e}var mi=function(t){return t?ai(t,!1):t};function gi(t){return Object.assign({},t)}function bi(t){var e=t.split("-")[0];return parseInt(e,10)}(function(){"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!(void 0===hr||"object"!=typeof hr.versions||!hr.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron"))})();function _i(t,e,r){return Object.defineProperty(t,e,{get:function(){return r}}),r}var wi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e},Oi=Object(n.c)((function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e(r)}t.exports=e})),ji=Object(n.c)((function(t){function e(r,n){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(r,n)}t.exports=e}));var ki=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")};var Ei=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}},Si=Object(n.c)((function(t){function e(r,n,o){return Ei()?t.exports=e=Reflect.construct:t.exports=e=function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&ji(o,r.prototype),o},e.apply(null,arguments)}t.exports=e})),xi=Object(n.c)((function(t){function e(r){var n="function"==typeof Map?new Map:void 0;return t.exports=e=function(t){if(null===t||!ki(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return Si(t,arguments,Oi(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),ji(e,t)},e(r)}t.exports=e})),Pi={isDevMode:function(){return!1},validatePassword:function(t){throw si("encryption")},createKeyCompressor:function(t){throw si("key-compression")},checkAdapter:function(t){throw si("adapter-check")},tunnelErrorMessage:function(t){return"RxDB Error-Code "+t+".\n        - To find out what this means, use the dev-mode-plugin https://pubkey.github.io/rxdb/custom-build.html#dev-mode\n        - Or search for this code https://github.com/pubkey/rxdb/search?q="+t+"\n        "}};function Ai(t,e,r){return"RxError ("+e+"):\n"+t+"\n"+function(t){var e="";return 0===Object.keys(t).length?e:(e+="Given parameters: {\n",e+=Object.keys(t).map((function(e){var r="[object Object]";try{r=JSON.stringify(t[e],(function(t,e){return void 0===e?null:e}),2)}catch(t){}return e+":"+r})).join("\n"),e+="}")}(r)}var Ii=function(t){function e(e,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Ai(r,e,o);return(n=t.call(this,i)||this).code=e,n.message=i,n.parameters=o,n.rxdb=!0,n}return wi(e,t),e.prototype.toString=function(){return this.message},c(e,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}]),e}(xi(Error)),Ti=function(t){function e(e,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Ai(r,e,o);return(n=t.call(this,i)||this).code=e,n.message=i,n.parameters=o,n.rxdb=!0,n}return wi(e,t),e.prototype.toString=function(){return this.message},c(e,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}]),e}(xi(TypeError));function Di(t,e){return new Ii(t,Pi.tunnelErrorMessage(t),e)}function Ci(t,e){return new Ti(t,Pi.tunnelErrorMessage(t),e)}var Ri={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],createRxQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreatePouchDb:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[]};function Mi(t,e){Ri[t].forEach((function(t){return t(e)}))}var $i=Object(n.c)((function(t){var e=function(t){var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,i=Object.create(o.prototype),u=new P(n||[]);return i._invoke=function(t,e,r){var n=l;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var u=r.delegate;if(u){var a=E(u,r);if(a){if(a===y)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var s=f(t,e,r);if("normal"===s.type){if(n=r.done?d:h,s.arg===y)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=d,r.method="throw",r.arg=s.arg)}}}(t,r,u),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l="suspendedStart",h="suspendedYield",p="executing",d="completed",y={};function v(){}function m(){}function g(){}var b={};b[i]=function(){return this};var _=Object.getPrototypeOf,w=_&&_(_(A([])));w&&w!==r&&n.call(w,i)&&(b=w);var O=g.prototype=v.prototype=Object.create(b);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,u,a){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,u,a)}),(function(t){r("throw",t,u,a)})):e.resolve(l).then((function(t){c.value=t,u(c)}),(function(t){return r("throw",t,u,a)}))}a(s.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=f(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,u=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return u.next=u}}return{next:I}}function I(){return{value:e,done:!0}}return m.prototype=O.constructor=g,g.constructor=m,m.displayName=s(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,a,"GeneratorFunction")),t.prototype=Object.create(O),t},t.awrap=function(t){return{__await:t}},j(k.prototype),k.prototype[u]=function(){return this},t.AsyncIterator=k,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var u=new k(c(e,r,n,o),i);return t.isGeneratorFunction(r)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},j(O),s(O,a,"Generator"),O[i]=function(){return this},O.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=A,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return a.type="throw",a.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],a=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var s=n.call(u,"catchLoc"),c=n.call(u,"finallyLoc");if(s&&c){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(s){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}));function Ni(t,e,r,n,o,i,u){try{var a=t[i](u),s=a.value}catch(t){return void r(t)}a.done?e(s):Promise.resolve(s).then(n,o)}var Li=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function u(t){Ni(i,n,o,u,a,"next",t)}function a(t){Ni(i,n,o,u,a,"throw",t)}u(void 0)}))}},Bi=function(t,e){return(Bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function qi(t,e){function r(){this.constructor=t}Bi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function Ui(t){return"function"==typeof t}var Fi=!1,Wi={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;Fi=t},get useDeprecatedSynchronousErrorHandling(){return Fi}};function Yi(t){setTimeout((function(){throw t}),0)}var Qi={closed:!0,next:function(t){},error:function(t){if(Wi.useDeprecatedSynchronousErrorHandling)throw t;Yi(t)},complete:function(){}},zi=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function Vi(t){return null!==t&&"object"==typeof t}var Ji=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),Hi=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this,n=r._parentOrParents,o=r._ctorUnsubscribe,i=r._unsubscribe,u=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var a=0;a<n.length;++a){n[a].remove(this)}if(Ui(i)){o&&(this._unsubscribe=void 0);try{i.call(this)}catch(t){e=t instanceof Ji?Gi(t.errors):[t]}}if(zi(u)){a=-1;for(var s=u.length;++a<s;){var c=u[a];if(Vi(c))try{c.unsubscribe()}catch(t){e=e||[],t instanceof Ji?e=e.concat(Gi(t.errors)):e.push(t)}}}if(e)throw new Ji(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof t){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function Gi(t){return t.reduce((function(t,e){return t.concat(e instanceof Ji?e.errors:e)}),[])}var Ki=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Xi=function(t){function e(r,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=Qi;break;case 1:if(!r){i.destination=Qi;break}if("object"==typeof r){r instanceof e?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new Zi(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new Zi(i,r,n,o)}return i}return qi(e,t),e.prototype[Ki]=function(){return this},e.create=function(t,r,n){var o=new e(t,r,n);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(Hi),Zi=function(t){function e(e,r,n,o){var i,u=t.call(this)||this;u._parentSubscriber=e;var a=u;return Ui(r)?i=r:r&&(i=r.next,n=r.error,o=r.complete,r!==Qi&&(Ui((a=Object.create(r)).unsubscribe)&&u.add(a.unsubscribe.bind(a)),a.unsubscribe=u.unsubscribe.bind(u))),u._context=a,u._next=i,u._error=n,u._complete=o,u}return qi(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;Wi.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=Wi.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Yi(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Yi(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};Wi.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),Wi.useDeprecatedSynchronousErrorHandling)throw t;Yi(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!Wi.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return Wi.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Yi(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(Xi);var tu=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function eu(t){return t}function ru(t){return 0===t.length?eu:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var nu=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof Xi)return t;if(t[Ki])return t[Ki]()}return t||e||r?new Xi(t,e,r):new Xi(Qi)}(t,e,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||Wi.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),Wi.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){Wi.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof Xi?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=ou(e))((function(e,n){var o;o=r.subscribe((function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[tu]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:ru(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=ou(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function ou(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var iu=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),uu=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return qi(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(Hi),au=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return qi(e,t),e}(Xi),su=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return qi(e,t),e.prototype[Ki]=function(){return new au(this)},e.prototype.lift=function(t){var e=new cu(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new iu;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new iu;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new iu;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new iu;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new iu;return this.hasError?(t.error(this.thrownError),Hi.EMPTY):this.isStopped?(t.complete(),Hi.EMPTY):(this.observers.push(t),new uu(this,t))},e.prototype.asObservable=function(){var t=new nu;return t.source=this,t},e.create=function(t,e){return new cu(t,e)},e}(nu),cu=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return qi(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):Hi.EMPTY},e}(su),fu=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return qi(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new iu;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(su),lu=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n}return qi(e,t),e.prototype.schedule=function(e,r){return void 0===r&&(r=0),r>0?t.prototype.schedule.call(this,e,r):(this.delay=r,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,r){return r>0||this.closed?t.prototype.execute.call(this,e,r):this._execute(e,r)},e.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?t.prototype.requestAsyncId.call(this,e,r,n):e.flush(this)},e}(function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return qi(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,r){return t.call(this)||this}return qi(e,t),e.prototype.schedule=function(t,e){return this},e}(Hi))),hu=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),pu=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qi(e,t),e}(function(t){function e(r,n){void 0===n&&(n=hu.now);var o=t.call(this,r,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():n()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return qi(e,t),e.prototype.schedule=function(r,n,o){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,n,o):t.prototype.schedule.call(this,r,n,o)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(hu)))(lu),du=new nu((function(t){return t.complete()}));function yu(t){return t?function(t){return new nu((function(e){return t.schedule((function(){return e.complete()}))}))}(t):du}function vu(t){return t&&"function"==typeof t.schedule}var mu=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}};function gu(t,e){return new nu((function(r){var n=new Hi,o=0;return n.add(e.schedule((function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}function bu(t,e){return e?gu(t,e):new nu(mu(t))}function _u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return vu(r)?(t.pop(),gu(t,r)):bu(t)}function wu(t){var e=t.error;t.subscriber.error(e)}var Ou=function(){function t(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},t.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},t.prototype.toObservable=function(){var t,e;switch(this.kind){case"N":return _u(this.value);case"E":return t=this.error,new nu(e?function(r){return e.schedule(wu,0,{error:t,subscriber:r})}:function(e){return e.error(t)});case"C":return yu()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}(),ju=function(t){function e(e,r,n){void 0===n&&(n=0);var o=t.call(this,e)||this;return o.scheduler=r,o.delay=n,o}return qi(e,t),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new ku(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(Ou.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(Ou.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(Ou.createComplete()),this.unsubscribe()},e}(Xi),ku=function(){return function(t,e){this.notification=t,this.destination=e}}(),Eu=function(t){function e(e,r,n){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY);var o=t.call(this)||this;return o.scheduler=n,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=e<1?1:e,o._windowTime=r<1?1:r,r===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return qi(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var r=this._events;r.push(e),r.length>this._bufferSize&&r.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new Su(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,r=this._infiniteTimeWindow,n=r?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,i=n.length;if(this.closed)throw new iu;if(this.isStopped||this.hasError?e=Hi.EMPTY:(this.observers.push(t),e=new uu(this,t)),o&&t.add(t=new ju(t,o)),r)for(var u=0;u<i&&!t.closed;u++)t.next(n[u]);else for(u=0;u<i&&!t.closed;u++)t.next(n[u].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||pu).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,r=this._windowTime,n=this._events,o=n.length,i=0;i<o&&!(t-n[i].time<r);)i++;return o>e&&(i=Math.max(i,o-e)),i>0&&n.splice(0,i),n},e}(su),Su=function(){return function(t,e){this.time=t,this.value=e}}();function xu(){}var Pu=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),Au=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}();function Iu(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new Tu(t,e))}}var Tu=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Du(t,this.project,this.thisArg))},t}(),Du=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return qi(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Xi);function Cu(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var Ru=Cu(),Mu=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function $u(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var Nu=function(t){if(t&&"function"==typeof t[tu])return n=t,function(t){var e=n[tu]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(Mu(t))return mu(t);if($u(t))return r=t,function(t){return r.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Yi),t};if(t&&"function"==typeof t[Ru])return e=t,function(t){for(var r=e[Ru]();;){var n=void 0;try{n=r.next()}catch(e){return t.error(e),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof r.return&&t.add((function(){r.return&&r.return()})),t};var e,r,n,o=Vi(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function Lu(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[tu]}(t))return function(t,e){return new nu((function(r){var n=new Hi;return n.add(e.schedule((function(){var o=t[tu]();n.add(o.subscribe({next:function(t){n.add(e.schedule((function(){return r.next(t)})))},error:function(t){n.add(e.schedule((function(){return r.error(t)})))},complete:function(){n.add(e.schedule((function(){return r.complete()})))}}))}))),n}))}(t,e);if($u(t))return function(t,e){return new nu((function(r){var n=new Hi;return n.add(e.schedule((function(){return t.then((function(t){n.add(e.schedule((function(){r.next(t),n.add(e.schedule((function(){return r.complete()})))})))}),(function(t){n.add(e.schedule((function(){return r.error(t)})))}))}))),n}))}(t,e);if(Mu(t))return gu(t,e);if(function(t){return t&&"function"==typeof t[Ru]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new nu((function(r){var n,o=new Hi;return o.add((function(){n&&"function"==typeof n.return&&n.return()})),o.add(e.schedule((function(){n=t[Ru](),o.add(e.schedule((function(){if(!r.closed){var t,e;try{var o=n.next();t=o.value,e=o.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var Bu=function(t){function e(e){var r=t.call(this)||this;return r.parent=e,r}return qi(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(Xi),qu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qi(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(Xi);function Uu(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(Uu((function(r,n){return(o=t(r,n),i?Lu(o,i):o instanceof nu?o:new nu(Nu(o))).pipe(Iu((function(t,o){return e(r,t,n,o)})));var o,i}),r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new Fu(t,r))})}var Fu=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Wu(t,this.project,this.concurrent))},t}(),Wu=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=r,o.concurrent=n,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return qi(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new Bu(this),r=this.destination;r.add(e);var n=function(t,e){if(!e.closed)return t instanceof nu?t.subscribe(e):Nu(t)(e)}(t,e);n!==e&&r.add(n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(qu);function Yu(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),Uu(eu,t)}function Qu(){return Yu(1)}function zu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qu()(_u.apply(void 0,t))}function Vu(t,e){return function(r){return r.lift(new Ju(t,e))}}var Ju=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Hu(t,this.predicate,this.thisArg))},t}(),Hu=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return qi(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(Xi);function Gu(t){return void 0===t&&(t=null),function(e){return e.lift(new Ku(t))}}var Ku=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new Xu(t,this.defaultValue))},t}(),Xu=function(t){function e(e,r){var n=t.call(this,e)||this;return n.defaultValue=r,n.isEmpty=!0,n}return qi(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(Xi);var Zu=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new ta(t,this.compare,this.keySelector))},t}(),ta=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.keySelector=n,o.hasKey=!1,"function"==typeof r&&(o.compare=r),o}return qi(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var r=this.keySelector;e=r?r(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},e}(Xi);function ea(t){return void 0===t&&(t=oa),function(e){return e.lift(new ra(t))}}var ra=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new na(t,this.errorFactory))},t}(),na=function(t){function e(e,r){var n=t.call(this,e)||this;return n.errorFactory=r,n.hasValue=!1,n}return qi(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(Xi);function oa(){return new Au}function ia(t){return function(e){return 0===t?yu():e.lift(new ua(t))}}var ua=function(){function t(t){if(this.total=t,this.total<0)throw new Pu}return t.prototype.call=function(t,e){return e.subscribe(new aa(t,this.total))},t}(),aa=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return qi(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(Xi);function sa(t,e,r){var n;return n=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:r},function(t){return t.lift(function(t){var e,r,n=t.bufferSize,o=void 0===n?Number.POSITIVE_INFINITY:n,i=t.windowTime,u=void 0===i?Number.POSITIVE_INFINITY:i,a=t.refCount,s=t.scheduler,c=0,f=!1,l=!1;return function(t){var n;c++,!e||f?(f=!1,e=new Eu(o,u,s),n=e.subscribe(this),r=t.subscribe({next:function(t){e.next(t)},error:function(t){f=!0,e.error(t)},complete:function(){l=!0,r=void 0,e.complete()}})):n=e.subscribe(this),this.add((function(){c--,n.unsubscribe(),r&&!l&&a&&0===c&&(r.unsubscribe(),r=void 0,e=void 0)}))}}(n))}}var ca=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new fa(t,this.nextOrObserver,this.error,this.complete))},t}(),fa=function(t){function e(e,r,n,o){var i=t.call(this,e)||this;return i._tapNext=xu,i._tapError=xu,i._tapComplete=xu,i._tapError=n||xu,i._tapComplete=o||xu,Ui(r)?(i._context=i,i._tapNext=r):r&&(i._context=r,i._tapNext=r.next||xu,i._tapError=r.error||xu,i._tapComplete=r.complete||xu),i}return qi(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(Xi),la=function(){function t(t,e,r,n,o,i,u,a,s,c){this.operation=t,this.documentId=e,this.documentData=r,this.databaseToken=n,this.collectionName=o,this.isLocal=i,this.startTime=u,this.endTime=a,this.previousData=s,this.rxDocument=c}var e=t.prototype;return e.isIntern=function(){return!(!this.collectionName||"_"!==this.collectionName.charAt(0))},e.toJSON=function(){return{operation:this.operation,documentId:this.documentId,documentData:this.documentData,previousData:this.previousData?this.previousData:void 0,databaseToken:this.databaseToken,collectionName:this.collectionName,isLocal:this.isLocal,startTime:this.startTime,endTime:this.endTime}},e.toEventReduceChangeEvent=function(){switch(this.operation){case"INSERT":return{operation:this.operation,id:this.documentId,doc:this.documentData,previous:null};case"UPDATE":return{operation:this.operation,id:this.documentId,doc:this.documentData,previous:this.previousData?this.previousData:"UNKNOWN"};case"DELETE":return{operation:this.operation,id:this.documentId,doc:null,previous:this.previousData}}},t}();function ha(t,e,r,n,o){return new la("INSERT",e[t.schema.primaryPath],e,t.database.token,t.name,!1,r,n,null,o)}function pa(t){return t instanceof la}var da={get _data(){if(this.isInstanceOfRxDocument)return this._dataSync$.getValue()},get primaryPath(){if(this.isInstanceOfRxDocument)return this.collection.schema.primaryPath},get primary(){var t=this;if(t.isInstanceOfRxDocument)return t._data[t.primaryPath]},get revision(){if(this.isInstanceOfRxDocument)return this._data._rev},get deleted$(){if(this.isInstanceOfRxDocument)return this._deleted$.asObservable()},get deleted(){if(this.isInstanceOfRxDocument)return this._deleted$.getValue()},get $(){return this._dataSync$.asObservable()},_handleChangeEvent:function(t){if(t.documentId===this.primary){var e=bi(t.documentData._rev);if(!(bi(this._data._rev)>e))switch(t.operation){case"INSERT":break;case"UPDATE":var r=t.documentData;this._dataSync$.next(r);break;case"DELETE":this.collection._docCache.delete(this.primary),this._deleted$.next(!0)}}},$emit:function(t){return this.collection.$emit(t)},get$:function(t){if(t.includes(".item."))throw Di("DOC1",{path:t});if(t===this.primaryPath)throw Di("DOC2");if(this.collection.schema.finalFields.includes(t))throw Di("DOC3",{path:t});if(!this.collection.schema.getSchemaByObjectPath(t))throw Di("DOC4",{path:t});return this._dataSync$.pipe(Iu((function(e){return f.get(e,t)})),function(t,e){return function(r){return r.lift(new Zu(t,e))}}())},populate:function(t){var e=this.collection.schema.getSchemaByObjectPath(t),r=this.get(t);if(!r)return Promise.resolve(null);if(!e)throw Di("DOC5",{path:t});if(!e.ref)throw Di("DOC6",{path:t,schemaObj:e});var n=this.collection.database.collections[e.ref];if(!n)throw Di("DOC7",{ref:e.ref,path:t,schemaObj:e});return"array"===e.type?n.findByIds(r).then((function(t){var e=t.values();return Array.from(e)})):n.findOne(r).exec()},get:function(t){if(this._data){var e=f.get(this._data,t);return"object"!=typeof(e=mi(e))||Array.isArray(e)||ya(this.collection.schema,e,t,this),e}},toJSON:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=mi(this._data);return t||(delete e._rev,delete e._attachments),e},set:function(t,e){if(!this._isTemporary)throw Ci("DOC16",{objPath:t,value:e});if("string"!=typeof t)throw Ci("DOC15",{objPath:t,value:e});if(!Object.is(this.get(t),e)){var r=t.split(".");r.pop();var n=r.join(".");if(void 0===f.get(this._data,n))throw Di("DOC10",{childpath:t,rootPath:n});return f.set(this._data,t,e),this}},update:function(t){throw si("update")},putAttachment:function(){throw si("attachments")},getAttachment:function(){throw si("attachments")},allAttachments:function(){throw si("attachments")},get allAttachments$(){throw si("attachments")},atomicUpdate:function(t){var e=this;return new Promise((function(r,n){e._atomicQueue=e._atomicQueue.then(Li($i.mark((function o(){var i,u,a;return $i.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=!1;case 1:if(i){o.next=24;break}return u=e._dataSync$.getValue(),o.prev=3,o.next=6,t(mi(e._dataSync$.getValue()),e);case 6:return a=o.sent,e.collection&&(a=e.collection.schema.fillObjectWithDefaults(a)),o.next=10,e._saveData(a,u);case 10:i=!0,o.next=22;break;case 13:if(o.prev=13,o.t0=o.catch(3),!(s=o.t0).parameters||!s.parameters.pouchDbError||409!==s.parameters.pouchDbError.status){o.next=20;break}return o.next=18,li();case 18:o.next=22;break;case 20:return n(o.t0),o.abrupt("return");case 22:o.next=1;break;case 24:r(e);case 25:case"end":return o.stop()}var s}),o,null,[[3,13]])}))))}))},atomicPatch:function(t){return this.atomicUpdate((function(e){return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e[r]=n})),e}))},atomicSet:function(t,e){return this.atomicUpdate((function(r){return f.set(r,t,e),r}))},_saveData:function(t,e){var r,n=this;if(t=t,this._deleted$.getValue())throw Di("DOC11",{id:this.primary,document:this});return this.collection.schema.validateChange(e,t),this.collection._runHooks("pre","save",t,this).then((function(){return n.collection.schema.validate(t),r=fi(),n.collection._pouchPut(t)})).then((function(o){var i=fi();if(!o.ok)throw Di("DOC12",{data:o});t._rev=o.rev;var u=function(t,e,r,n,o,i){return new la("UPDATE",e[t.schema.primaryPath],e,t.database.token,t.name,!1,n,o,r,i)}(n.collection,t,e,r,i,n);return n.$emit(u),n.collection._runHooks("post","save",t,n)}))},save:function(){var t=this;if(!this._isTemporary)throw Di("DOC17",{id:this.primary,document:this});return this.collection.insert(this).then((function(){return t._isTemporary=!1,t.collection._docCache.set(t.primary,t),t._dataSync$.next(t._data),!0}))},remove:function(){var t=this;if(this.deleted)return Promise.reject(Di("DOC13",{document:this,id:this.primary}));var e,r=mi(this._data);return this.collection._runHooks("pre","remove",r,this).then((function(){return r._deleted=!0,e=fi(),t.collection._pouchPut(r)})).then((function(){var n=fi();return t.$emit(function(t,e,r,n,o,i){return new la("DELETE",e[t.schema.primaryPath],e,t.database.token,t.name,!1,n,o,r,i)}(t.collection,r,t._data,e,n,t)),t.collection._runHooks("post","remove",r,t)})).then((function(){return t}))},destroy:function(){throw Di("DOC14")}};function ya(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(null!==e){var o=t.getSchemaByObjectPath(r);void 0!==o&&(o.properties&&(o=o.properties),Object.keys(o).forEach((function(t){var o=pi(r+"."+t);e.__defineGetter__(t,(function(){var t=n||this;if(t.get&&"function"==typeof t.get)return t.get(o)})),Object.defineProperty(e,t+"$",{get:function(){return(n||this).get$(o)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"_",{get:function(){return(n||this).populate(o)},enumerable:!1,configurable:!1}),e.__defineSetter__(t,(function(t){return(n||this).set(o,t)}))})))}}function va(t,e,r){if(r[e.schema.primaryPath]&&r[e.schema.primaryPath].startsWith("_design"))return null;var n=new t(e,r);return Mi("createRxDocument",n),n}var ma=function(){function t(t){this.jsonSchema=t,this.indexes=function(t){return(t.indexes||[]).map((function(t){return Array.isArray(t)?t:[t]}))}(this.jsonSchema),this.primaryPath=ga(this.jsonSchema),this.primaryPath&&this.jsonSchema.required.push(this.primaryPath),this.finalFields=function(t){var e=Object.keys(t.properties).filter((function(e){return t.properties[e].final}));return e.push(ga(t)),e}(this.jsonSchema),this.jsonSchema.required=this.jsonSchema.required.concat(this.finalFields).filter((function(t,e,r){return r.indexOf(t)===e})),this.jsonSchema.properties[this.primaryPath]||(this.jsonSchema.properties[this.primaryPath]={type:"string",minLength:1})}var e=t.prototype;return e.getSchemaByObjectPath=function(t){var e=t;return e=pi(e="properties."+(e=e.replace(/\./g,".properties."))),f.get(this.jsonSchema,e)},e.validateChange=function(t,e){this.finalFields.forEach((function(r){if(!ao(t[r],e[r]))throw Di("DOC9",{dataBefore:t,dataAfter:e,fieldName:r})}))},e.validate=function(t,e){throw si("validate")},e.fillObjectWithDefaults=function(t){return t=mi(t),Object.entries(this.defaultValues).filter((function(e){var r=e[0];return!t.hasOwnProperty(r)||void 0===t[r]})).forEach((function(e){var r=e[0],n=e[1];return t[r]=n})),t},e.swapIdToPrimary=function(t){return"_id"===this.primaryPath||t[this.primaryPath]||(t[this.primaryPath]=t._id,delete t._id),t},e.swapPrimaryToId=function(t){var e=this;if("_id"===this.primaryPath)return t;var r={};return Object.entries(t).forEach((function(t){var n=t[0]===e.primaryPath?"_id":t[0];r[n]=t[1]})),r},e.doKeyCompression=function(){return this.jsonSchema.keyCompression},e.getDocumentPrototype=function(){var t={};return ya(this,t,""),_i(this,"getDocumentPrototype",(function(){return t})),t},c(t,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"normalized",get:function(){return _i(this,"normalized",function(t){var e=di(mi(t));t.indexes&&(e.indexes=Array.from(t.indexes));return e}(this.jsonSchema))}},{key:"topLevelFields",get:function(){return Object.keys(this.normalized.properties)}},{key:"defaultValues",get:function(){var t={};return Object.entries(this.normalized.properties).filter((function(t){return t[1].hasOwnProperty("default")})).forEach((function(e){var r=e[0],n=e[1];return t[r]=n.default})),_i(this,"defaultValues",t)}},{key:"crypt",get:function(){return!!(this.jsonSchema.encrypted&&this.jsonSchema.encrypted.length>0||this.jsonSchema.attachments&&this.jsonSchema.attachments.encrypted)}},{key:"encryptedPaths",get:function(){return this.jsonSchema.encrypted||[]}},{key:"hash",get:function(){return _i(this,"hash",("string"!=typeof(t=this.normalized)&&(t=JSON.stringify(t)),o.Z.hash("rxdb-specific-hash-salt"+t)));var t}}]),t}();function ga(t){var e=Object.keys(t.properties).filter((function(e){return t.properties[e].primary})).shift();return e||"_id"}var ba=function(t){return(t=mi(t)).additionalProperties=!1,t.hasOwnProperty("keyCompression")||(t.keyCompression=!1),t.indexes=t.indexes||[],t.required=t.required||[],t.encrypted=t.encrypted||[],t.properties._rev={type:"string",minLength:1},t.properties._attachments={type:"object"},t.version=t.version||0,t};function _a(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&Mi("preCreateRxSchema",t);var r=new ma(ba(t));return Mi("createRxSchema",r),r}var wa=function(){function t(t,e){this.password=t,this.schema=e}var e=t.prototype;return e._encryptValue=function(t){throw si("encryption")},e._decryptValue=function(t){throw si("encryption")},e.encrypt=function(t){var e=this;return this.password?(t=mi(t),this.schema.encryptedPaths.forEach((function(r){var n=f.get(t,r);if(void 0!==n){var o=e._encryptValue(n);f.set(t,r,o)}})),t):t},e.decrypt=function(t){var e=this;return this.password?(t=mi(t),this.schema.encryptedPaths.forEach((function(r){var n=f.get(t,r);if(void 0!==n){var o=e._decryptValue(n);f.set(t,r,o)}})),t):t},t}();var Oa=-324;function ja(t,e){if(t===e)return 0;t=ka(t),e=ka(e);var r=Aa(t),n=Aa(e);if(r-n!=0)return r-n;switch(typeof t){case"number":return t-e;case"boolean":return t<e?-1:1;case"string":return function(t,e){return t===e?0:t>e?1:-1}(t,e)}return Array.isArray(t)?function(t,e){for(var r=Math.min(t.length,e.length),n=0;n<r;n++){var o=ja(t[n],e[n]);if(0!==o)return o}return t.length===e.length?0:t.length>e.length?1:-1}(t,e):function(t,e){for(var r=Object.keys(t),n=Object.keys(e),o=Math.min(r.length,n.length),i=0;i<o;i++){var u=ja(r[i],n[i]);if(0!==u)return u;if(0!==(u=ja(t[r[i]],e[n[i]])))return u}return r.length===n.length?0:r.length>n.length?1:-1}(t,e)}function ka(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var e=t;if(Array.isArray(t)){var r=t.length;t=new Array(r);for(var n=0;n<r;n++)t[n]=ka(e[n])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var o in t={},e)if(e.hasOwnProperty(o)){var i=e[o];void 0!==i&&(t[o]=ka(i))}}}return t}function Ea(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return function(t){if(0===t)return"1";var e=t.toExponential().split(/e\+?/),r=parseInt(e[1],10),n=t<0,o=n?"0":"2",i=(u=((n?-r:r)-Oa).toString(),a="0",s=3,function(t,e,r){for(var n="",o=r-t.length;n.length<o;)n+=e;return n}(u,a,s)+u);var u,a,s;o+=""+i;var c=Math.abs(parseFloat(e[0]));n&&(c=10-c);var f=c.toFixed(20);return f=f.replace(/\.?0+$/,""),o+=""+f}(t);case"string":return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(t),r=e?t:Object.keys(t),n=-1,o=r.length,i="";if(e)for(;++n<o;)i+=Sa(r[n]);else for(;++n<o;){var u=r[n];i+=Sa(u)+Sa(t[u])}return i}return""}function Sa(t){return Aa(t=ka(t))+""+Ea(t)+"\0"}function xa(t,e){var r,n=e;if("1"===t[e])r=0,e++;else{var o="0"===t[e];e++;var i="",u=t.substring(e,e+3),a=parseInt(u,10)+Oa;for(o&&(a=-a),e+=3;;){var s=t[e];if("\0"===s)break;i+=s,e++}r=1===(i=i.split(".")).length?parseInt(i,10):parseFloat(i[0]+"."+i[1]),o&&(r-=10),0!==a&&(r=parseFloat(r+"e"+a))}return{num:r,length:e-n}}function Pa(t,e){var r=t.pop();if(e.length){var n=e[e.length-1];r===n.element&&(e.pop(),n=e[e.length-1]);var o=n.element,i=n.index;if(Array.isArray(o))o.push(r);else if(i===t.length-2){o[t.pop()]=r}else t.push(r)}}function Aa(t){var e=["boolean","number","string","object"].indexOf(typeof t);return~e?null===t?1:Array.isArray(t)?5:e<3?e+2:e+3:Array.isArray(t)?5:void 0}function Ia(t,e){for(var r=t,n=0,o=e.length;n<o;n++){if(!(r=r[e[n]]))break}return r}function Ta(t,e,r){for(var n=0,o=e.length;n<o-1;n++){var i=e[n];t=t[i]=t[i]||{}}t[e[o-1]]=r}function Da(t,e){return t<e?-1:t>e?1:0}function Ca(t){for(var e=[],r="",n=0,o=t.length;n<o;n++){var i=t[n];"."===i?n>0&&"\\"===t[n-1]?r=r.substring(0,r.length-1)+".":(e.push(r),r=""):r+=i}return e.push(r),e}var Ra=["$or","$nor","$not"];function Ma(t){return Ra.indexOf(t)>-1}function $a(t){return Object.keys(t)[0]}function Na(t){return t[$a(t)]}function La(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(r){var n=t[r];if("object"!=typeof n&&(n={$eq:n}),Ma(r))e[r]=n instanceof Array?n.map((function(t){return La([t])})):La([n]);else{var o=e[r]=e[r]||{};Object.keys(n).forEach((function(t){var e=n[t];return"$gt"===t||"$gte"===t?function(t,e,r){if(void 0!==r.$eq)return;void 0!==r.$gte?"$gte"===t?e>r.$gte&&(r.$gte=e):e>=r.$gte&&(delete r.$gte,r.$gt=e):void 0!==r.$gt?"$gte"===t?e>r.$gt&&(delete r.$gt,r.$gte=e):e>r.$gt&&(r.$gt=e):r[t]=e}(t,e,o):"$lt"===t||"$lte"===t?function(t,e,r){if(void 0!==r.$eq)return;void 0!==r.$lte?"$lte"===t?e<r.$lte&&(r.$lte=e):e<=r.$lte&&(delete r.$lte,r.$lt=e):void 0!==r.$lt?"$lte"===t?e<r.$lt&&(delete r.$lt,r.$lte=e):e<r.$lt&&(r.$lt=e):r[t]=e}(t,e,o):"$ne"===t?function(t,e){"$ne"in e?e.$ne.push(t):e.$ne=[t]}(e,o):"$eq"===t?function(t,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=t}(e,o):void(o[t]=e)}))}}))})),e}function Ba(t){for(var e in t){if(Array.isArray(t))for(var r in t)t[r].$and&&(t[r]=La(t[r].$and));var n=t[e];"object"==typeof n&&Ba(n)}return t}function qa(t,e){for(var r in t){"$and"===r&&(e=!0);var n=t[r];"object"==typeof n&&(e=qa(n,e))}return e}function Ua(t){var e=Object(o.U)(t),r=!1;qa(e,!1)&&("$and"in(e=Ba(e))&&(e=La(e.$and)),r=!0),["$or","$nor"].forEach((function(t){t in e&&e[t].forEach((function(t){for(var e=Object.keys(t),r=0;r<e.length;r++){var n=e[r],o=t[n];"object"==typeof o&&null!==o||(t[n]={$eq:o})}}))})),"$not"in e&&(e.$not=La([e.$not]));for(var n=Object.keys(e),i=0;i<n.length;i++){var u=n[i],a=e[u];"object"!=typeof a||null===a?a={$eq:a}:"$ne"in a&&!r&&(a.$ne=[a.$ne]),e[u]=a}return e}function Fa(t,e,r){if(t=t.filter((function(t){return Wa(t.doc,e.selector,r)})),e.sort){var n=function(t){function e(e){return t.map((function(t){var r=Ca($a(t));return Ia(e,r)}))}return function(t,r){var n=ja(e(t.doc),e(r.doc));return 0!==n?n:Da(t.doc._id,r.doc._id)}}(e.sort);t=t.sort(n),"string"!=typeof e.sort[0]&&"desc"===Na(e.sort[0])&&(t=t.reverse())}if("limit"in e||"skip"in e){var o=e.skip||0,i=("limit"in e?e.limit:t.length)+o;t=t.slice(o,i)}return t}function Wa(t,e,r){return r.every((function(r){var n=e[r],o=Ca(r),i=Ia(t,o);return Ma(r)?function(t,e,r){if("$or"===t)return e.some((function(t){return Wa(r,t,Object.keys(t))}));if("$not"===t)return!Wa(r,e,Object.keys(e));return!e.find((function(t){return Wa(r,t,Object.keys(t))}))}(r,n,t):Ya(n,t,o,i)}))}function Ya(t,e,r,n){return!t||("object"==typeof t?Object.keys(t).every((function(o){var i=t[o];return function(t,e,r,n,o){if(!Ja[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Ja[t](e,r,n,o)}(o,e,i,r,n)})):t===n)}function Qa(t){return null!=t}function za(t){return void 0!==t}function Va(t,e){return e.some((function(e){return t instanceof Array?t.indexOf(e)>-1:t===e}))}var Ja={$elemMatch:function(t,e,r,n){return!!Array.isArray(n)&&(0!==n.length&&("object"==typeof n[0]?n.some((function(t){return Wa(t,e,Object.keys(e))})):n.some((function(n){return Ya(e,t,r,n)}))))},$allMatch:function(t,e,r,n){return!!Array.isArray(n)&&(0!==n.length&&("object"==typeof n[0]?n.every((function(t){return Wa(t,e,Object.keys(e))})):n.every((function(n){return Ya(e,t,r,n)}))))},$eq:function(t,e,r,n){return za(n)&&0===ja(n,e)},$gte:function(t,e,r,n){return za(n)&&ja(n,e)>=0},$gt:function(t,e,r,n){return za(n)&&ja(n,e)>0},$lte:function(t,e,r,n){return za(n)&&ja(n,e)<=0},$lt:function(t,e,r,n){return za(n)&&ja(n,e)<0},$exists:function(t,e,r,n){return e?za(n):!za(n)},$mod:function(t,e,r,n){return Qa(n)&&function(t,e){var r=e[0],n=e[1];if(0===r)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(r,10)!==r)throw new Error("Divisor is not an integer");if(parseInt(n,10)!==n)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%r===n}(n,e)},$ne:function(t,e,r,n){return e.every((function(t){return 0!==ja(n,t)}))},$in:function(t,e,r,n){return Qa(n)&&Va(n,e)},$nin:function(t,e,r,n){return Qa(n)&&!Va(n,e)},$size:function(t,e,r,n){return Qa(n)&&function(t,e){return t.length===e}(n,e)},$all:function(t,e,r,n){return Array.isArray(n)&&function(t,e){return e.every((function(e){return t.indexOf(e)>-1}))}(n,e)},$regex:function(t,e,r,n){return Qa(n)&&function(t,e){return new RegExp(e).test(t)}(n,e)},$type:function(t,e,r,n){return function(t,e){switch(e){case"null":return null===t;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t;case"string":return"string"==typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(e+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}(n,e)}};var Ha=new WeakMap,Ga=new WeakMap;function Ka(t){if(!Ha.has(t)){var e=t.schema.getDocumentPrototype(),r=function(t){var e={};return Object.entries(t.methods).forEach((function(t){var r=t[0],n=t[1];e[r]=n})),e}(t),n={};[e,r,da].forEach((function(t){Object.getOwnPropertyNames(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e),o=!0;(e.startsWith("_")||e.endsWith("_")||e.startsWith("$")||e.endsWith("$"))&&(o=!1),"function"==typeof r.value?Object.defineProperty(n,e,{get:function(){return r.value.bind(this)},enumerable:o,configurable:!1}):(r.enumerable=o,r.configurable=!1,r.writable&&(r.writable=!1),Object.defineProperty(n,e,r))}))})),Ha.set(t,n)}return Ha.get(t)}function Xa(t){if(!Ga.has(t)){var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:da,e=function(t,e){this.collection=t,this._isTemporary=!1,this._dataSync$=new fu(e),this._deleted$=new fu(!1),this._atomicQueue=Promise.resolve(),this.isInstanceOfRxDocument=!0};return e.prototype=t,e}(Ka(t));Ga.set(t,e)}return Ga.get(t)}function Za(t,e){var r=e[t.schema.primaryPath],n=t._docCache.get(r);if(n)return n;var o=va(Xa(t),t,e);return t._docCache.set(r,o),t._runHooksSync("post","create",e,o),Mi("postCreateRxDocument",o),o}var ts=Object(n.c)((function(t){n.a,t.exports=function(){var t=Object.prototype.toString;function e(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)}function r(t){if(!t)return!0;if(i(t)&&0===t.length)return!0;if("string"!=typeof t){for(var r in t)if(e(t,r))return!1;return!0}return!1}function n(e){return t.call(e)}function o(t){return"object"==typeof t&&"[object Object]"===n(t)}var i=Array.isArray||function(e){return"[object Array]"===t.call(e)};function u(t){return"boolean"==typeof t||"[object Boolean]"===n(t)}function a(t){var e=parseInt(t);return e.toString()===t?e:t}function s(t){t=t||{};var n=function(t){return Object.keys(n).reduce((function(e,r){return"create"===r||"function"==typeof n[r]&&(e[r]=n[r].bind(n,t)),e}),{})};function s(r,n){return t.includeInheritedProps||"number"==typeof n&&Array.isArray(r)||e(r,n)}function c(t,e){if(s(t,e))return t[e]}function f(t,e,r,n){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if("string"==typeof e)return f(t,e.split(".").map(a),r,n);var o=e[0],i=c(t,o);return 1===e.length?(void 0!==i&&n||(t[o]=r),i):(void 0===i&&("number"==typeof e[1]?t[o]=[]:t[o]={}),f(t[o],e.slice(1),r,n))}return n.has=function(r,n){if("number"==typeof n?n=[n]:"string"==typeof n&&(n=n.split(".")),!n||0===n.length)return!!r;for(var o=0;o<n.length;o++){var u=a(n[o]);if(!("number"==typeof u&&i(r)&&u<r.length||(t.includeInheritedProps?u in Object(r):e(r,u))))return!1;r=r[u]}return!0},n.ensureExists=function(t,e,r){return f(t,e,r,!0)},n.set=function(t,e,r,n){return f(t,e,r,n)},n.insert=function(t,e,r,o){var u=n.get(t,e);o=~~o,i(u)||(u=[],n.set(t,e,u)),u.splice(o,0,r)},n.empty=function(t,e){var a,c;if(!r(e)&&null!=t&&(a=n.get(t,e))){if("string"==typeof a)return n.set(t,e,"");if(u(a))return n.set(t,e,!1);if("number"==typeof a)return n.set(t,e,0);if(i(a))a.length=0;else{if(!o(a))return n.set(t,e,null);for(c in a)s(a,c)&&delete a[c]}}},n.push=function(t,e){var r=n.get(t,e);i(r)||(r=[],n.set(t,e,r)),r.push.apply(r,Array.prototype.slice.call(arguments,2))},n.coalesce=function(t,e,r){for(var o,i=0,u=e.length;i<u;i++)if(void 0!==(o=n.get(t,e[i])))return o;return r},n.get=function(t,e,r){if("number"==typeof e&&(e=[e]),!e||0===e.length)return t;if(null==t)return r;if("string"==typeof e)return n.get(t,e.split("."),r);var o=a(e[0]),i=c(t,o);return void 0===i?r:1===e.length?i:n.get(t[o],e.slice(1),r)},n.del=function(t,e){if("number"==typeof e&&(e=[e]),null==t)return t;if(r(e))return t;if("string"==typeof e)return n.del(t,e.split("."));var o=a(e[0]);return s(t,o)?1!==e.length?n.del(t[o],e.slice(1)):(i(t)?t.splice(o,1):delete t[o],t):t},n}var c=s();return c.create=s,c.withInheritedProps=s({includeInheritedProps:!0}),c}()})),es="UNKNOWN";function rs(t){return t[t.length-1]}var ns=function(t){return!!t.queryParams.limit},os={0:function(t){return"INSERT"===t.changeEvent.operation},1:function(t){return"UPDATE"===t.changeEvent.operation},2:function(t){return"DELETE"===t.changeEvent.operation},3:ns,4:function(t){return 1===t.queryParams.limit},5:function(t){return!!(t.queryParams.skip&&t.queryParams.skip>0)},6:function(t){return 0===t.previousResults.length},7:function(t){return t.changeEvent.previous===es},8:function(t){return ns(t)&&t.previousResults.length>=t.queryParams.limit},9:function(t){var e=t.queryParams.sortFields,r=t.changeEvent.previous,n=t.changeEvent.doc;if(!n)return!1;if(!r||r===es)return!0;for(var o=0;o<e.length;o++){var i=e[o];if(ts.get(r,i)!==ts.get(n,i))return!0}return!1},10:function(t){var e=t.changeEvent.id;if(t.keyDocumentMap)return t.keyDocumentMap.has(e);for(var r=t.queryParams.primaryKey,n=t.previousResults,o=0;o<n.length;o++){if(n[o][r]===e)return!0}return!1},11:function(t){var e=t.changeEvent.previous;if(!e||e===es)return!1;var r=t.previousResults[0];return!!r&&t.queryParams.sortComparator(e,r)<0},12:function(t){var e=t.changeEvent.previous;if(!e||e===es)return!1;var r=rs(t.previousResults);return!!r&&t.queryParams.sortComparator(e,r)>0},13:function(t){var e=t.changeEvent.doc;if(!e)return!1;var r=t.previousResults[0];return!!r&&t.queryParams.sortComparator(e,r)<0},14:function(t){var e=t.changeEvent.doc;if(!e)return!1;var r=rs(t.previousResults);return!!r&&t.queryParams.sortComparator(e,r)>0},15:function(t){var e=t.changeEvent.previous;return!(!e||e===es)&&t.queryParams.queryMatcher(e)},16:function(t){var e=t.changeEvent.doc;return!!e&&t.queryParams.queryMatcher(e)}};var is=function(t){t.previousResults.unshift(t.changeEvent.doc),t.keyDocumentMap&&t.keyDocumentMap.set(t.changeEvent.id,t.changeEvent.doc)},us=function(t){t.previousResults.push(t.changeEvent.doc),t.keyDocumentMap&&t.keyDocumentMap.set(t.changeEvent.id,t.changeEvent.doc)},as=function(t){var e=t.previousResults.shift();t.keyDocumentMap&&e&&t.keyDocumentMap.delete(e[t.queryParams.primaryKey])},ss=function(t){var e=t.previousResults.pop();t.keyDocumentMap&&e&&t.keyDocumentMap.delete(e[t.queryParams.primaryKey])},cs=function(t){t.keyDocumentMap&&t.keyDocumentMap.delete(t.changeEvent.id);for(var e=t.queryParams.primaryKey,r=t.previousResults,n=0;n<r.length;n++){if(r[n][e]===t.changeEvent.id){r.splice(n,1);break}}},fs=function(t){var e=t.changeEvent.doc;t.keyDocumentMap&&t.keyDocumentMap.set(t.changeEvent.id,e),function(t,e,r,n){var o=n?t:t.slice(),i=o.length-1,u=0,a=0;if(0===o.length)return o.push(e),o;for(;u<=i;)r(o[a=u+(i-u>>1)],e)<=0?u=a+1:i=a-1;r(o[a],e)<=0&&a++,o.splice(a,0,e)}(t.previousResults,e,t.queryParams.sortComparator,!0)},ls=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],hs={doNothing:function(t){},insertFirst:is,insertLast:us,removeFirstItem:as,removeLastItem:ss,removeFirstInsertLast:function(t){as(t),us(t)},removeLastInsertFirst:function(t){ss(t),is(t)},removeExisting:cs,replaceExisting:function(t){for(var e=t.changeEvent.doc,r=t.queryParams.primaryKey,n=t.previousResults,o=0;o<n.length;o++){if(n[o][r]===t.changeEvent.id){n[o]=e,t.keyDocumentMap&&t.keyDocumentMap.set(t.changeEvent.id,e);break}}},alwaysWrong:function(t){var e={_id:"wrongHuman"+(new Date).getTime()};t.previousResults.length=0,t.previousResults.push(e),t.keyDocumentMap&&(t.keyDocumentMap.clear(),t.keyDocumentMap.set(e._id,e))},insertAtSortPosition:fs,removeExistingAndInsertAtSortPosition:function(t){cs(t),fs(t)},runFullQueryAgain:function(t){throw new Error("Action runFullQueryAgain must be implemented by yourself")},unknownAction:function(t){throw new Error("Action unknownAction should never be called")}};function ps(t){return t.charCodeAt(0)-40}function ds(t,e){for(var r=[],n=0,o=t.length;n<o;n+=e)r.push(t.substring(n,n+e));return r}var ys=function(t){for(var e=new Map,r=2+2*parseInt(t.charAt(0)+t.charAt(1),10),n=ds(t.substring(2,r),2),o=0;o<n.length;o++){var i=(s=n[o]).charAt(0),u=ps(s.charAt(1));e.set(i,u)}var a=ds(t.substring(r,t.length-3),4);for(o=0;o<a.length;o++){i=(s=a[o]).charAt(0);var s,c=s.charAt(1),f=s.charAt(2),l=ps(s.charAt(3));if(!e.has(c))throw new Error("missing node with id "+c);if(!e.has(f))throw new Error("missing node with id "+f);var h={l:l,0:e.get(c),1:e.get(f)};e.set(i,h)}var p=t.slice(-3),d=p.charAt(0),y=p.charAt(1);return{l:ps(p.charAt(2)),0:e.get(d),1:e.get(y)}}("11a+b0c/d3e.f2g*h-i)j(k4ljk3mkj3nbh,odh,peh,qkj5rkm5sdk5tjk5uok5vfi5wkp5xfk5yxk/zgk/{jt/|jk/}bd1~xy1gz1jq1bs1no1j{1j|1jl1kl1jr1nu1|a7|l7d}7a7~7h7s7kj7o77k77u7vg6d6j66d6wj6k6j66k6**j-j---i---c2k222008j8.");function vs(t){var e=function(t){return function(t,e,r){for(var n=t,o=t.l;;){if("number"==typeof(n=n[e[o](r)?"1":"0"])||"string"==typeof n)return n;o=n.l}}(ys,os,t)}(t);return ls[e]}function ms(t,e){return e.sort&&0!==e.sort.length?e.sort.map((function(t){return Object.keys(t)[0]})):[t]}var gs=new WeakMap;function bs(t,e){if(!t.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=function(t){if(gs.has(t))return gs.get(t);var e=t.collection.database.storage,r=t.toJSON(),n=t.collection.schema.primaryPath,o={primaryKey:t.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:ms(n,r),sortComparator:e.getSortComparator(n,r),queryMatcher:e.getQueryMatcher(n,r)};return gs.set(t,o),o}(t),n=t._resultsData.slice(),o=t._resultsDataMap,i=!1;return e.find((function(t){var e=t.toEventReduceChangeEvent(),u=vs({queryParams:r,changeEvent:e,previousResults:n,keyDocumentMap:o});return"runFullQueryAgain"===u||("doNothing"!==u?(i=!0,function(t,e,r,n,o){(0,hs[t])({queryParams:e,changeEvent:r,previousResults:n,keyDocumentMap:o})}(u,r,e,n,o),!1):void 0)}))?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:i,newResults:n}}function _s(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return ws(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ws(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=t[Symbol.iterator]()).next.bind(r)}function ws(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Os=function(){function t(){this._map=new Map}return t.prototype.getByQuery=function(t){var e=t.toString();return this._map.has(e)||this._map.set(e,t),this._map.get(e)},t}();function js(){return new Os}function ks(t,e){e.uncached=!0;var r=e.toString();t._map.delete(r)}function Es(t){return t.refCount$.observers.length}var Ss,xs,Ps=(Ss=100,xs=3e4,function(t,e){if(!(e._map.size<Ss)){for(var r,n=fi()-xs,o=[],i=_s(e._map.values());!(r=i()).done;){var u=r.value;Es(u)>0||(0===u._lastEnsureEqual&&u._creationTime<n?ks(e,u):o.push(u))}var a=o.length-Ss;a<=0||o.sort((function(t,e){return t._lastEnsureEqual-e._lastEnsureEqual})).slice(0,a).forEach((function(t){return ks(e,t)}))}}),As=new WeakMap,Is=new WeakSet;var Ts=0,Ds=function(){function t(t,e,r){this.id=++Ts,this._execOverDatabaseCount=0,this._creationTime=fi(),this._lastEnsureEqual=0,this.other={},this.uncached=!1,this.refCount$=new fu(null),this._latestChangeEvent=-1,this._resultsData=null,this._resultsDataMap=new Map,this._lastExecStart=0,this._lastExecEnd=0,this._resultsDocs$=new fu(null),this._ensureEqualQueue=Promise.resolve(!1),this.op=t,this.mangoQuery=e,this.collection=r,e||(e=Cs(this.collection))}var e=t.prototype;return e._setResultData=function(t){this._resultsData=t;var e,r=(e=this.collection,this._resultsData.map((function(t){return Za(e,t)})));return this._resultsDocs$.next(r),r},e._execOverDatabase=function(){var t,e=this;switch(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=fi(),this.op){case"find":t=this.collection._pouchFind(this);break;case"findOne":t=this.collection._pouchFind(this,1);break;default:throw Di("QU1",{op:this.op})}return t.then((function(t){e._lastExecEnd=fi(),e._resultsDataMap=new Map;var r=e.collection.schema.primaryPath;return t.forEach((function(t){var n=t[r];e._resultsDataMap.set(n,t)})),t}))},e.exec=function(t){var e=this;if(t&&"findOne"!==this.op)throw Di("QU9",{query:this.mangoQuery,op:this.op});return Ms(this).then((function(){return e.$.pipe(function(t,e){var r=arguments.length>=2;return function(n){return n.pipe(t?Vu((function(e,r){return t(e,r,n)})):eu,ia(1),r?Gu(e):ea((function(){return new Au})))}}()).toPromise()})).then((function(r){if(!r&&t)throw Di("QU10",{query:e.mangoQuery,op:e.op});return r}))},e.toString=function(){var t=di({op:this.op,query:this.mangoQuery,other:this.other},!0),e=JSON.stringify(t,yi);return this.toString=function(){return e},e},e.toJSON=function(){var t=this.collection.database.storage.prepareQuery(this.asRxQuery,mi(this.mangoQuery));return this.toJSON=function(){return t},t},e.keyCompress=function(){var t;return t=this.collection.schema.doKeyCompression()?this.collection._keyCompressor.compressQuery(this.toJSON()):this.toJSON(),this.keyCompress=function(){return t},t},e.doesDocumentDataMatch=function(t){if(t._deleted)return!1;t=this.collection.schema.swapPrimaryToId(t);var e=this.massageSelector,r=Fa([{doc:t}],{selector:e},Object.keys(e));return r&&1===r.length},e.remove=function(){var t;return this.exec().then((function(e){return t=e,Array.isArray(e)?Promise.all(e.map((function(t){return t.remove()}))):e.remove()})).then((function(){return t}))},e.update=function(t){throw si("update")},e.where=function(t){throw si("query-builder")},e.sort=function(t){throw si("query-builder")},e.skip=function(t){throw si("query-builder")},e.limit=function(t){throw si("query-builder")},c(t,[{key:"$",get:function(){var t,e,r,n=this;if(!this._$){var o=this._resultsDocs$.pipe(Uu((function(t){return Ms(n).then((function(e){return!e&&t}))})),Vu((function(t){return!!t})),Iu((function(t){return"findOne"===n.op?0===t.length?null:t[0]:t})),Iu((function(t){return Array.isArray(t)?t.slice():t}))).asObservable(),i=this.collection.$.pipe((t=function(){return Ms(n)},function(n){return n.lift(new ca(t,e,r))}),Vu((function(){return!1})));this._$=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Number.POSITIVE_INFINITY,n=null,o=t[t.length-1];return vu(o)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof o&&(r=t.pop()),null===n&&1===t.length&&t[0]instanceof nu?t[0]:Yu(r)(bu(t,n))}(o,i,this.refCount$.pipe(Vu((function(){return!1}))))}return this._$}},{key:"massageSelector",get:function(){return _i(this,"massageSelector",Ua(this.mangoQuery.selector))}},{key:"asRxQuery",get:function(){return this}}]),t}();function Cs(t){var e;return{selector:(e={},e[t.schema.primaryPath]={},e)}}function Rs(t,e,r){if(e&&"object"!=typeof e)throw Ci("QU7",{queryObj:e});if(Array.isArray(e))throw Ci("QU8",{queryObj:e});Mi("preCreateRxQuery",{op:t,queryObj:e,collection:r});var n,o=new Ds(t,e,r);return Mi("createRxQuery",o=(n=o).collection._queryCache.getByQuery(n)),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e4;if(!As.has(t)){Is.has(t)||(t.onDestroy.then((function(){var e=As.get(t);e&&clearTimeout(e)})),Is.add(t));var r=setTimeout((function(){As.delete(t),t.cacheReplacementPolicy(t,t._queryCache)}),e);As.set(t,r)}}(r),o}function Ms(t){return t._ensureEqualQueue=t._ensureEqualQueue.then((function(){return new Promise((function(t){return setTimeout(t,0)}))})).then((function(){return function(t){if(t._lastEnsureEqual=fi(),t.collection.database.destroyed)return!1;if(function(t){return t._latestChangeEvent>=t.collection._changeEventBuffer.counter}(t))return!1;var e=!1,r=!1;-1===t._latestChangeEvent&&(r=!0);if(!r){var n=t.collection._changeEventBuffer.getFrom(t._latestChangeEvent+1);if(null===n)r=!0;else{t._latestChangeEvent=t.collection._changeEventBuffer.counter,n=n.filter((function(e){return!e.startTime||e.startTime>t._lastExecStart}));var o=t.collection._changeEventBuffer.reduceByLastOfDoc(n),i=bs(t,o);i.runFullQueryAgain?r=!0:i.changed&&(e=!0,t._setResultData(i.newResults))}}if(r){var u=t.collection._changeEventBuffer.counter;return t._execOverDatabase().then((function(r){return t._latestChangeEvent=u,ao(r,t._resultsData)||(e=!0,t._setResultData(r)),e}))}return e}(t)})).then((function(t){return new Promise((function(t){return setTimeout(t,0)})).then((function(){return t}))})),t._ensureEqualQueue}var $s=fetch,Ns=Headers;function Ls(t,e){if(t.selector&&t.filter&&"_selector"!==t.filter){var r="string"==typeof t.filter?t.filter:"function";return e(new Error('selector invalid for filter "'+r+'"'))}e()}function Bs(t){t.view&&!t.filter&&(t.filter="_view"),t.selector&&!t.filter&&(t.filter="_selector"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=Object(o.V)(t.view):t.filter=Object(o.V)(t.filter))}function qs(t,e){return e.filter&&"string"==typeof e.filter&&!e.doc_ids&&!Object(o.W)(t.db)}function Us(t,e){var r=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var n=Object(o.J)(o.X,"`view` filter parameter not found or invalid.");return r(n)}var i=Object(o.cb)(e.view);t.db.get("_design/"+i[0],(function(n,u){if(t.isCancelled)return r(null,{status:"cancelled"});if(n)return r(Object(o.eb)(n));var a,s=u&&u.views&&u.views[i[1]]&&u.views[i[1]].map;if(!s)return r(Object(o.J)(o.n,u.views?"missing json key: "+i[1]:"missing json key: views"));e.filter=(a=["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+s+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),Object(o.fb)(a,{})),t.doChanges(e)}))}else if(e.selector)e.filter=function(t){return function(t,e){if("object"!=typeof e)throw new Error("Selector error: expected a JSON object");var r=Fa([{doc:t}],{selector:e=Ua(e)},Object.keys(e));return r&&1===r.length}(t,e.selector)},t.doChanges(e);else{var u=Object(o.cb)(e.filter);t.db.get("_design/"+u[0],(function(n,i){if(t.isCancelled)return r(null,{status:"cancelled"});if(n)return r(Object(o.eb)(n));var a,s=i&&i.filters&&i.filters[u[1]];if(!s)return r(Object(o.J)(o.n,i&&i.filters?"missing json key: "+u[1]:"missing json key: filters"));e.filter=(a=s,Object(o.fb)('"use strict";\nreturn '+a+";",{})),t.doChanges(e)}))}}function Fs(t,e,r){o.f.call(this);var n=this;this.db=t;var i=(e=e?Object(o.U)(e):{}).complete=Object(o.b)((function(e,r){e?Object(o.l)(n,"error")>0&&n.emit("error",e):n.emit("complete",r),n.removeAllListeners(),t.removeListener("destroyed",u)}));function u(){n.cancel()}r&&(n.on("complete",(function(t){r(null,t)})),n.on("error",r)),t.once("destroyed",u),e.onChange=function(t,e,r){n.isCancelled||function(t,e,r,n){try{t.emit("change",e,r,n)}catch(t){Object(o.g)("error",'Error in .on("change", function):',t)}}(n,t,e,r)};var a=new Promise((function(t,r){e.complete=function(e,n){e?r(e):t(n)}}));n.once("cancel",(function(){t.removeListener("destroyed",u),e.complete(null,{status:"cancelled"})})),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then((function(t){i(null,t)}),i),t.taskqueue.isReady?n.validateChanges(e):t.taskqueue.addTask((function(t){t?e.complete(t):n.isCancelled?n.emit("cancel"):n.validateChanges(e)}))}function Ws(t,e,r){var n=[{rev:t._rev}];"all_docs"===r.style&&(n=Object(o.m)(e.rev_tree).map((function(t){return{rev:t.rev}})));var i={id:e.id,changes:n,doc:t};return Object(o.o)(e,t._rev)&&(i.deleted=!0),r.conflicts&&(i.doc._conflicts=Object(o.Q)(e),i.doc._conflicts.length||delete i.doc._conflicts),i}function Ys(t,e){return t<e?-1:t>e?1:0}function Qs(t,e){return function(r,n){r||n[0]&&n[0].error?((r=r||n[0]).docId=e,t(r)):t(null,n.length?n[0]:n)}}function zs(t,e){var r=Ys(t._id,e._id);return 0!==r?r:Ys(t._revisions?t._revisions.start:0,e._revisions?e._revisions.start:0)}function Vs(t){var e=t._compactionQueue[0],r=e.opts,n=e.callback;t.get("_local/compaction").catch((function(){return!1})).then((function(e){e&&e.last_seq&&(r.last_seq=e.last_seq),t._compact(r,(function(e,r){e?n(e):n(null,r),Object(o.z)((function(){t._compactionQueue.shift(),t._compactionQueue.length&&Vs(t)}))}))}))}function Js(){for(var t in o.f.call(this),Js.prototype)"function"==typeof this[t]&&(this[t]=this[t].bind(this))}function Hs(){this.isReady=!1,this.failed=!1,this.queue=[]}function Gs(t,e){if(!(this instanceof Gs))return new Gs(t,e);var r=this;if(e=e||{},t&&"object"==typeof t&&(t=(e=t).name,delete e.name),void 0===e.deterministic_revs&&(e.deterministic_revs=!0),this.__opts=e=Object(o.U)(e),r.auto_compaction=e.auto_compaction,r.prefix=Gs.prefix,"string"!=typeof t)throw new Error("Missing/invalid DB name");var n=function(t,e){var r=t.match(/([a-z-]*):\/\/(.*)/);if(r)return{name:/https?/.test(r[1])?r[1]+"://"+r[2]:r[2],adapter:r[1]};var n=Gs.adapters,i=Gs.preferredAdapters,u=Gs.prefix,a=e.adapter;if(!a)for(var s=0;s<i.length&&"idb"===(a=i[s])&&"websql"in n&&Object(o.x)()&&localStorage["_pouch__websqldb_"+u+t];++s)Object(o.g)("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var c=n[a];return{name:c&&"use_prefix"in c&&!c.use_prefix?t:u+t,adapter:a}}((e.prefix||"")+t,e);if(e.name=n.name,e.adapter=e.adapter||n.adapter,r.name=t,r._adapter=e.adapter,Gs.emit("debug",["adapter","Picked adapter: ",e.adapter]),!Gs.adapters[e.adapter]||!Gs.adapters[e.adapter].valid())throw new Error("Invalid Adapter: "+e.adapter);Js.call(r),r.taskqueue=new Hs,r.adapter=e.adapter,Gs.adapters[e.adapter].call(r,e,(function(t){if(t)return r.taskqueue.fail(t);!function(t){function e(e){t.removeListener("closed",r),e||t.constructor.emit("destroyed",t.name)}function r(){t.removeListener("destroyed",e),t.constructor.emit("unref",t)}t.once("destroyed",e),t.once("closed",r),t.constructor.emit("ref",t)}(r),r.emit("created",r),Gs.emit("created",r.name),r.taskqueue.ready(r)}))}Object(o.gb)(Fs,o.f),Fs.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Fs.prototype.validateChanges=function(t){var e=t.complete,r=this;Gs._changesFilterPlugin?Gs._changesFilterPlugin.validate(t,(function(n){if(n)return e(n);r.doChanges(t)})):r.doChanges(t)},Fs.prototype.doChanges=function(t){var e=this,r=t.complete;if("live"in(t=Object(o.U)(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=Ws,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(Gs._changesFilterPlugin){if(Gs._changesFilterPlugin.normalize(t),Gs._changesFilterPlugin.shouldFilter(this,t))return Gs._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach((function(e){e in t&&Object(o.g)("warn",'The "'+e+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')}));"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=r;var n=this.db._changes(t);if(n&&"function"==typeof n.cancel){var i=e.cancel;e.cancel=Object(o.h)((function(t){n.cancel(),i.apply(this,t)}))}}else this.db.info().then((function(n){e.isCancelled?r(null,{status:"cancelled"}):(t.since=n.update_seq,e.doChanges(t))}),r)},Object(o.gb)(Js,o.f),Js.prototype.post=Object(o.i)("post",(function(t,e,r){if("function"==typeof e&&(r=e,e={}),"object"!=typeof t||Array.isArray(t))return r(Object(o.J)(o.A));this.bulkDocs({docs:[t]},e,Qs(r,t._id))})),Js.prototype.put=Object(o.i)("put",(function(t,e,r){if("function"==typeof e&&(r=e,e={}),"object"!=typeof t||Array.isArray(t))return r(Object(o.J)(o.A));if(Object(o.P)(t._id),Object(o.p)(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,r):this._putLocal(t,r);var n,i,u,a,s=this;function c(r){"function"==typeof s._put&&!1!==e.new_edits?s._put(t,e,r):s.bulkDocs({docs:[t]},e,Qs(r,t._id))}e.force&&t._rev?(n=t._rev.split("-"),i=n[1],u=parseInt(n[0],10)+1,a=Object(o.Y)(),t._revisions={start:u,ids:[a,i]},t._rev=u+"-"+a,e.new_edits=!1,c((function(e){var n=e?null:{ok:!0,id:t._id,rev:t._rev};r(e,n)}))):c(r)})),Js.prototype.putAttachment=Object(o.i)("putAttachment",(function(t,e,r,n,i){var u=this;function a(t){var r="_rev"in t?parseInt(t._rev,10):0;return t._attachments=t._attachments||{},t._attachments[e]={content_type:i,data:n,revpos:++r},u.put(t)}return"function"==typeof i&&(i=n,n=r,r=null),void 0===i&&(i=n,n=r,r=null),i||Object(o.g)("warn","Attachment",e,"on document",t,"is missing content_type"),u.get(t).then((function(t){if(t._rev!==r)throw Object(o.J)(o.s);return a(t)}),(function(e){if(e.reason===o.n.message)return a({_id:t});throw e}))})),Js.prototype.removeAttachment=Object(o.i)("removeAttachment",(function(t,e,r,n){var i=this;i.get(t,(function(t,u){if(t)n(t);else if(u._rev===r){if(!u._attachments)return n();delete u._attachments[e],0===Object.keys(u._attachments).length&&delete u._attachments,i.put(u,n)}else n(Object(o.J)(o.s))}))})),Js.prototype.remove=Object(o.i)("remove",(function(t,e,r,n){var i;"string"==typeof e?(i={_id:t,_rev:e},"function"==typeof r&&(n=r,r={})):(i=t,"function"==typeof e?(n=e,r={}):(n=r,r=e)),(r=r||{}).was_delete=!0;var u={_id:i._id,_rev:i._rev||r.rev,_deleted:!0};if(Object(o.p)(u._id)&&"function"==typeof this._removeLocal)return this._removeLocal(i,n);this.bulkDocs({docs:[u]},r,Qs(n,u._id))})),Js.prototype.revsDiff=Object(o.i)("revsDiff",(function(t,e,r){"function"==typeof e&&(r=e,e={});var n=Object.keys(t);if(!n.length)return r(null,{});var i=0,u=new o.q;function a(t,e){u.has(t)||u.set(t,{missing:[]}),u.get(t).missing.push(e)}n.map((function(e){this._getRevisionTree(e,(function(s,c){if(s&&404===s.status&&"missing"===s.message)u.set(e,{missing:t[e]});else{if(s)return r(s);!function(e,r){var n=t[e].slice(0);Object(o.ab)(r,(function(t,r,o,i,u){var s=r+"-"+o,c=n.indexOf(s);-1!==c&&(n.splice(c,1),"available"!==u.status&&a(e,s))})),n.forEach((function(t){a(e,t)}))}(e,c)}if(++i===n.length){var f={};return u.forEach((function(t,e){f[e]=t})),r(null,f)}}))}),this)})),Js.prototype.bulkGet=Object(o.i)("bulkGet",(function(t,e){Object(o.r)(this,t,e)})),Js.prototype.compactDocument=Object(o.i)("compactDocument",(function(t,e,r){var n=this;this._getRevisionTree(t,(function(i,u){if(i)return r(i);var a=function(t){var e={},r=[];return Object(o.ab)(t,(function(t,n,o,i){var u=n+"-"+o;return t&&(e[u]=0),void 0!==i&&r.push({from:i,to:u}),u})),r.reverse(),r.forEach((function(t){void 0===e[t.from]?e[t.from]=1+e[t.to]:e[t.from]=Math.min(e[t.from],1+e[t.to])})),e}(u),s=[],c=[];Object.keys(a).forEach((function(t){a[t]>e&&s.push(t)})),Object(o.ab)(u,(function(t,e,r,n,o){var i=e+"-"+r;"available"===o.status&&-1!==s.indexOf(i)&&c.push(i)})),n._doCompaction(t,c,r)}))})),Js.prototype.compact=Object(o.i)("compact",(function(t,e){"function"==typeof t&&(e=t,t={});var r=this;t=t||{},r._compactionQueue=r._compactionQueue||[],r._compactionQueue.push({opts:t,callback:e}),1===r._compactionQueue.length&&Vs(r)})),Js.prototype._compact=function(t,e){var r=this,n={return_docs:!1,last_seq:t.last_seq||0},i=[];r.changes(n).on("change",(function(t){i.push(r.compactDocument(t.id,0))})).on("complete",(function(t){var n=t.last_seq;Promise.all(i).then((function(){return Object(o.t)(r,"_local/compaction",(function(t){return(!t.last_seq||t.last_seq<n)&&(t.last_seq=n,t)}))})).then((function(){e(null,{ok:!0})})).catch(e)})).on("error",e)},Js.prototype.get=Object(o.i)("get",(function(t,e,r){if("function"==typeof e&&(r=e,e={}),"string"!=typeof t)return r(Object(o.J)(o.B));if(Object(o.p)(t)&&"function"==typeof this._getLocal)return this._getLocal(t,r);var n=[],i=this;function u(){var o=[],u=n.length;if(!u)return r(null,o);n.forEach((function(n){i.get(t,{rev:n,revs:e.revs,latest:e.latest,attachments:e.attachments,binary:e.binary},(function(t,e){if(t)o.push({missing:n});else{for(var i,a=0,s=o.length;a<s;a++)if(o[a].ok&&o[a].ok._rev===e._rev){i=!0;break}i||o.push({ok:e})}--u||r(null,o)}))}))}if(!e.open_revs)return this._get(t,e,(function(n,u){if(n)return n.docId=t,r(n);var a=u.doc,s=u.metadata,c=u.ctx;if(e.conflicts){var f=Object(o.Q)(s);f.length&&(a._conflicts=f)}if(Object(o.o)(s,a._rev)&&(a._deleted=!0),e.revs||e.revs_info){for(var l=a._rev.split("-"),h=parseInt(l[0],10),p=l[1],d=Object(o.u)(s.rev_tree),y=null,v=0;v<d.length;v++){var m=d[v],g=m.ids.map((function(t){return t.id})).indexOf(p);(g===h-1||!y&&-1!==g)&&(y=m)}if(!y)return(n=new Error("invalid rev tree")).docId=t,r(n);var b=y.ids.map((function(t){return t.id})).indexOf(a._rev.split("-")[1])+1,_=y.ids.length-b;if(y.ids.splice(b,_),y.ids.reverse(),e.revs&&(a._revisions={start:y.pos+y.ids.length-1,ids:y.ids.map((function(t){return t.id}))}),e.revs_info){var w=y.pos+y.ids.length;a._revs_info=y.ids.map((function(t){return{rev:--w+"-"+t.id,status:t.opts.status}}))}}if(e.attachments&&a._attachments){var O=a._attachments,j=Object.keys(O).length;if(0===j)return r(null,a);Object.keys(O).forEach((function(t){this._getAttachment(a._id,t,O[t],{rev:a._rev,binary:e.binary,ctx:c},(function(e,n){var o=a._attachments[t];o.data=n,delete o.stub,delete o.length,--j||r(null,a)}))}),i)}else{if(a._attachments)for(var k in a._attachments)a._attachments.hasOwnProperty(k)&&(a._attachments[k].stub=!0);r(null,a)}}));if("all"===e.open_revs)this._getRevisionTree(t,(function(t,e){if(t)return r(t);n=Object(o.m)(e).map((function(t){return t.rev})),u()}));else{if(!Array.isArray(e.open_revs))return r(Object(o.J)(o.v,"function_clause"));n=e.open_revs;for(var a=0;a<n.length;a++){var s=n[a];if("string"!=typeof s||!/^\d+-/.test(s))return r(Object(o.J)(o.j))}u()}})),Js.prototype.getAttachment=Object(o.i)("getAttachment",(function(t,e,r,n){var i=this;r instanceof Function&&(n=r,r={}),this._get(t,r,(function(u,a){return u?n(u):a.doc._attachments&&a.doc._attachments[e]?(r.ctx=a.ctx,r.binary=!0,void i._getAttachment(t,e,a.doc._attachments[e],r,n)):n(Object(o.J)(o.n))}))})),Js.prototype.allDocs=Object(o.i)("allDocs",(function(t,e){if("function"==typeof t&&(e=t,t={}),t.skip=void 0!==t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return e(new TypeError("options.keys must be an array"));var r=["startkey","endkey","key"].filter((function(e){return e in t}))[0];if(r)return void e(Object(o.J)(o.w,"Query parameter `"+r+"` is not compatible with multi-get"));if(!Object(o.W)(this)&&(function(t){var e="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;t.keys=e,t.skip=0,delete t.limit,t.descending&&(e.reverse(),t.descending=!1)}(t),0===t.keys.length))return this._allDocs({limit:0},e)}return this._allDocs(t,e)})),Js.prototype.changes=function(t,e){return"function"==typeof t&&(e=t,t={}),(t=t||{}).return_docs="return_docs"in t?t.return_docs:!t.live,new Fs(this,t,e)},Js.prototype.close=Object(o.i)("close",(function(t){return this._closed=!0,this.emit("closed"),this._close(t)})),Js.prototype.info=Object(o.i)("info",(function(t){var e=this;this._info((function(r,n){if(r)return t(r);n.db_name=n.db_name||e.name,n.auto_compaction=!(!e.auto_compaction||Object(o.W)(e)),n.adapter=e.adapter,t(null,n)}))})),Js.prototype.id=Object(o.i)("id",(function(t){return this._id(t)})),Js.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},Js.prototype.bulkDocs=Object(o.i)("bulkDocs",(function(t,e,r){if("function"==typeof e&&(r=e,e={}),e=e||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return r(Object(o.J)(o.a));for(var n=0;n<t.docs.length;++n)if("object"!=typeof t.docs[n]||Array.isArray(t.docs[n]))return r(Object(o.J)(o.A));var i;if(t.docs.forEach((function(t){t._attachments&&Object.keys(t._attachments).forEach((function(e){i=i||function(t){return"_"===t.charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'"}(e),t._attachments[e].content_type||Object(o.g)("warn","Attachment",e,"on document",t._id,"is missing content_type")}))})),i)return r(Object(o.J)(o.X,i));"new_edits"in e||(e.new_edits=!("new_edits"in t)||t.new_edits);var u=this;e.new_edits||Object(o.W)(u)||t.docs.sort(zs),function(t){for(var e=0;e<t.length;e++){var r=t[e];if(r._deleted)delete r._attachments;else if(r._attachments)for(var n=Object.keys(r._attachments),i=0;i<n.length;i++){var u=n[i];r._attachments[u]=Object(o.y)(r._attachments[u],["data","digest","content_type","length","revpos","stub"])}}}(t.docs);var a=t.docs.map((function(t){return t._id}));return this._bulkDocs(t,e,(function(t,n){if(t)return r(t);if(e.new_edits||(n=n.filter((function(t){return t.error}))),!Object(o.W)(u))for(var i=0,s=n.length;i<s;i++)n[i].id=n[i].id||a[i];r(null,n)}))})),Js.prototype.registerDependentDatabase=Object(o.i)("registerDependentDatabase",(function(t,e){var r=new this.constructor(t,this.__opts);Object(o.t)(this,"_local/_pouch_dependentDbs",(function(e){return e.dependentDbs=e.dependentDbs||{},!e.dependentDbs[t]&&(e.dependentDbs[t]=!0,e)})).then((function(){e(null,{db:r})})).catch(e)})),Js.prototype.destroy=Object(o.i)("destroy",(function(t,e){"function"==typeof t&&(e=t,t={});var r=this,n=!("use_prefix"in r)||r.use_prefix;function i(){r._destroy(t,(function(t,n){if(t)return e(t);r._destroyed=!0,r.emit("destroyed"),e(null,n||{ok:!0})}))}if(Object(o.W)(r))return i();r.get("_local/_pouch_dependentDbs",(function(t,o){if(t)return 404!==t.status?e(t):i();var u=o.dependentDbs,a=r.constructor,s=Object.keys(u).map((function(t){var e=n?t.replace(new RegExp("^"+a.prefix),""):t;return new a(e,r.__opts).destroy()}));Promise.all(s).then(i,e)}))})),Hs.prototype.execute=function(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()},Hs.prototype.fail=function(t){this.failed=t,this.execute()},Hs.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},Hs.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},Object(o.gb)(Gs,Js),Gs.adapters={},Gs.preferredAdapters=[],Gs.prefix="_pouch_";var Ks=new o.f;!function(t){Object.keys(o.f.prototype).forEach((function(e){"function"==typeof o.f.prototype[e]&&(t[e]=Ks[e].bind(Ks))}));var e=t._destructionListeners=new o.q;t.on("ref",(function(t){e.has(t.name)||e.set(t.name,[]),e.get(t.name).push(t)})),t.on("unref",(function(t){if(e.has(t.name)){var r=e.get(t.name),n=r.indexOf(t);n<0||(r.splice(n,1),r.length>1?e.set(t.name,r):e.delete(t.name))}})),t.on("destroyed",(function(t){if(e.has(t)){var r=e.get(t);e.delete(t),r.forEach((function(t){t.emit("destroyed",!0)}))}}))}(Gs),Gs.adapter=function(t,e,r){e.valid()&&(Gs.adapters[t]=e,r&&Gs.preferredAdapters.push(t))},Gs.plugin=function(t){if("function"==typeof t)t(Gs);else{if("object"!=typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach((function(e){Gs.prototype[e]=t[e]}))}return this.__defaults&&(Gs.__defaults=Object(o.k)({},this.__defaults)),Gs},Gs.defaults=function(t){function e(t,r){if(!(this instanceof e))return new e(t,r);r=r||{},t&&"object"==typeof t&&(t=(r=t).name,delete r.name),r=Object(o.k)({},e.__defaults,r),Gs.call(this,t,r)}return Object(o.gb)(e,Gs),e.preferredAdapters=Gs.preferredAdapters.slice(),Object.keys(Gs).forEach((function(t){t in e||(e[t]=Gs[t])})),e.__defaults=Object(o.k)({},this.__defaults,t),e},Gs.fetch=function(t,e){return $s(t,e)};function Xs(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Xs)}catch(t){}}function Zs(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Zs)}catch(t){}}function tc(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,tc)}catch(t){}}function ec(t,e){return e&&t.then((function(t){Object(o.z)((function(){e(null,t)}))}),(function(t){Object(o.z)((function(){e(t)}))})),t}function rc(t,e){return function(){var r=arguments,n=this;return t.add((function(){return e.apply(n,r)}))}}function nc(t){var e=new o.D(t),r=new Array(e.size),n=-1;return e.forEach((function(t){r[++n]=t})),r}function oc(t){var e=new Array(t.size),r=-1;return t.forEach((function(t,n){e[++r]=n})),e}function ic(){this.promise=new Promise((function(t){t()}))}function uc(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function ac(t,e,r,n,i,u){var a,s=function(t,e){return uc(t)+uc(e)+"undefined"}(r,n);if(!i&&(a=t._cachedViews=t._cachedViews||{})[s])return a[s];var c=t.info().then((function(c){var f=c.db_name+"-mrview-"+(i?"temp":Object(o.E)(s));return Object(o.t)(t,"_local/"+u,(function(t){t.views=t.views||{};var r=e;-1===r.indexOf("/")&&(r=e+"/"+e);var n=t.views[r]=t.views[r]||{};if(!n[f])return n[f]=!0,t})).then((function(){return t.registerDependentDatabase(f).then((function(e){var o=e.db;o.auto_compaction=!0;var i={name:f,db:o,sourceDB:t,adapter:t.adapter,mapFun:r,reduceFun:n};return i.db.get("_local/lastSeq").catch((function(t){if(404!==t.status)throw t})).then((function(t){return i.seq=t?t.seq:0,a&&i.db.once("destroyed",(function(){delete a[s]})),i}))}))}))}));return a&&(a[s]=c),c}Gs.plugin((function(t){t._changesFilterPlugin={validate:Ls,normalize:Bs,shouldFilter:qs,filter:Us}})),Gs.version="7.2.2",Object(o.gb)(Xs,Error),Object(o.gb)(Zs,Error),Object(o.gb)(tc,Error),ic.prototype.add=function(t){return this.promise=this.promise.catch((function(){})).then((function(){return t()})),this.promise},ic.prototype.finish=function(){return this.promise};var sc={},cc=new ic;function fc(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function lc(t,e){try{t.emit("error",e)}catch(t){Object(o.g)("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),Object(o.g)("error",e)}}function hc(t){return(t=Object(o.U)(t)).index||(t.index={}),["type","name","ddoc"].forEach((function(e){t.index[e]&&(t[e]=t.index[e],delete t.index[e])})),t.fields&&(t.index.fields=t.fields,delete t.fields),t.type||(t.type="json"),t}function pc(t,e,r,n){var i,u;r.headers=new Ns({"Content-type":"application/json"}),t.fetch(e,r).then((function(t){return i=t.status,u=t.ok,t.json()})).then((function(t){if(u)n(null,t);else{t.status=i;var e=Object(o.eb)(t);n(e)}})).catch(n)}function dc(t,e,r){e=hc(e),pc(t,"_index",{method:"POST",body:JSON.stringify(e)},r)}function yc(t,e,r){pc(t,"_find",{method:"POST",body:JSON.stringify(e)},r)}function vc(t,e,r){pc(t,"_explain",{method:"POST",body:JSON.stringify(e)},r)}function mc(t,e){pc(t,"_index",{method:"GET"},e)}function gc(t,e,r){var n=e.ddoc,o=e.type||"json",i=e.name;return n?i?void pc(t,"_index/"+[n,o,i].map(encodeURIComponent).join("/"),{method:"DELETE"},r):r(new Error("you must provide an index's name")):r(new Error("you must provide an index's ddoc"))}function bc(t){return function(){for(var e=arguments.length,r=new Array(e),n=-1;++n<e;)r[n]=arguments[n];return t.call(this,r)}}function _c(t){return bc((function(e){var r=e.pop(),n=t.apply(this,e);return function(t,e){t.then((function(t){Object(o.z)((function(){e(null,t)}))}),(function(t){Object(o.z)((function(){e(t)}))}))}(n,r),n}))}var wc=bc((function(t){for(var e=[],r=0,n=t.length;r<n;r++){var o=t[r];Array.isArray(o)?e=e.concat(wc.apply(null,o)):e.push(o)}return e}));function Oc(t){for(var e={},r=0,n=t.length;r<n;r++)e=Object(o.k)(e,t[r]);return e}function jc(t,e){for(var r=0,n=Math.min(t.length,e.length);r<n;r++)if(t[r]!==e[r])return!1;return!0}function kc(t,e){if(t.length!==e.length)return!1;for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function Ec(t,e){var r=function(t){for(var e=0,r=t.length;e<r;e++)if(-1!==t[e].indexOf("."))return!1;return!0}(t),n=1===t.length;return r?n?function(t,e){return function(r){e(r[t])}}(t[0],e):function(t,e){return function(r){for(var n=[],o=0,i=t.length;o<i;o++)n.push(r[t[o]]);e(n)}}(t,e):n?function(t,e){var r=Ca(t);return function(t){for(var n=t,o=0,i=r.length;o<i;o++)if(void 0===(n=n[r[o]]))return;e(n)}}(t[0],e):function(t,e){return function(r){for(var n=[],o=0,i=t.length;o<i;o++){for(var u=Ca(t[o]),a=r,s=0,c=u.length;s<c;s++)if(void 0===(a=a[u[s]]))return;n.push(a)}e(n)}}(t,e)}var Sc=function(t,e,r,n){function i(t,e,r){try{e(r)}catch(e){lc(t,e)}}function u(t,e,r,n,o){try{return{output:e(r,n,o)}}catch(e){return lc(t,e),{error:e}}}function a(t,e){var r=ja(t.key,e.key);return 0!==r?r:ja(t.value,e.value)}function s(t,e,r){return r=r||0,"number"==typeof e?t.slice(r,e+r):r>0?t.slice(r):t}function c(t){var e=t.value;return e&&"object"==typeof e&&e._id||t.id}function f(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&function(t){t.rows.forEach((function(t){var e=t.doc&&t.doc._attachments;e&&Object.keys(e).forEach((function(t){var r=e[t];e[t].data=Object(o.G)(r.data,r.content_type)}))}))}(e),e}}function l(t,e,r,n){var o=e[t];void 0!==o&&(n&&(o=encodeURIComponent(JSON.stringify(o))),r.push(t+"="+o))}function h(t){if(void 0!==t){var e=Number(t);return isNaN(e)||e!==parseInt(t,10)?t:e}}function p(t,e){var r=t.descending?"endkey":"startkey",n=t.descending?"startkey":"endkey";if(void 0!==t[r]&&void 0!==t[n]&&ja(t[r],t[n])>0)throw new Xs("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new Xs("{include_docs:true} is invalid for reduce");if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level)throw new Xs("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach((function(e){var r=function(t){if(t){if("number"!=typeof t)return new Xs('Invalid value for integer: "'+t+'"');if(t<0)return new Xs('Invalid value for positive integer: "'+t+'"')}}(t[e]);if(r)throw r}))}function d(t){return function(e){if(404===e.status)return t;throw e}}function y(t,e,r){var n="_local/doc_"+t,i={_id:n,keys:[]},u=r.get(t),a=u[0];return(function(t){return 1===t.length&&/^1-/.test(t[0].rev)}(u[1])?Promise.resolve(i):e.db.get(n).catch(d(i))).then((function(t){return function(t){return t.keys.length?e.db.allDocs({keys:t.keys,include_docs:!0}):Promise.resolve({rows:[]})}(t).then((function(e){return function(t,e){for(var r=[],n=new o.D,i=0,u=e.rows.length;i<u;i++){var s=e.rows[i].doc;if(s&&(r.push(s),n.add(s._id),s._deleted=!a.has(s._id),!s._deleted)){var c=a.get(s._id);"value"in c&&(s.value=c.value)}}var f=oc(a);return f.forEach((function(t){if(!n.has(t)){var e={_id:t},o=a.get(t);"value"in o&&(e.value=o.value),r.push(e)}})),t.keys=nc(f.concat(t.keys)),r.push(t),r}(t,e)}))}))}function v(t){var e="string"==typeof t?t:t.name,r=sc[e];return r||(r=sc[e]=new ic),r}function m(t){return rc(v(t),(function(){return function(t){var r,n;function u(t,e){var o={id:n._id,key:ka(t)};null!=e&&(o.value=ka(e)),r.push(o)}var s=e(t.mapFun,u),c=t.seq||0;function f(e,r){return function(){return function(t,e,r){var n="_local/lastSeq";return t.db.get(n).catch(d({_id:n,seq:0})).then((function(n){var i=oc(e);return Promise.all(i.map((function(r){return y(r,t,e)}))).then((function(e){var i=Object(o.F)(e);return n.seq=r,i.push(n),t.db.bulkDocs({docs:i})}))}))}(t,e,r)}}var l=new ic;function h(){return t.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:c,limit:50}).then(p)}function p(t){var e=t.results;if(e.length){var r=v(e);if(l.add(f(r,c)),!(e.length<50))return h()}}function v(e){for(var u=new o.q,f=0,l=e.length;f<l;f++){var h=e[f];if("_"!==h.doc._id[0]){r=[],(n=h.doc)._deleted||i(t.sourceDB,s,n),r.sort(a);var p=m(r);u.set(h.doc._id,[p,h.changes])}c=h.seq}return u}function m(t){for(var e,r=new o.q,n=0,i=t.length;n<i;n++){var u=t[n],a=[u.key,u.id];n>0&&0===ja(u.key,e)&&a.push(n),r.set(Sa(a),u),e=u.key}return r}return h().then((function(){return l.finish()})).then((function(){t.seq=c}))}(t)}))()}function g(t,e){return rc(v(t),(function(){return function(t,e){var n,i=t.reduceFun&&!1!==e.reduce,a=e.skip||0;void 0===e.keys||e.keys.length||(e.limit=0,delete e.keys);function f(e){return e.include_docs=!0,t.db.allDocs(e).then((function(t){return n=t.total_rows,t.rows.map((function(t){if("value"in t.doc&&"object"==typeof t.doc.value&&null!==t.doc.value){var e=Object.keys(t.doc.value).sort(),r=["id","key","value"];if(!(e<r||e>r))return t.doc.value}var n=function(t){for(var e=[],r=[],n=0;;){var o=t[n++];if("\0"!==o)switch(o){case"1":e.push(null);break;case"2":e.push("1"===t[n]),n++;break;case"3":var i=xa(t,n);e.push(i.num),n+=i.length;break;case"4":for(var u="";;){var a=t[n];if("\0"===a)break;u+=a,n++}u=u.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(u);break;case"5":var s={element:[],index:e.length};e.push(s.element),r.push(s);break;case"6":var c={element:{},index:e.length};e.push(c.element),r.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}else{if(1===e.length)return e.pop();Pa(e,r)}}}(t.doc._id);return{key:n[0],id:n[1],value:"value"in t.doc?t.doc.value:null}}))}))}function l(f){var l;if(l=i?function(t,e,n){0===n.group_level&&delete n.group_level;var o=n.group||n.group_level,i=r(t.reduceFun),a=[],c=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;e.forEach((function(t){var e=a[a.length-1],r=o?t.key:null;if(o&&Array.isArray(r)&&(r=r.slice(0,c)),e&&0===ja(e.groupKey,r))return e.keys.push([t.key,t.id]),void e.values.push(t.value);a.push({keys:[[t.key,t.id]],values:[t.value],groupKey:r})})),e=[];for(var f=0,l=a.length;f<l;f++){var h=a[f],p=u(t.sourceDB,i,h.keys,h.values,!1);if(p.error&&p.error instanceof tc)throw p.error;e.push({value:p.error?null:p.output,key:h.groupKey})}return{rows:s(e,n.limit,n.skip)}}(t,f,e):{total_rows:n,offset:a,rows:f},e.update_seq&&(l.update_seq=t.seq),e.include_docs){var h=nc(f.map(c));return t.sourceDB.allDocs({keys:h,include_docs:!0,conflicts:e.conflicts,attachments:e.attachments,binary:e.binary}).then((function(t){var e=new o.q;return t.rows.forEach((function(t){e.set(t.id,t.doc)})),f.forEach((function(t){var r=c(t),n=e.get(r);n&&(t.doc=n)})),l}))}return l}if(void 0!==e.keys){var h=e.keys.map((function(t){var r={startkey:Sa([t]),endkey:Sa([t,{}])};return e.update_seq&&(r.update_seq=!0),f(r)}));return Promise.all(h).then(o.F).then(l)}var p,d,y={descending:e.descending};if(e.update_seq&&(y.update_seq=!0),"start_key"in e&&(p=e.start_key),"startkey"in e&&(p=e.startkey),"end_key"in e&&(d=e.end_key),"endkey"in e&&(d=e.endkey),void 0!==p&&(y.startkey=e.descending?Sa([p,{}]):Sa([p])),void 0!==d){var v=!1!==e.inclusive_end;e.descending&&(v=!v),y.endkey=Sa(v?[d,{}]:[d])}if(void 0!==e.key){var m=Sa([e.key]),g=Sa([e.key,{}]);y.descending?(y.endkey=m,y.startkey=g):(y.startkey=m,y.endkey=g)}return i||("number"==typeof e.limit&&(y.limit=e.limit),y.skip=a),f(y).then(l)}(t,e)}))()}function b(e,r,i){if("function"==typeof e._query)return function(t,e,r){return new Promise((function(n,o){t._query(e,r,(function(t,e){if(t)return o(t);n(e)}))}))}(e,r,i);if(Object(o.W)(e))return function(t,e,r){var n,i,u,a=[],s="GET";if(l("reduce",r,a),l("include_docs",r,a),l("attachments",r,a),l("limit",r,a),l("descending",r,a),l("group",r,a),l("group_level",r,a),l("skip",r,a),l("stale",r,a),l("conflicts",r,a),l("startkey",r,a,!0),l("start_key",r,a,!0),l("endkey",r,a,!0),l("end_key",r,a,!0),l("inclusive_end",r,a),l("key",r,a,!0),l("update_seq",r,a),a=""===(a=a.join("&"))?"":"?"+a,void 0!==r.keys){var c="keys="+encodeURIComponent(JSON.stringify(r.keys));c.length+a.length+1<=2e3?a+=("?"===a[0]?"&":"?")+c:(s="POST","string"==typeof e?n={keys:r.keys}:e.keys=r.keys)}if("string"==typeof e){var h=fc(e);return t.fetch("_design/"+h[0]+"/_view/"+h[1]+a,{headers:new Ns({"Content-Type":"application/json"}),method:s,body:JSON.stringify(n)}).then((function(t){return i=t.ok,u=t.status,t.json()})).then((function(t){if(!i)throw t.status=u,Object(o.eb)(t);return t.rows.forEach((function(t){if(t.value&&t.value.error&&"builtin_reduce_error"===t.value.error)throw new Error(t.reason)})),t})).then(f(r))}return n=n||{},Object.keys(e).forEach((function(t){Array.isArray(e[t])?n[t]=e[t]:n[t]=e[t].toString()})),t.fetch("_temp_view"+a,{headers:new Ns({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(n)}).then((function(t){return i=t.ok,u=t.status,t.json()})).then((function(t){if(!i)throw t.status=u,Object(o.eb)(t);return t})).then(f(r))}(e,r,i);if("string"!=typeof r)return p(i,r),cc.add((function(){return ac(e,"temp_view/temp_view",r.map,r.reduce,!0,t).then((function(t){return e=m(t).then((function(){return g(t,i)})),r=function(){return t.db.destroy()},e.then((function(t){return r().then((function(){return t}))}),(function(t){return r().then((function(){throw t}))}));var e,r}))})),cc.finish();var u=r,a=fc(u),s=a[0],c=a[1];return e.get("_design/"+s).then((function(r){var a=r.views&&r.views[c];if(!a)throw new Zs("ddoc "+r._id+" has no view named "+c);return n(r,c),p(i,a),ac(e,u,a.map,a.reduce,!1,t).then((function(t){return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&Object(o.z)((function(){m(t)})),g(t,i)):m(t).then((function(){return g(t,i)}))}))}))}var _;return{query:function(t,e,r){var n=this;"function"==typeof e&&(r=e,e={}),e=e?function(t){return t.group_level=h(t.group_level),t.limit=h(t.limit),t.skip=h(t.skip),t}(e):{},"function"==typeof t&&(t={map:t});var o=Promise.resolve().then((function(){return b(n,t,e)}));return ec(o,r),o},viewCleanup:(_=function(){var e=this;return"function"==typeof e._viewCleanup?function(t){return new Promise((function(e,r){t._viewCleanup((function(t,n){if(t)return r(t);e(n)}))}))}(e):Object(o.W)(e)?function(t){return t.fetch("_view_cleanup",{headers:new Ns({"Content-Type":"application/json"}),method:"POST"}).then((function(t){return t.json()}))}(e):function(e){return e.get("_local/"+t).then((function(t){var r=new o.q;Object.keys(t.views).forEach((function(t){var e=fc(t),n="_design/"+e[0],i=e[1],u=r.get(n);u||(u=new o.D,r.set(n,u)),u.add(i)}));var n={keys:oc(r),include_docs:!0};return e.allDocs(n).then((function(n){var o={};n.rows.forEach((function(e){var n=e.key.substring(8);r.get(e.key).forEach((function(r){var i=n+"/"+r;t.views[i]||(i=r);var u=Object.keys(t.views[i]),a=e.doc&&e.doc.views&&e.doc.views[r];u.forEach((function(t){o[t]=o[t]||a}))}))}));var i=Object.keys(o).filter((function(t){return!o[t]})).map((function(t){return rc(v(t),(function(){return new e.constructor(t,e.__opts).destroy()}))()}));return Promise.all(i).then((function(){return{ok:!0}}))}))}),d({ok:!0}))}(e)},Object(o.h)((function(t){var e=t.pop(),r=_.apply(this,t);return"function"==typeof e&&ec(r,e),r})))}}("indexes",(function(t,e){return Ec(Object.keys(t.fields),e)}),(function(){throw new Error("reduce not supported")}),(function(t,e){var r=t.views[e];if(!r.map||!r.map.fields)throw new Error("ddoc "+t._id+" with view "+e+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}));function xc(t){return t._customFindAbstractMapper||Sc}function Pc(t){return t.fields=t.fields.map((function(t){if("string"==typeof t){var e={};return e[t]="asc",e}return t})),t}function Ac(t,e){for(var r=[],n=0;n<e.def.fields.length;n++){var o=$a(e.def.fields[n]);r.push(t[o])}return r}function Ic(t){return t.allDocs({startkey:"_design/",endkey:"_design/",include_docs:!0}).then((function(t){var e={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return e.indexes=wc(e.indexes,t.rows.filter((function(t){return"query"===t.doc.language})).map((function(t){return(void 0!==t.doc.views?Object.keys(t.doc.views):[]).map((function(e){var r=t.doc.views[e];return{ddoc:t.id,name:e,type:"json",def:Pc(r.options.def)}}))}))),e.indexes.sort((function(t,e){return Da(t.name,e.name)})),e.total_rows=e.indexes.length,e}))}var Tc=null,Dc={"":{}};const Cc={queryOpts:{limit:0,startkey:Dc,endkey:Tc},inMemoryFields:[]};function Rc(t,e){for(var r=t.def.fields.map($a),n=0,o=r.length;n<o;n++){if(e===r[n])return!0}return!1}function Mc(t,e){return"$eq"!==$a(t[e])}function $c(t,e){var r=e.def.fields.map($a);return t.slice().sort((function(t,e){var n=r.indexOf(t),o=r.indexOf(e);return-1===n&&(n=Number.MAX_VALUE),-1===o&&(o=Number.MAX_VALUE),Da(n,o)}))}function Nc(t,e,r,n){var o=wc(t,function(t,e,r){for(var n=!1,o=0,i=(r=$c(r,t)).length;o<i;o++){var u=r[o];if(n||!Rc(t,u))return r.slice(o);o<i-1&&Mc(e,u)&&(n=!0)}return[]}(e,r,n),function(t){var e=[];return Object.keys(t).forEach((function(r){var n=t[r];Object.keys(n).forEach((function(t){"$ne"===t&&e.push(r)}))})),e}(r));return $c(function(t){for(var e={},r=0;r<t.length;r++)e["$"+t[r]]=!0;return Object.keys(e).map((function(t){return t.substring(1)}))}(o),e)}function Lc(t,e,r){if(e){var n=(u=t,!((i=e).length>u.length)&&jc(i,u)),o=jc(r,t);return n&&o}var i,u;return function(t,e){t=t.slice();for(var r=0,n=e.length;r<n;r++){var o=e[r];if(!t.length)break;var i=t.indexOf(o);if(-1===i)return!1;t.splice(i,1)}return!0}(r,t)}var Bc=["$eq","$gt","$gte","$lt","$lte"];function qc(t){return-1===Bc.indexOf(t)}function Uc(t,e,r,n){var o=t.def.fields.map($a);return!!Lc(o,e,r)&&function(t,e){var r=e[t[0]];return void 0===r||!(1===Object.keys(r).length&&"$ne"===$a(r))}(o,n)}function Fc(t,e,r,n,o){var i=function(t,e,r,n){return n.filter((function(n){return Uc(n,r,e,t)}))}(t,e,r,n);if(0===i.length){if(o)throw{error:"no_usable_index",message:"There is no index available for this selector."};var u=n[0];return u.defaultUsed=!0,u}if(1===i.length&&!o)return i[0];var a=function(t){for(var e={},r=0,n=t.length;r<n;r++)e[t[r]]=!0;return e}(e);if(o){var s="_design/"+o[0],c=2===o.length&&o[1],f=i.find((function(t){return!(!c||t.ddoc!==s||c!==t.name)||t.ddoc===s}));if(!f)throw{error:"unknown_error",message:"Could not find that index or could not use that index for the query"};return f}return function(t,e){for(var r=null,n=-1,o=0,i=t.length;o<i;o++){var u=t[o],a=e(u);a>n&&(n=a,r=u)}return r}(i,(function(t){for(var e=t.def.fields.map($a),r=0,n=0,o=e.length;n<o;n++){var i=e[n];a[i]&&r++}return r}))}function Wc(t,e){var r,n=$a(e.def.fields[0]),o=t[n]||{},i=[];return Object.keys(o).forEach((function(t){qc(t)&&i.push(n);var e=function(t,e){switch(t){case"$eq":return{key:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}return{startkey:Tc}}(t,o[t]);r=r?Oc([r,e]):e})),{queryOpts:r,inMemoryFields:i}}function Yc(t,e){switch(t){case"$eq":return{startkey:e,endkey:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}}function Qc(t,e){return e.defaultUsed?function(t){return{queryOpts:{startkey:null},inMemoryFields:[Object.keys(t)]}}(t):1===e.def.fields.length?Wc(t,e):function(t,e){var r,n,o=e.def.fields.map($a),i=[],u=[],a=[];function s(t){!1!==r&&u.push(Tc),!1!==n&&a.push(Dc),i=o.slice(t)}for(var c=0,f=o.length;c<f;c++){var l=t[o[c]];if(!l||!Object.keys(l).length){s(c);break}if(Object.keys(l).some(qc)){s(c);break}if(c>0){var h="$gt"in l||"$gte"in l||"$lt"in l||"$lte"in l,p=Object.keys(t[o[c-1]]),d=kc(p,["$eq"]),y=kc(p,Object.keys(l));if(h&&!d&&!y){s(c);break}}for(var v=Object.keys(l),m=null,g=0;g<v.length;g++){var b=v[g],_=Yc(b,l[b]);m=m?Oc([m,_]):_}u.push("startkey"in m?m.startkey:Tc),a.push("endkey"in m?m.endkey:Dc),"inclusive_start"in m&&(r=m.inclusive_start),"inclusive_end"in m&&(n=m.inclusive_end)}var w={startkey:u,endkey:a};return void 0!==r&&(w.inclusive_start=r),void 0!==n&&(w.inclusive_end=n),{queryOpts:w,inMemoryFields:i}}(t,e)}function zc(t,e){var r=t.selector,n=t.sort;if(function(t){return Object.keys(t).map((function(e){return t[e]})).some((function(t){return"object"==typeof t&&0===Object.keys(t).length}))}(r))return Object(o.k)({},Cc,{index:e[0]});var i=function(t,e){var r,n=Object.keys(t),o=e?e.map($a):[];return r=n.length>=o.length?n:o,0===o.length?{fields:r}:{fields:r=r.sort((function(t,e){var r=o.indexOf(t);-1===r&&(r=Number.MAX_VALUE);var n=o.indexOf(e);return-1===n&&(n=Number.MAX_VALUE),r<n?-1:r>n?1:0})),sortOrder:e.map($a)}}(r,n),u=i.fields,a=Fc(r,u,i.sortOrder,e,t.use_index),s=Qc(r,a);return{queryOpts:s.queryOpts,index:a,inMemoryFields:Nc(s.inMemoryFields,a,r,u)}}function Vc(t,e,r){var n,i;return e.selector&&(e.selector=Ua(e.selector)),e.sort&&(e.sort=function(t){if(!Array.isArray(t))throw new Error("invalid sort json - should be an array");return t.map((function(t){if("string"==typeof t){var e={};return e[t]="asc",e}return t}))}(e.sort)),e.use_index&&(e.use_index=(n=e.use_index,i=[],"string"==typeof n?i.push(n):i=n,i.map((function(t){return t.replace("_design/","")})))),function(t){if("object"!=typeof t.selector)throw new Error("you must provide a selector when you find()")}(e),Ic(t).then((function(n){t.constructor.emit("debug",["find","planning query",e]);var i=zc(e,n.indexes);t.constructor.emit("debug",["find","query plan",i]);var u=i.index;!function(t,e){if(e.defaultUsed&&t.sort){var r=t.sort.filter((function(t){return"_id"!==Object.keys(t)[0]})).map((function(t){return Object.keys(t)[0]}));if(r.length>0)throw new Error('Cannot sort on field(s) "'+r.join(",")+'" when using the default index')}e.defaultUsed}(e,u);var a=Object(o.k)({include_docs:!0,reduce:!1,indexes_count:n.total_rows},i.queryOpts);return"startkey"in a&&"endkey"in a&&ja(a.startkey,a.endkey)>0?{docs:[]}:(e.sort&&"string"!=typeof e.sort[0]&&"desc"===Na(e.sort[0])&&(a.descending=!0,a=function(t){var e=Object(o.U)(t);return delete e.startkey,delete e.endkey,delete e.inclusive_start,delete e.inclusive_end,"endkey"in t&&(e.startkey=t.endkey),"startkey"in t&&(e.endkey=t.startkey),"inclusive_start"in t&&(e.inclusive_end=t.inclusive_start),"inclusive_end"in t&&(e.inclusive_start=t.inclusive_end),e}(a)),i.inMemoryFields.length||("limit"in e&&(a.limit=e.limit),"skip"in e&&(a.skip=e.skip)),r?Promise.resolve(i,a):Promise.resolve().then((function(){if("_all_docs"===u.name)return function(t,e){var r=Object(o.U)(e);return r.descending?("endkey"in r&&"string"!=typeof r.endkey&&(r.endkey=""),"startkey"in r&&"string"!=typeof r.startkey&&(r.limit=0)):("startkey"in r&&"string"!=typeof r.startkey&&(r.startkey=""),"endkey"in r&&"string"!=typeof r.endkey&&(r.limit=0)),"key"in r&&"string"!=typeof r.key&&(r.limit=0),r.limit>0&&r.indexes_count&&(r.original_limit=r.limit,r.limit+=r.indexes_count),t.allDocs(r).then((function(t){return t.rows=t.rows.filter((function(t){return!/^_design\//.test(t.id)})),r.original_limit&&(r.limit=r.original_limit),t.rows=t.rows.slice(0,r.limit),t}))}(t,a);var e=function(t){return t.ddoc.substring(8)+"/"+t.name}(u);return xc(t).query.call(t,e,a)})).then((function(t){!1===a.inclusive_start&&(t.rows=function(t,e,r){for(var n=r.def.fields,o=0,i=t.length;o<i;o++){var u=Ac(t[o].doc,r);if(1===n.length)u=u[0];else for(;u.length>e.length;)u.pop();if(Math.abs(ja(u,e))>0)break}return o>0?t.slice(o):t}(t.rows,a.startkey,u)),i.inMemoryFields.length&&(t.rows=Fa(t.rows,e,i.inMemoryFields));var r={docs:t.rows.map((function(t){var r=t.doc;return e.fields?function(t,e){for(var r={},n=0,o=e.length;n<o;n++){var i=Ca(e[n]),u=Ia(t,i);void 0!==u&&Ta(r,i,u)}return r}(r,e.fields):r}))};return u.defaultUsed&&(r.warning="No matching index found, create an index to optimize query time."),r})))}))}var Jc=_c((function(t,e){e=hc(e);var r,n=Object(o.U)(e.index);function i(){return r||(r=Object(o.E)(JSON.stringify(e)))}e.index=Pc(e.index),function(t){var e=t.fields.filter((function(t){return"asc"===Na(t)}));if(0!==e.length&&e.length!==t.fields.length)throw new Error("unsupported mixed sorting")}(e.index);var u=e.name||"idx-"+i(),a=e.ddoc||"idx-"+i(),s="_design/"+a,c=!1,f=!1;return t.constructor.emit("debug",["find","creating index",s]),Object(o.t)(t,s,(function(t){return t._rev&&"query"!==t.language&&(c=!0),t.language="query",t.views=t.views||{},!(f=!!t.views[u])&&(t.views[u]={map:{fields:Oc(e.index.fields)},reduce:"_count",options:{def:n}},t)})).then((function(){if(c)throw new Error('invalid language for ddoc with id "'+s+'" (should be "query")')})).then((function(){var e=a+"/"+u;return xc(t).query.call(t,e,{limit:0,reduce:!1}).then((function(){return{id:s,name:u,result:f?"exists":"created"}}))}))})),Hc=_c(Vc),Gc=_c((function(t,e){return Vc(t,e,!0).then((function(r){return{dbname:t.name,index:r.index,selector:e.selector,range:{start_key:r.queryOpts.startkey,end_key:r.queryOpts.endkey},opts:{use_index:e.use_index||[],bookmark:"nil",limit:e.limit,skip:e.skip,sort:e.sort||{},fields:e.fields,conflicts:!1,r:[49]},limit:e.limit,skip:e.skip||0,fields:e.fields}}))})),Kc=_c(Ic),Xc=_c((function(t,e){if(!e.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!e.name)throw new Error("you must supply an index.name when deleting");var r=e.ddoc,n=e.name;return Object(o.t)(t,r,(function(t){return 1===Object.keys(t.views).length&&t.views[n]?{_id:r,_deleted:!0}:(delete t.views[n],t)})).then((function(){return xc(t).viewCleanup.apply(t)})).then((function(){return{ok:!0}}))})),Zc={};Zc.createIndex=Object(o.H)((function(t,e){if("object"!=typeof t)return e(new Error("you must provide an index to create"));(Object(o.W)(this)?dc:Jc)(this,t,e)})),Zc.find=Object(o.H)((function(t,e){if(void 0===e&&(e=t,t=void 0),"object"!=typeof t)return e(new Error("you must provide search parameters to find()"));(Object(o.W)(this)?yc:Hc)(this,t,e)})),Zc.explain=Object(o.H)((function(t,e){if(void 0===e&&(e=t,t=void 0),"object"!=typeof t)return e(new Error("you must provide search parameters to explain()"));(Object(o.W)(this)?vc:Gc)(this,t,e)})),Zc.getIndexes=Object(o.H)((function(t){(Object(o.W)(this)?mc:Kc)(this,t)})),Zc.deleteIndex=Object(o.H)((function(t,e){if("object"!=typeof t)return e(new Error("you must provide an index to delete"));(Object(o.W)(this)?gc:Xc)(this,t,e)})),Gs.plugin(Zc);var tf="^[a-z][_$a-z0-9]*$",ef=new RegExp(tf);var rf=Gs;function nf(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=t.schema.swapIdToPrimary(e),t.schema.doKeyCompression()&&(e=t._keyCompressor.decompress(e)),r?e:e=t._crypter.decrypt(e)}function of(t,e){var r=t.schema.fillObjectWithDefaults(e);if(r._id&&"_id"!==t.schema.primaryPath)throw Di("COL2",{data:e});return"_id"!==t.schema.primaryPath||r._id||(r._id=so(10)+":"+fi()),r}var uf=function(){function t(){this._map=new Map,this._map=new Map}var e=t.prototype;return e.get=function(t){return this._map.get(t)},e.set=function(t,e){return this._map.set(t,e)},e.delete=function(t){return this._map.delete(t)},t}();function af(){return new uf}var sf=function(){function t(t){var e=this;this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=t,this.subs.push(this.collection.$.subscribe((function(t){return e._handleChangeEvent(t)})))}var e=t.prototype;return e._handleChangeEvent=function(t){for(this.counter++,this.buffer.push(t),this.eventCounterMap.set(t,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},e.getArrayIndexByPointer=function(t){var e=this.buffer[0],r=this.eventCounterMap.get(e);return t<r?null:t-r},e.getFrom=function(t){var e=[],r=this.getArrayIndexByPointer(t);if(null===r)return null;for(;;){var n=this.buffer[r];if(r++,!n)return e;e.push(n)}},e.runFrom=function(t,e){var r=this.getFrom(t);if(null===r)throw new Error("out of bounds");r.forEach((function(t){return e(t)}))},e.reduceByLastOfDoc=function(t){return t.slice(0)},e.hasChangeWithRevision=function(t){for(var e=this.buffer.length;e>0;){e--;var r=this.buffer[e];if(r.documentData&&r.documentData._rev===t)return!0}return!1},e.destroy=function(){this.subs.forEach((function(t){return t.unsubscribe()}))},t}();var cf=["pre","post"],ff=["insert","save","remove","create"],lf=!1,hf=function(){function t(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Ps,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:{};this._isInMemory=!1,this.destroyed=!1,this._atomicUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._repStates=[],this.pouch={},this._docCache=af(),this._queryCache=js(),this._crypter={},this._changeEventBuffer={},this.database=t,this.name=e,this.schema=r,this.pouchSettings=n,this.migrationStrategies=o,this.methods=i,this.attachments=u,this.options=a,this.cacheReplacementPolicy=s,this.statics=c,pf(this.asRxCollection)}var e=t.prototype;return e.prepare=function(t){var e=this;this.pouch=this.database._spawnPouchDB(this.name,this.schema.version,this.pouchSettings),this.schema.doKeyCompression()&&(this._keyCompressor=Pi.createKeyCompressor(this.schema));var r,n,o,i=t?Promise.resolve():this.pouch.info(),u=t?Promise.resolve():function(t,e){return e.then((function(){return t.pouch.getIndexes()})).then((function(t){var e=new Set;return t.indexes.forEach((function(t){return e.add(t.name)})),e})).then((function(r){return Promise.all(t.schema.indexes.map((function(n){var o=n.map((function(e){var r=e===t.schema.primaryPath?"_id":e;return t.schema.doKeyCompression()?t._keyCompressor.transformKey(r):r})),i="idx-rxdb-index-"+o.join(",");if(!r.has(i))return e.then((function(){return t.pouch.createIndex({name:i,ddoc:i,index:{fields:o}})}))})))}))}(this.asRxCollection,i);return this._crypter=(r=this.database.password,n=this.schema,new wa(r,n)),this._observable$=this.database.$.pipe(Vu((function(t){return t.collectionName===e.name}))),this._changeEventBuffer=(o=this.asRxCollection,new sf(o)),this._subs.push(this._observable$.pipe(Vu((function(t){return!t.isLocal}))).subscribe((function(t){var r=e._docCache.get(t.documentId);r&&r._handleChangeEvent(t)}))),Promise.all([i,u])},e.migrationNeeded=function(){if(0===this.schema.version)return Promise.resolve(!1);throw si("migration")},e.getDataMigrator=function(){throw si("migration")},e.migrate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.getDataMigrator().migrate(t)},e.migratePromise=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.getDataMigrator().migratePromise(t)},e._handleToPouch=function(t){return r=t,r=(e=this)._crypter.encrypt(r),r=e.schema.swapPrimaryToId(r),e.schema.doKeyCompression()&&(r=e._keyCompressor.compress(r)),r;var e,r},e._handleFromPouch=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return nf(this,t,e)},e._pouchPut=function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=this._handleToPouch(t),this.database.lockedRun((function(){return e.pouch.put(t)})).catch((function(n){if(r&&409===n.status)return e.database.lockedRun((function(){return e.pouch.get(t._id)})).then((function(r){return t._rev=r._rev,e.database.lockedRun((function(){return e.pouch.put(t)}))}));throw 409===n.status?Di("COL19",{id:t._id,pouchDbError:n,data:t}):n}))},e._pouchGet=function(t){var e=this;return this.pouch.get(t).then((function(t){return e._handleFromPouch(t)}))},e._pouchFind=function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.keyCompress();return e&&(o.limit=e),this.database.lockedRun((function(){return r.pouch.find(o)})).then((function(t){return t.docs.map((function(t){return r._handleFromPouch(t,n)}))}))},e.$emit=function(t){return this.database.$emit(t)},e.insert=function(t){var e,r=this,n=null;if(void 0!==(e=t)&&e.isInstanceOfRxDocument){if(!(n=t)._isTemporary)throw Di("COL1",{data:t});t=n.toJSON()}var o,i,u=of(this,t),a=n;return this._runHooks("pre","insert",u).then((function(){return r.schema.validate(u),o=fi(),r._pouchPut(u)})).then((function(t){return i=fi(),u[r.schema.primaryPath]=t.id,u._rev=t.rev,n?n._dataSync$.next(u):a=Za(r,u),r._runHooks("post","insert",u,a)})).then((function(){var t=ha(r,u,o,i,a);return r.$emit(t),a}))},e.bulkInsert=function(t){var e=this,r=t.map((function(t){return of(e,t)}));return Promise.all(r.map((function(t){return e._runHooks("pre","insert",t).then((function(){return e.schema.validate(t),t}))}))).then((function(t){var r=t.map((function(t){return e._handleToPouch(t)})),n=new Map;return t.forEach((function(t){n.set(t[e.schema.primaryPath],t)})),e.database.lockedRun((function(){var t=fi();return e.pouch.bulkDocs(r).then((function(r){var o=fi(),i=r.filter((function(t){return t.ok})).map((function(t){var r=n.get(t.id);return r._rev=t.rev,Za(e,r)}));return i.forEach((function(r){var n=ha(e,r.toJSON(!0),t,o,r);e.$emit(n)})),{success:i,error:r.filter((function(t){return!t.ok}))}}))}))}))},e.upsert=function(t){var e=this,r=gi(t),n=r[this.schema.primaryPath];if(!n)throw Di("COL3",{primaryPath:this.schema.primaryPath,data:r});return this.findOne(n).exec().then((function(n){return n?(r._rev=n._rev,n.atomicUpdate((function(){return r})).then((function(){return n}))):e.insert(t)}))},e.atomicUpsert=function(t){var e,r=this,n=t[this.schema.primaryPath];if(!n)throw Di("COL4",{data:t});return e=(e=this._atomicUpsertQueues.has(n)?this._atomicUpsertQueues.get(n):Promise.resolve()).then((function(){return function(t,e,r){return t.findOne(e).exec().then((function(e){return e?{doc:e,inserted:!1}:t.insert(r).then((function(t){return{doc:t,inserted:!0}}))}))}(r,n,t)})).then((function(e){return e.inserted?e.doc:function(t,e){return t.atomicUpdate((function(t){return e._rev=t._rev,t._data=e,t._data})).then((function(){return t}))}(e.doc,t).then((function(){return li()})).then((function(){return e.doc}))})),this._atomicUpsertQueues.set(n,e),e},e.find=function(t){if("string"==typeof t)throw Di("COL5",{queryObj:t});return t||(t=Cs(this)),Rs("find",t,this)},e.findOne=function(t){var e;if("string"==typeof t)e=Rs("findOne",{selector:{_id:t}},this);else{if(t||(t=Cs(this)),t.limit)throw Di("QU6");e=Rs("findOne",t,this)}if("number"==typeof t||Array.isArray(t))throw Ci("COL6",{queryObj:t});return e},e.findByIds=function(){var t=Li($i.mark((function t(e){var r,n,o=this;return $i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=new Map,n=[],e.forEach((function(t){var e=o._docCache.get(t);e?r.set(t,e):n.push(t)})),!(n.length>0)){t.next=8;break}return t.next=6,this.pouch.allDocs({include_docs:!0,keys:n});case 6:t.sent.rows.forEach((function(t){if(t.doc){var e=o._handleFromPouch(t.doc),n=Za(o,e);r.set(n.primary,n)}}));case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.findByIds$=function(t){var e=this,r=null,n=this.findByIds(t).then((function(t){r=t}));return this.$.pipe(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return vu(r)?(t.pop(),function(e){return zu(t,e,r)}):function(e){return zu(t,e)}}(null),Uu((function(t){return n.then((function(){return t}))})),Iu((function(n){if(!r)throw new Error("should not happen");if(!n)return r;if(!t.includes(n.documentId))return null;var o=n.operation;return"INSERT"===o||"UPDATE"===o?r.set(n.documentId,e._docCache.get(n.documentId)):r.delete(n.documentId),r})),Vu((function(t){return!!t})),sa(1))},e.dump=function(){throw si("json-dump")},e.importDump=function(t){throw si("json-dump")},e.watchForChanges=function(){throw si("watch-for-changes")},e.sync=function(t){throw si("replication")},e.syncGraphQL=function(t){throw si("replication-graphql")},e.inMemory=function(){throw si("in-memory")},e.addHook=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("function"!=typeof r)throw Ci("COL7",{key:e,when:t});if(!cf.includes(t))throw Ci("COL8",{key:e,when:t});if(!ff.includes(e))throw Di("COL9",{key:e});if("post"===t&&"create"===e&&!0===n)throw Di("COL10",{when:t,key:e,parallel:n});var o=r.bind(this),i=n?"parallel":"series";this.hooks[e]=this.hooks[e]||{},this.hooks[e][t]=this.hooks[e][t]||{series:[],parallel:[]},this.hooks[e][t][i].push(o)},e.getHooks=function(t,e){try{return this.hooks[e][t]}catch(t){return{series:[],parallel:[]}}},e._runHooks=function(t,e,r,n){var o=this.getHooks(t,e);return o?function(t,e){return t.reduce((function(t,e){return t.then(e)}),Promise.resolve(e))}(o.series.map((function(t){return function(){return t(r,n)}}))).then((function(){return Promise.all(o.parallel.map((function(t){return t(r,n)})))})):Promise.resolve()},e._runHooksSync=function(t,e,r,n){var o=this.getHooks(t,e);o&&o.series.forEach((function(t){return t(r,n)}))},e.newDocument=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=this.schema.fillObjectWithDefaults(t);var e=va(Xa(this),this,t);return e._isTemporary=!0,this._runHooksSync("post","create",t,e),e},e.destroy=function(){return this.destroyed?Promise.resolve(!1):(this._onDestroyCall&&this._onDestroyCall(),this._subs.forEach((function(t){return t.unsubscribe()})),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this._repStates.forEach((function(t){return t.cancel()})),delete this.database.collections[this.name],this.destroyed=!0,Promise.resolve(!0))},e.remove=function(){return this.database.removeCollection(this.name)},c(t,[{key:"$",get:function(){return this._observable$}},{key:"insert$",get:function(){return this.$.pipe(Vu((function(t){return"INSERT"===t.operation})))}},{key:"update$",get:function(){return this.$.pipe(Vu((function(t){return"UPDATE"===t.operation})))}},{key:"remove$",get:function(){return this.$.pipe(Vu((function(t){return"DELETE"===t.operation})))}},{key:"onDestroy",get:function(){var t=this;return this._onDestroy||(this._onDestroy=new Promise((function(e){return t._onDestroyCall=e}))),this._onDestroy}},{key:"asRxCollection",get:function(){return this}}]),t}();function pf(t){if(!lf){lf=!0;var e=Object.getPrototypeOf(t);ff.forEach((function(t){cf.map((function(r){var n=r+hi(t);e[n]=function(e,n){return this.addHook(r,t,e,n)}}))}))}}function df(t,e){var r=t.database,n=t.name,o=t.schema,i=t.pouchSettings,u=void 0===i?{}:i,a=t.migrationStrategies,s=void 0===a?{}:a,c=t.autoMigrate,f=void 0===c||c,l=t.statics,h=void 0===l?{}:l,p=t.methods,d=void 0===p?{}:p,y=t.attachments,v=void 0===y?{}:y,m=t.options,g=void 0===m?{}:m,b=t.cacheReplacementPolicy,_=void 0===b?Ps:b;!function(t){if("string"!=typeof t||0===t.length)throw Ci("UT1",{name:t});if(function(t){return!(!t.includes("/")&&!t.includes("\\"))}(t))return!0;if(!t.match(ef))throw Di("UT2",{regex:tf,givenName:t})}(n),o instanceof ma||(o=_a(o)),Object.keys(d).filter((function(t){return o.topLevelFields.includes(t)})).forEach((function(t){throw Di("COL18",{funName:t})}));var w=new hf(r,n,o,u,s,d,v,g,_,h);return w.prepare(e).then((function(){Object.entries(h).forEach((function(t){var e=t[0],r=t[1];Object.defineProperty(w,e,{get:function(){return r.bind(w)}})}));var t=Promise.resolve();return f&&0!==w.schema.version&&(t=w.migratePromise()),t})).then((function(){return Mi("createRxCollection",w),w}))}var yf=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._parallels=t||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};function vf(t,e){if(e){if(e._timeoutObj&&clearTimeout(e._timeoutObj),t._pHM.has(e)){var r=t._pHM.get(e);t._hPM.delete(r),t._pHM.delete(e)}t._iC.delete(e)}}function mf(t){t._tryIR||0===t._iC.size||(t._tryIR=!0,setTimeout((function(){t.isIdle()?setTimeout((function(){t.isIdle()?(!function(t){0!==t._iC.size&&(t._iC.values().next().value._manRes(),setTimeout((function(){return mf(t)}),0))}(t),t._tryIR=!1):t._tryIR=!1}),0):t._tryIR=!1}),0))}yf.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,mf(this)},wrapCall:function(t){var e,r=this;this.lock();try{e=t()}catch(t){throw this.unlock(),t}return e.then&&"function"==typeof e.then?e.then((function(t){return r.unlock(),t})).catch((function(t){throw r.unlock(),t})):(this.unlock(),e)},requestIdlePromise:function(t){var e,r=this;t=t||{};var n=new Promise((function(t){return e=t}));if(n._manRes=function(){vf(r,n),e()},t.timeout){var o=setTimeout((function(){n._manRes()}),t.timeout);n._timeoutObj=o}return this._iC.add(n),mf(this),n},cancelIdlePromise:function(t){vf(this,t)},requestIdleCallback:function(t,e){var r=this._lHN++,n=this.requestIdlePromise(e);return this._hPM.set(r,n),this._pHM.set(n,r),n.then((function(){return t()})),r},cancelIdleCallback:function(t){var e=this._hPM.get(t);this.cancelIdlePromise(e)},clear:function(){var t=this;this._iC.forEach((function(e){return vf(t,e)})),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};var gf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isPromise=function(t){return!(!t||"function"!=typeof t.then)},e.sleep=function(t){t||(t=0);return new Promise((function(e){return setTimeout(e,t)}))},e.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},e.randomToken=function(){return Math.random().toString(36).substring(2)},e.microSeconds=function(){var t=(new Date).getTime();return t===r?(n++,1e3*t+n):(r=t,n=0,1e3*t)},e.isNode=void 0;var r=0,n=0;var o="[object process]"===Object.prototype.toString.call(void 0!==hr?hr:0);e.isNode=o})),bf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=o,e.close=i,e.postMessage=u,e.onMessage=a,e.canBeUsed=s,e.averageResponseTime=c,e.default=e.type=e.microSeconds=void 0;var r=gf.microSeconds;e.microSeconds=r;var n="native";function o(t){var e={messagesCallback:null,bc:new BroadcastChannel(t),subFns:[]};return e.bc.onmessage=function(t){e.messagesCallback&&e.messagesCallback(t.data)},e}function i(t){t.bc.close(),t.subFns=[]}function u(t,e){t.bc.postMessage(e,!1)}function a(t,e){t.messagesCallback=e}function s(){if(gf.isNode&&"undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1}function c(){return 150}e.type=n;var f={create:o,close:i,onMessage:a,postMessage:u,canBeUsed:s,type:n,averageResponseTime:c,microSeconds:r};e.default=f})),_f=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function r(){return(new Date).getTime()}var n=function(t){var e=new Set,n=new Map;this.has=e.has.bind(e),this.add=function(o){n.set(o,r()),e.add(o),function(){var o=r()-t,i=e[Symbol.iterator]();for(;;){var u=i.next().value;if(!u)return;if(!(n.get(u)<o))return;n.delete(u),e.delete(u)}}()},this.clear=function(){e.clear(),n.clear()}};e.default=n})),wf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.fillOptionsWithDefaults=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=JSON.parse(JSON.stringify(t));void 0===e.webWorkerSupport&&(e.webWorkerSupport=!0);e.idb||(e.idb={});e.idb.ttl||(e.idb.ttl=45e3);e.idb.fallbackInterval||(e.idb.fallbackInterval=150);t.idb&&"function"==typeof t.idb.onclose&&(e.idb.onclose=t.idb.onclose);e.localstorage||(e.localstorage={});e.localstorage.removeTimeout||(e.localstorage.removeTimeout=6e4);t.methods&&(e.methods=t.methods);e.node||(e.node={});e.node.ttl||(e.node.ttl=12e4);void 0===e.node.useFastPath&&(e.node.useFastPath=!0);return e}})),Of=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getIdb=u,e.createDatabase=a,e.writeMessage=s,e.getAllMessages=function(t){var e=t.transaction(o).objectStore(o),r=[];return new Promise((function(t){e.openCursor().onsuccess=function(e){var n=e.target.result;n?(r.push(n.value),n.continue()):t(r)}}))},e.getMessagesHigherThan=c,e.removeMessageById=f,e.getOldMessages=l,e.cleanOldMessages=h,e.create=p,e.close=v,e.postMessage=m,e.onMessage=g,e.canBeUsed=b,e.averageResponseTime=_,e.default=e.type=e.microSeconds=void 0;var r=Object(i.a)(_f),n=gf.microSeconds;e.microSeconds=n;var o="messages";function u(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function a(t){var e="pubkey.broadcast-channel-0-"+t,r=u().open(e,1);return r.onupgradeneeded=function(t){t.target.result.createObjectStore(o,{keyPath:"id",autoIncrement:!0})},new Promise((function(t,e){r.onerror=function(t){return e(t)},r.onsuccess=function(){t(r.result)}}))}function s(t,e,r){var n={uuid:e,time:(new Date).getTime(),data:r},i=t.transaction([o],"readwrite");return new Promise((function(t,e){i.oncomplete=function(){return t()},i.onerror=function(t){return e(t)},i.objectStore(o).add(n)}))}function c(t,e){var r=t.transaction(o).objectStore(o),n=[];return new Promise((function(t){(function(){try{var t=IDBKeyRange.bound(e+1,1/0);return r.openCursor(t)}catch(t){return r.openCursor()}}()).onsuccess=function(r){var o=r.target.result;o?o.value.id<e+1?o.continue(e+1):(n.push(o.value),o.continue()):t(n)}}))}function f(t,e){var r=t.transaction([o],"readwrite").objectStore(o).delete(e);return new Promise((function(t){r.onsuccess=function(){return t()}}))}function l(t,e){var r=(new Date).getTime()-e,n=t.transaction(o).objectStore(o),i=[];return new Promise((function(t){n.openCursor().onsuccess=function(e){var n=e.target.result;if(n){var o=n.value;if(!(o.time<r))return void t(i);i.push(o),n.continue()}else t(i)}}))}function h(t,e){return l(t,e).then((function(e){return Promise.all(e.map((function(e){return f(t,e.id)})))}))}function p(t,e){return e=(0,wf.fillOptionsWithDefaults)(e),a(t).then((function(n){var o={closed:!1,lastCursorId:0,channelName:t,options:e,uuid:(0,gf.randomToken)(),eMIs:new r.default(2*e.idb.ttl),writeBlockPromise:Promise.resolve(),messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){o.closed=!0,e.idb.onclose&&e.idb.onclose()},d(o),o}))}function d(t){t.closed||y(t).then((function(){return(0,gf.sleep)(t.options.idb.fallbackInterval)})).then((function(){return d(t)}))}function y(t){return t.closed?Promise.resolve():t.messagesCallback?c(t.db,t.lastCursorId).then((function(e){return e.filter((function(t){return!!t})).map((function(e){return e.id>t.lastCursorId&&(t.lastCursorId=e.id),e})).filter((function(e){return function(t,e){return!(t.uuid===e.uuid||e.eMIs.has(t.id)||t.data.time<e.messagesCallbackTime)}(e,t)})).sort((function(t,e){return t.time-e.time})).forEach((function(e){t.messagesCallback&&(t.eMIs.add(e.id),t.messagesCallback(e.data))})),Promise.resolve()})):Promise.resolve()}function v(t){t.closed=!0,t.db.close()}function m(t,e){return t.writeBlockPromise=t.writeBlockPromise.then((function(){return s(t.db,t.uuid,e)})).then((function(){0===(0,gf.randomInt)(0,10)&&h(t.db,t.options.idb.ttl)})),t.writeBlockPromise}function g(t,e,r){t.messagesCallbackTime=r,t.messagesCallback=e,y(t)}function b(){return!gf.isNode&&!!u()}function _(t){return 2*t.idb.fallbackInterval}e.type="idb";var w={create:p,close:v,onMessage:g,postMessage:m,canBeUsed:b,type:"idb",averageResponseTime:_,microSeconds:n};e.default=w})),jf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getLocalStorage=u,e.storageKey=a,e.postMessage=s,e.addStorageEventListener=c,e.removeStorageEventListener=f,e.create=l,e.close=h,e.onMessage=p,e.canBeUsed=d,e.averageResponseTime=y,e.default=e.type=e.microSeconds=void 0;var r=Object(i.a)(_f),n=gf.microSeconds;e.microSeconds=n;var o="localstorage";function u(){var t;if("undefined"==typeof window)return null;try{t=window.localStorage,t=window["ie8-eventlistener/storage"]||window.localStorage}catch(t){}return t}function a(t){return"pubkey.broadcastChannel-"+t}function s(t,e){return new Promise((function(r){(0,gf.sleep)().then((function(){var n=a(t.channelName),o={token:(0,gf.randomToken)(),time:(new Date).getTime(),data:e,uuid:t.uuid},i=JSON.stringify(o);u().setItem(n,i);var s=document.createEvent("Event");s.initEvent("storage",!0,!0),s.key=n,s.newValue=i,window.dispatchEvent(s),r()}))}))}function c(t,e){var r=a(t),n=function(t){t.key===r&&e(JSON.parse(t.newValue))};return window.addEventListener("storage",n),n}function f(t){window.removeEventListener("storage",t)}function l(t,e){if(e=(0,wf.fillOptionsWithDefaults)(e),!d())throw new Error("BroadcastChannel: localstorage cannot be used");var n=(0,gf.randomToken)(),o=new r.default(e.localstorage.removeTimeout),i={channelName:t,uuid:n,eMIs:o};return i.listener=c(t,(function(t){i.messagesCallback&&t.uuid!==n&&t.token&&!o.has(t.token)&&(t.data.time&&t.data.time<i.messagesCallbackTime||(o.add(t.token),i.messagesCallback(t.data)))})),i}function h(t){f(t.listener)}function p(t,e,r){t.messagesCallbackTime=r,t.messagesCallback=e}function d(){if(gf.isNode)return!1;var t=u();if(!t)return!1;try{var e="__broadcastchannel_check";t.setItem(e,"works"),t.removeItem(e)}catch(t){return!1}return!0}function y(){var t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?240:120}e.type=o;var v={create:l,close:h,onMessage:p,postMessage:s,canBeUsed:d,type:o,averageResponseTime:y,microSeconds:n};e.default=v})),kf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=i,e.close=u,e.postMessage=a,e.onMessage=s,e.canBeUsed=c,e.averageResponseTime=f,e.default=e.type=e.microSeconds=void 0;var r=gf.microSeconds;e.microSeconds=r;var n="simulate";e.type=n;var o=new Set;function i(t){var e={name:t,messagesCallback:null};return o.add(e),e}function u(t){o.delete(t)}function a(t,e){return new Promise((function(r){return setTimeout((function(){Array.from(o).filter((function(e){return e.name===t.name})).filter((function(e){return e!==t})).filter((function(t){return!!t.messagesCallback})).forEach((function(t){return t.messagesCallback(e)})),r()}),5)}))}function s(t,e){t.messagesCallback=e}function c(){return!0}function f(){return 5}var l={create:i,close:u,onMessage:s,postMessage:a,canBeUsed:c,type:n,averageResponseTime:f,microSeconds:r};e.default=l})),Ef=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.chooseMethod=function(t){var e=[].concat(t.methods,s).filter(Boolean);if(t.type){if("simulate"===t.type)return a.default;var r=e.find((function(e){return e.type===t.type}));if(r)return r;throw new Error("method-type "+t.type+" not found")}t.webWorkerSupport||gf.isNode||(e=e.filter((function(t){return"idb"!==t.type})));var n=e.find((function(t){return t.canBeUsed()}));if(n)return n;throw new Error("No useable methode found:"+JSON.stringify(s.map((function(t){return t.type}))))};var r=Object(i.a)(bf),o=Object(i.a)(Of),u=Object(i.a)(jf),a=Object(i.a)(kf),s=[r.default,o.default,u.default];if(gf.isNode){var c=Object(n.d)();"function"==typeof c.canBeUsed&&s.push(c)}})),Sf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.clearNodeFolder=function(t){t=(0,wf.fillOptionsWithDefaults)(t);var e=(0,Ef.chooseMethod)(t);return"node"===e.type?e.clearNodeFolder().then((function(){return!0})):Promise.resolve(!1)},e.enforceOptions=function(t){r=t},e.BroadcastChannel=void 0;var r,n=function(t,e){var n,o;this.name=t,r&&(e=r),this.options=(0,wf.fillOptionsWithDefaults)(e),this.method=(0,Ef.chooseMethod)(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._befC=[],this._prepP=null,o=(n=this).method.create(n.name,n.options),(0,gf.isPromise)(o)?(n._prepP=o,o.then((function(t){n._state=t}))):n._state=o};function o(t,e,r){var n={time:t.method.microSeconds(),type:e,data:r};return(t._prepP?t._prepP:Promise.resolve()).then((function(){return t.method.postMessage(t._state,n)}))}function i(t){return t._addEL.message.length>0||t._addEL.internal.length>0}function u(t,e,r){t._addEL[e].push(r),function(t){if(!t._iL&&i(t)){var e=function(e){t._addEL[e.type].forEach((function(t){e.time>=t.time&&t.fn(e.data)}))},r=t.method.microSeconds();t._prepP?t._prepP.then((function(){t._iL=!0,t.method.onMessage(t._state,e,r)})):(t._iL=!0,t.method.onMessage(t._state,e,r))}}(t)}function a(t,e,r){t._addEL[e]=t._addEL[e].filter((function(t){return t!==r})),function(t){if(t._iL&&!i(t)){t._iL=!1;var e=t.method.microSeconds();t.method.onMessage(t._state,null,e)}}(t)}e.BroadcastChannel=n,n._pubkey=!0,n.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed");return o(this,"message",t)},postInternal:function(t){return o(this,"internal",t)},set onmessage(t){var e={time:this.method.microSeconds(),fn:t};a(this,"message",this._onML),t&&"function"==typeof t?(this._onML=e,u(this,"message",e)):this._onML=null},addEventListener:function(t,e){u(this,t,{time:this.method.microSeconds(),fn:e})},removeEventListener:function(t,e){a(this,t,this._addEL[t].find((function(t){return t.fn===e})))},close:function(){var t=this;if(!this.closed){this.closed=!0;var e=this._prepP?this._prepP:Promise.resolve();return this._onML=null,this._addEL.message=[],e.then((function(){return Promise.all(t._befC.map((function(t){return t()})))})).then((function(){return t.method.close(t._state)}))}},get type(){return this.method.type}}}));var xf={add:function(t){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){t()}),!0),window.addEventListener("unload",(function(){t()}),!0)}}},Pf=new Set,Af=!1;function If(t){if(Af||(Af=!0,xf.add(Tf)),"function"!=typeof t)throw new Error("Listener is no function");return Pf.add(t),{remove:function(){return Pf.delete(t)},run:function(){return Pf.delete(t),t()}}}function Tf(){var t=[];return Pf.forEach((function(e){t.push(e()),Pf.delete(e)})),Promise.all(t)}function Df(){Pf.clear()}function Cf(){return Pf.size}var Rf={add:If,runAll:Tf,removeAll:Df,getSize:Cf},Mf=Object.freeze({__proto__:null,add:If,runAll:Tf,removeAll:Df,getSize:Cf,default:Rf}),$f=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createLeaderElection=function(t,e){if(t._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");e=function(t,e){t||(t={});(t=JSON.parse(JSON.stringify(t))).fallbackInterval||(t.fallbackInterval=3e3);t.responseTime||(t.responseTime=e.method.averageResponseTime(e.options));return t}(e,t);var r=new n(t,e);return t._befC.push((function(){return r.die()})),t._leaderElector=r,r};var r=Object(i.a)(Mf),n=function(t,e){this._channel=t,this._options=e,this.isLeader=!1,this.isDead=!1,this.token=(0,gf.randomToken)(),this._isApl=!1,this._reApply=!1,this._unl=[],this._lstns=[],this._invs=[]};function o(t,e){var r={context:"leader",action:e,token:t.token};return t._channel.postInternal(r)}n.prototype={applyOnce:function(){var t=this;if(this.isLeader)return Promise.resolve(!1);if(this.isDead)return Promise.resolve(!1);if(this._isApl)return this._reApply=!0,Promise.resolve(!1);this._isApl=!0;var e=!1,n=function(r){"leader"===r.context&&r.token!=t.token&&("apply"===r.action&&r.token>t.token&&(e=!0),"tell"===r.action&&(e=!0))};return this._channel.addEventListener("internal",n),o(this,"apply").then((function(){return(0,gf.sleep)(t._options.responseTime)})).then((function(){return e?Promise.reject(new Error):o(t,"apply")})).then((function(){return(0,gf.sleep)(t._options.responseTime)})).then((function(){return e?Promise.reject(new Error):o(t)})).then((function(){return function(t){t.isLeader=!0;var e=r.default.add((function(){return t.die()}));t._unl.push(e);var n=function(e){"leader"===e.context&&"apply"===e.action&&o(t,"tell")};return t._channel.addEventListener("internal",n),t._lstns.push(n),o(t,"tell")}(t)})).then((function(){return!0})).catch((function(){return!1})).then((function(e){return t._channel.removeEventListener("internal",n),t._isApl=!1,!e&&t._reApply?(t._reApply=!1,t.applyOnce()):e}))},awaitLeadership:function(){var t;return this._aLP||(this._aLP=(t=this).isLeader?Promise.resolve():new Promise((function(e){var r=!1,n=function(){r||(r=!0,clearInterval(o),t._channel.removeEventListener("internal",i),e(!0))};t.applyOnce().then((function(){t.isLeader&&n()}));var o=setInterval((function(){t.applyOnce().then((function(){t.isLeader&&n()}))}),t._options.fallbackInterval);t._invs.push(o);var i=function(e){"leader"===e.context&&"death"===e.action&&t.applyOnce().then((function(){t.isLeader&&n()}))};t._channel.addEventListener("internal",i),t._lstns.push(i)}))),this._aLP},die:function(){var t=this;if(!this.isDead)return this.isDead=!0,this._lstns.forEach((function(e){return t._channel.removeEventListener("internal",e)})),this._invs.forEach((function(t){return clearInterval(t)})),this._unl.forEach((function(t){t.remove()})),o(this,"death")}}})),Nf=Object(n.c)((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"BroadcastChannel",{enumerable:!0,get:function(){return Sf.BroadcastChannel}}),Object.defineProperty(e,"clearNodeFolder",{enumerable:!0,get:function(){return Sf.clearNodeFolder}}),Object.defineProperty(e,"enforceOptions",{enumerable:!0,get:function(){return Sf.enforceOptions}}),Object.defineProperty(e,"createLeaderElection",{enumerable:!0,get:function(){return $f.createLeaderElection}})})),Lf=function(){function t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.name="pouchdb",this.adapter=t,this.pouchSettings=e}var e=t.prototype;return e.getSortComparator=function(t,e){var r,n=e.sort?e.sort:[(r={},r[t]="asc",r)],o=Ua(e.selector),i=Object.keys(e.selector);return function(e,r){var u=[e,r].map((function(e){var r=gi(e),n=r[t];return delete r[t],r._id=n,{doc:r}}));return Fa(u,{selector:o,sort:n},i)[0].doc._id===u[0].doc._id?-1:1}},e.getQueryMatcher=function(t,e){var r=Ua(e.selector);return function(n){var o=gi(n),i=o[t];delete o[t],o._id=i;var u=Fa([{doc:o}],{selector:r},Object.keys(e.selector));return u&&1===u.length}},e.createStorageInstance=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n.pouchSettings||(n.pouchSettings={});var o=qf(t,e,r),i={location:o,adapter:vi(this.adapter),settings:n.pouchSettings},u=Object.assign({},i.adapter,this.pouchSettings,i.settings);return Mi("preCreatePouchDb",i),new rf(i.location,u)},e.createInternalStorageInstance=function(t,e){var r=this.createStorageInstance(t,"_rxdb_internal",0,{pouchSettings:{auto_compaction:!1,revs_limit:1}});return Promise.resolve(r)},e.prepareQuery=function(t,e){var r=t.collection.schema.primaryPath,n=e;if(n.sort&&n.sort.forEach((function(e){var r=Object.keys(e)[0],o=["$gt","$gte","$lt","$lte"];if(!(n.selector[r]&&Object.keys(n.selector[r]).some((function(t){return o.includes(t)}))||!1)){var i=t.collection.schema.getSchemaByObjectPath(r);if(!i)throw Di("QU5",{key:r});switch(n.selector[r]||(n.selector[r]={}),i.type){case"number":case"integer":n.selector[r].$gt=-1e28;break;case"string":"string"!=typeof n.selector[r]&&(n.selector[r].$gt="");break;default:n.selector[r].$gt=null}}})),n.selector[r]&&n.selector[r].$regex)throw Di("QU4",{path:r,query:t.mangoQuery});if(n.sort){var o=n.sort.map((function(t){var e,n=Object.keys(t)[0],o=Object.values(t)[0];return(e={})[n===r?"_id":n]=o,e}));n.sort=o}return Object.entries(n.selector).forEach((function(t){var e=t[0],r=t[1];"object"!=typeof r||null===r||Array.isArray(r)||0!==Object.keys(r).length||delete n.selector[e]})),"_id"!==r&&(n.selector=Bf(n.selector,r)),n},t}();function Bf(t,e){if(Array.isArray(t))return t.map((function(t){return Bf(t,e)}));if("object"==typeof t){var r={};return Object.entries(t).forEach((function(t){var n=t[0],o=t[1];n===e?r._id=o:n.startsWith("$")?r[n]=Bf(o,e):r[n]=o})),r}return t}function qf(t,e,r){var n=t+"-rxdb-"+r+"-";if(e.includes("/")){var o=e.split("/"),i=o.pop(),u=o.join("/");return u+="/"+n+i}return n+e}function Uf(t,e){if(!t)throw new Error("adapter missing");return new Lf(t,e)}function Ff(t){return t.allDocs({include_docs:!0}).then((function(t){return t.rows}))}var Wf={},Yf=function(){function t(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=arguments.length>6?arguments[6]:void 0;this.internalStore={},this.idleQueue=new yf,this.token=so(10),this._subs=[],this.destroyed=!1,this.subject=new su,this.observable$=this.subject.asObservable().pipe(Vu((function(t){return pa(t)}))),this.name=t,this.adapter=e,this.password=r,this.multiInstance=n,this.eventReduce=o,this.options=i,this.pouchSettings=u,this.storage=Uf(e,u),this.collections={}}var e=t.prototype;return e.dangerousRemoveCollectionInfo=function(){var t=this;return Ff(this.internalStore).then((function(e){return Promise.all(e.map((function(t){return{_id:t.key,_rev:t.value.rev}})).map((function(e){return t.internalStore.remove(e._id,e._rev)})))}))},e._spawnPouchDB=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.storage.createStorageInstance(this.name,t,e,{pouchSettings:r})},e.$emit=function(t){t&&(this.subject.next(t),t.databaseToken===this.token&&function(t,e){if(t.multiInstance&&!e.isIntern()&&t.broadcastChannel){var r={cE:e.toJSON(),storageToken:t.storageToken};return t.broadcastChannel.postMessage(r).then((function(){return!0}))}Promise.resolve(!1)}(this,t))},e.removeCollectionDoc=function(t,e){var r=this,n=zf(t,e);return this.internalStore.get(n).then((function(t){return r.lockedRun((function(){return r.internalStore.remove(t)}))}))},e.addCollections=function(){var t=Li($i.mark((function t(e){var r,n,o,i,u,a,s,c=this;return $i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.internalStore,t.next=3,r.allDocs({include_docs:!0,keys:Object.keys(e).map((function(t){return zf(t,e[t].schema)}))});case 3:return n=t.sent,o={},n.rows.forEach((function(t){t.error||(o[t.key]=t.doc)})),i={},t.next=9,Promise.all(Object.entries(e).map((function(t){var r=t[0],n=t[1],u=o[zf(r,e[r].schema)],a=gi(n);a.name=r;var s=_a(n.schema);if(i[r]=s.hash,a.schema=s,a.database=c,c.collections[r])throw Di("DB3",{name:r});if(u&&u.schemaHash!==i[r])throw Di("DB6",{name:r,previousSchemaHash:u.schemaHash,schemaHash:i[r]});var f=gi(n);return f.database=c,f.name=r,Mi("preCreateRxCollection",f),df(a,!!u)})));case 9:if(u=t.sent,a=[],s={},u.forEach((function(t){var r=t.name;if(s[r]=t,t.schema.crypt&&!c.password)throw Di("DB7",{name:r});o[r]||a.push({_id:zf(r,e[r].schema),schemaHash:i[r],schema:t.schema.normalized,version:t.schema.version}),c.collections[r]=t,c[r]||Object.defineProperty(c,r,{get:function(){return c.collections[r]}})})),!(a.length>0)){t.next=16;break}return t.next=16,r.bulkDocs({docs:a});case 16:return t.abrupt("return",s);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.collection=function(t){var e;return"string"==typeof t?Promise.resolve(this.collections[t]):this.addCollections((e={},e[t.name]=t,e)).then((function(e){return e[t.name]}))},e.removeCollection=function(t){var e=this;return this.collections[t]&&this.collections[t].destroy(),function(t,e){return t.lockedRun((function(){return Ff(t.internalStore)})).then((function(r){var n=r.map((function(t){return t.doc})).filter((function(t){return t._id.split("-")[0]===e}));return Promise.all(n.map((function(e){return t.lockedRun((function(){return t.internalStore.remove(e)}))}))).then((function(){return n.map((function(t){return t.version}))}))}))}(this,t).then((function(r){return r.map((function(r){return e._spawnPouchDB(t,r)}))})).then((function(t){return Promise.all(t.map((function(t){return e.lockedRun((function(){return t.destroy()}))})))})).then((function(){}))},e.lockedRun=function(t){return this.idleQueue.wrapCall(t)},e.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},e.dump=function(){throw si("json-dump")},e.importDump=function(t){throw si("json-dump")},e.server=function(t){throw si("server")},e.leaderElector=function(){throw si("leader-election")},e.isLeader=function(){throw si("leader-election")},e.waitForLeadership=function(){throw si("leader-election")},e.destroy=function(){var t=this;return this.destroyed?Promise.resolve(!1):(Mi("preDestroyRxDatabase",this),this.destroyed=!0,this.broadcastChannel&&setTimeout((function(){return t.broadcastChannel.close()}),1e3),this._subs.map((function(t){return t.unsubscribe()})),Promise.all(Object.keys(this.collections).map((function(e){return t.collections[e]})).map((function(t){return t.destroy()}))).then((function(){return function(t,e){if(!Wf[t])return;var r=Wf[t].indexOf(e);Wf[t].splice(r,1)}(t.name,t.adapter)})).then((function(){return!0})))},e.remove=function(){var t=this;return this.destroy().then((function(){return e=t.name,r=t.adapter,(n=Uf(r)).createInternalStorageInstance(e).then((function(t){return Ff(t).then((function(t){return Promise.all(t.map((function(t){return t.id})).map((function(t){var r=t.split("-"),o=r[0],i=parseInt(r[1],10);return n.createStorageInstance(e,o,i).destroy()})))})).then((function(){return t.destroy()}))}));var e,r,n}))},c(t,[{key:"$",get:function(){return this.observable$}}]),t}();function Qf(t){return t.internalStore.get("_local/storageToken").catch((function(){return t.internalStore.put({_id:"_local/storageToken",value:so(10)}).catch((function(){})).then((function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(e){return setTimeout(e,t)}))}(0)}))})).then((function(){return t.internalStore.get("_local/storageToken")})).then((function(t){return t.value}))}function zf(t,e){return t+"-"+e.version}function Vf(t){return t.storage.createInternalStorageInstance(t.name).then((function(e){return t.internalStore=e,Qf(t)})).then((function(e){t.storageToken=e,t.multiInstance&&function(t){t.broadcastChannel=new Nf.BroadcastChannel("RxDB:"+t.name+":socket"),t.broadcastChannel$=new su,t.broadcastChannel.onmessage=function(e){if(e.storageToken===t.storageToken&&e.cE.databaseToken!==t.token){var r=new la(e.cE.operation,e.cE.documentId,e.cE.documentData,e.cE.databaseToken,e.cE.collectionName,e.cE.isLocal,e.cE.startTime,e.cE.endTime,e.cE.previousData);t.broadcastChannel$.next(r)}},t._subs.push(t.broadcastChannel$.subscribe((function(e){t.$emit(e)})))}(t)}))}function Jf(t){var e=t.name,r=t.adapter,n=t.password,o=t.multiInstance,i=void 0===o||o,u=t.eventReduce,a=void 0!==u&&u,s=t.ignoreDuplicate,c=void 0!==s&&s,f=t.options,l=void 0===f?{}:f,h=t.pouchSettings,p=void 0===h?{}:h;if(Mi("preCreateRxDatabase",{name:e,adapter:r,password:n,multiInstance:i,eventReduce:a,ignoreDuplicate:c,options:l,pouchSettings:p}),"string"==typeof r){if(!rf.adapters||!rf.adapters[r])throw Di("DB9",{adapter:r})}else if(function(t){if(!t||"function"!=typeof t.super_)throw Di("UT4",{adapter:t})}(r),!rf.adapters||!rf.adapters.leveldb)throw Di("DB10",{adapter:r});n&&Pi.validatePassword(n),c||function(t,e){if(!Wf[t])return!1;var r=!1;if(Wf[t].forEach((function(t){t===e&&(r=!0)})),r)throw Di("DB8",{name:t,adapter:e,link:"https://pubkey.github.io/rxdb/rx-database.html#ignoreduplicate"})}(e,r),Wf[e]||(Wf[e]=[]),Wf[e].push(r);var d=new Yf(e,r,n,i,a,l,p);return Vf(d).then((function(){return t="createRxDatabase",e=d,Promise.all(Ri[t].map((function(t){return t(e)})));var t,e})).then((function(){return d}))}var Hf={RxSchema:ma.prototype,Crypter:wa.prototype,RxDocument:da,RxQuery:Ds.prototype,RxCollection:hf.prototype,RxDatabase:Yf.prototype},Gf=new Set;function Kf(t){if(Mi("preAddRxPlugin",{plugin:t,plugins:Gf}),!Gf.has(t)){if(Gf.add(t),!t.rxdb)return"object"==typeof t&&t.default&&(t=t.default),void rf.plugin(t);var e=t;e.prototypes&&Object.entries(t.prototypes).forEach((function(t){var e=t[0];return(0,t[1])(Hf[e])})),e.overwritable&&Object.assign(Pi,t.overwritable),e.hooks&&Object.entries(t.hooks).forEach((function(t){var e=t[0],r=t[1];return Ri[e].push(r)}))}}}}]);